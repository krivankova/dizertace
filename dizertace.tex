 \documentclass[a4paper,12pt]{report}
  \pagestyle{plain}
  \usepackage{latexsym}      %symboly
  \usepackage{graphicx}
  \usepackage{amsmath}
  \usepackage{amsfonts}
  \usepackage{amsthm}
  \usepackage{epstopdf} %pokud pouzivam .eps obrazky, ale chci prekladat pdflatexem 
  \usepackage[czech]{babel}
  \usepackage[utf8]{inputenc} %pro vstupní kódování  
  %\usepackage[utf8x]{inputenc} %pro vstupní kódování  umožní více jazyků, ale má jiné problémy
  \usepackage[T1]{fontenc} %pro výstupní kódování fontů (pro UTF8), aby fungovalo dělení slov s diakritikou a vyhledávání slov s diakritikou
  %\usepackage[IL2]{fontenc} %pro výstupní kódování fontů (pro latin2, ale obsahuje víc fontů než [T1]), aby fungovalo dělení slov s diakritikou a vyhledávání slov s diakritikou
  \usepackage{lmodern} %balíček zavádějící fonty Latin Modern. Bez něj se použijí starší, tzv. EC fonty, jejichž typografická úroveň je v případě češtiny nízká
  %\usepackage{palatino} % Font Palatino alternativa k \usepackage{lmodern} 
  \usepackage{comment}
  \usepackage{xcolor}
  \usepackage{verbatim}
  \usepackage{xspace} %pro tvorbu prostředí, které využíváme pro vytvoření loga pro R a Matlab
  \usepackage{lastpage}%počet stránek

\usepackage{url}  %kvuli vkladani URL adres do bibtexu ale asi jen ve stylu CZECHISO
\DeclareUrlCommand\url{\def\UrlLeft{<}\def\UrlRight{>} \urlstyle{tt}}
  
%\renewcommand{\figurename}{Fig.}
  \usepackage{phdthesis}
  \usepackage{psfrag}
%  \newtheorem{definice}{Definition}
  \usepackage{hyperref} % klikatelne odkazy v textu
  \hypersetup{
      colorlinks   = true, %Colours links instead of ugly boxes
      urlcolor     = blue, %Colour for external hyperlinks
      linkcolor    = red, %Colour of internal links
      citecolor   = red, %Colour of citations
      unicode=true % zajistí správné fungování háčků a čárek (češtiny) v PDF obsahu
    }
  \date{\today}
  \usepackage{minibox}
  \usepackage{pdfpages}
%
%
\vfuzz10pt % Don't report over-full v-boxes if over-edge is small
\hfuzz10pt
%
%
%\newtheorem{theorem}{Theorem}[chapter]
%\newtheorem{definition}{Definition}[chapter]
%\newtheorem{example}{Example}[chapter]
\DeclareMathOperator{\limean}{l.i.m.}   %limit in the mean se stane operatorem
\DeclareMathOperator{\argmax}{argmax}   %stejne tak argmin a argmax
\DeclareMathOperator{\argmin}{argmin}
%
%

\newtheorem{veta}{Věta} 
\newtheorem{lemma}[veta]{Lemma}
\newtheorem{dusledek}[veta]{Důsledek}
\theoremstyle{definition} \newtheorem{definice}[veta]{Definice}
\newtheorem{priklad}{Příklad}
\theoremstyle{remark}
\newtheorem*{poznamka}{Poznámka}
\newtheorem*{reseni}{Řešení}  

%\newcommand{\uv}[1]{\quotedblbase #1\textquotedblleft} %makro pro české uvozovky


\newcommand{\specialcell}[2][c]{%
\begin{tabular}[#1]{@{}l@{}}#2\end{tabular}}

%\usepackage{encxvlna} %při překladu automaticky uvažuje nezlomitelné mezery dle pravidel češtiny (nahrazuje program vlna.exe)

%vytvoří logo matematického prostředí MATLAB -- \MATLAB
\newcommand{\MATLAB}{\textsc{Matlab}\xspace}

%vytvoří logo matematického prostředí R -- \tiny{\R}  \normalsize{ \R}  \Huge{\R}
% \newcommand{\R}{\textsf{R}\xspace}   %1. možnost
%\newcommand{\R}{ \textbf{\textsf{R}}\xspace} %2. možnost
\definecolor{Rcolor}{RGB}{150,160,190} %3. možnost

\newcommand{\Rx}{\fontsize{10pt}{12pt}\selectfont
\raisebox{.3em}{\hspace{1.2em}%
\llap{\resizebox{1.09em}{.5em}{\color{black}$\bigcirc$}}%
\llap{\resizebox{1.199em}{.55em}{\color{darkgray}$\bigcirc$}}%
\llap{\resizebox{1.19em}{.52em}{\color{gray!50}$\bigcirc$}}%
\llap{\resizebox{1.1em}{.5em}{\color{gray}$\bigcirc$}}%
\llap{\resizebox{1.25em}{.55em}{\color{gray}$\bigcirc$}}%
}%
\hspace{-.85em}%
\textbf{%
%\resizebox{.55em}{1.5ex}{\textcolor{black!80}{\textsf{R}}}%
\textcolor{black}{\textsf{R}}%
\hspace{-.025em}\raisebox{.01em}{\llap{\textcolor{Rcolor}{\textsf{R}}}}%
}}%

\newbox\rbox
\savebox\rbox{\scalebox{0.1}{\Rx}}

\makeatletter
\def\R{\scalebox{\f@size}{\usebox\rbox}\xspace}
\makeatletter

\begin{document}
\titlepage
\vspace*{-2.4cm}
\begin{center}
\textsc{\Large{Masarykova Univerzita}} \\
\large{Přírodovědecká fakulta} \\
\large{Ústav matematiky a statistiky}
\end{center}
\vspace{7.11cm}
%
\begin{center}
\textsc{\Large{DISERTAČNÍ PRÁCE}}
\end{center}
%
\vspace{11.39cm}
%
\begin{center}
\begin{tabular}{l  r}
 \Large{Brno 2017} \qquad\qquad\qquad\qquad \qquad\qquad & \Large{Lenka Křivánková}
\end{tabular}
\end{center}

\titlepage
\setcounter{page}{1}
\pagenumbering{roman}
%\begin{adjustwidth}{-12mm}{}
\hspace{-14mm}
\vspace*{-5mm}
\begin{minipage}{28mm}
  \includegraphics[width=28mm]{IMG/MU_(black)}
\end{minipage}\hspace{2mm}
\begin{minipage}{90mm}%{113mm}
\begin{center}%\vspace*{5mm}
\textsc{\LARGE{Masarykova Univerzita}} \\ \vspace{2mm}
\textsc{\Large{Přírodovědecká fakulta}} \\ \vspace{2mm}
\textsc{\large{Ústav matematiky a statistiky}}
\end{center}%\quad \\
\end{minipage}\hspace{2mm}
\begin{minipage}{28mm}
  \includegraphics[width=28mm]{IMG/sci-logo.pdf}
\end{minipage}
%\end{adjustwidth}
%
%\begin{center}
%\includegraphics[width=5cm]{IMG/sci-logo.pdf}
%\end{center}\quad \\
%
\vfill
\begin{center}
\textbf{\huge{Stochastické metody analýzy ekonomických dat}} \\ \quad \\  \vspace{2mm}
\textsc{\Large{Disertační práce}}
\end{center} \quad \\\\\\\\\\\\\\\\\\\\\\\\\\ \\
%\begin{center}
%\large{
%\begin{tabular}{l  r}
%\Large{Brno 2017} \qquad\qquad\qquad\qquad \qquad\qquad & \Large{Lenka Křivánková}
%\end{tabular}
%}
%\end{center} \quad
\begin{center}
\Large{Brno 2017} \hfill \Large{Lenka Křivánková}
\end{center}
\vspace{2mm}
\begin{center}
\large{Školitel: doc. RNDr. Martin Kolář, Ph.D.}
\end{center}
%\begin{center}
%\verb=   (\(\=\\
%\verb=  (._. )=\\
%\verb=(')(')_)o=
%\end{center}

\normalsize



\chapter*{Bibliografický záznam}%\addcontentsline{toc}{chapter}{Bibliografický záznam}
%\setcounter{page}{1}
%\pagenumbering{roman}
\thispagestyle{empty}

\begin{tabular}{p{4.5cm}  p{8.5cm}} %{p{3.9cm}  p{9.1cm}}
\textbf{Autorka:} & Mgr. Lenka Křivánková \\
& Přírodovědecká fakulta, Masarykova univerzita\\
& Ústav matematiky a statistiky\\
\textbf{Název práce:} & Stochastické metody analýzy ekonomických dat \\
\textbf{Studijní program:} & Matematika \\
\textbf{Studijní obor:} & Pravděpodobnost, statistika a matematické modelování \\
\textbf{Školitel:} & doc. RNDr. Martin Kolář, Ph.D.  \\
& Přírodovědecká fakulta, Masarykova univerzita\\
& Ústav matematiky a statistiky\\
\textbf{Akademický rok:} & 2016/2017 \\
\textbf{Počet stran:} & xi + \pageref*{LastPage} \\%\Rfoot{\thepage / \pageref{LastPage}} \\
\textbf{Klíčová slova:} & stochastické procesy, stochastické diferenciální rovnice, stochastické modely, teorie portfolia, Credit Valuation Adjusment\\
\end{tabular}
\\\\\\\\\\

\begin{flushright} {{\Huge Bibliographic Entry}} \vspace{38pt} \end{flushright}
%\addcontentsline{toc}{chapter}{Bibliographic entry}

\hspace{-0.7cm}
\begin{tabular}{p{4.5cm}  p{8.5cm}}
\textbf{Author:} & Mgr. Lenka Křivánková \\
& Faculty of Science, Masaryk University \\
& Department of Mathematics and Statistics \\
\textbf{Title of Dissertation:} & Stochastic methods in analysis of economic data \\
\textbf{Degree Programme:} & Mathematics \\
\textbf{Field of Study:} & Probability, statistics and mathematical modeling \\
\textbf{Supervisor:} & doc. RNDr. Martin Kolář, Ph.D.  \\
& Faculty of Science, Masaryk University \\
& Department of Mathematics and Statistics \\
\textbf{Academic Year:} &2016/2017 \\
\textbf{Number of Pages:} & xi + \pageref*{LastPage} \\
\textbf{Keywords:} & Stochastic Processes, Stochastic Differential Equations, Stochastic Models, Portfolio Theory, Credit Valuation Adjusment\\
\end{tabular}
\newpage
\pagestyle{empty}
\null
\vfill
\begin{center}
\copyright \quad Lenka Křivánková, Masarykova Univerzita, 2017
\end{center}

\chapter*{Poděkování}%\addcontentsline{toc}{chapter}{Poděkování}
%\thispagestyle{empty}
\pagestyle{plain}
Na tomto místě bych chtěla poděkovat svému školiteli doc. RNDr. Martinu Kolářovi, Ph.D. za cenné rady, připomínky a čas, který mi věnoval.
Dále chci poděkovat své kolegyni Mgr. Silvii Zlatošové, Ph.D. za spolupráci během doktorského studia, její podpora a motivace mi byla velmi cenná.
Velké poděkování patří také mé rodině a mým přátelům za jejich podporu, trpělivost a útěchu, kterými mě zahrnovali při psaní této práce.
\\

Brno, Duben 2017
\\

Lenka Křivánková

\chapter*{Abstrakt}\addcontentsline{toc}{chapter}{Abstrakt}
%\thispagestyle{empty}
V první části práce jsou uvedeny základní matematické pojmy použité v dalších částech textu. 
\\\\\\\\\\

\begin{flushright} {{\Huge Abstract}} \vspace{38pt} \end{flushright}
%\addcontentsline{toc}{chapter}{Abstract}
In the first part of the work, some basic mathematical methods employed in this thesis are recalled. 

\tableofcontents \addcontentsline{toc}{chapter}{Obsah}

\chapter*{Seznam použitého značení}\addcontentsline{toc}{chapter}{Seznam použitého značení} 
%\hspace{-0.7cm}
%\begin{tabular}{r  l}
%$\mathsf{E}X$ & Expected value of random variable $X$ \\
%$\mathsf{var}X$ & Dispersion, resp. variance of random variable X \\
%\end{tabular}

\normalsize
\textbf{Prostory a matice}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $\mathbb{R}$                              &   jednorozměrný Eukleidovský prostor \\
   $\mathbb{R}^n$                              &     $n$-rozměrný Eukleidovský prostor \\
   $\mathbb{R}^+$                              &     množina všech kladných čísel \\
   $\boldsymbol{x}=(x_1,\ldots,x_n)^\mathrm{T}$             &    $n$-rozměrný reálný vektor \\
    $\boldsymbol{1}$                           &   vektor jedniček\\
   $\mathbf{I}_n$                              &    jednotková matice řádu $n$ \\
   $\mathbf{A}^\mathrm{T}$                              &   transponovaná matice vzhledem k matici $\mathbf{A}$\\
   \end{tabular}\\\\\\
% \end{table}
%
%
\textbf{Pravděpodobnost}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $\omega$				        & elementární jev\\
   $\Omega$                                          &   základní prostor, množina všech elementárních jevů \\
   $\mathsf{Pr}(A)$                               &  pravděpodobnost jevu $A$ \\
   $(\Omega,\mathcal{A}, \mathsf{Pr})$                         &   pravděpodobnostní prostor \\
   \end{tabular}\\\\\\
%
%  \end{table}
%
%
\textbf{Náhodné veličiny}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $X$; $X(\omega)$                                                 &   náhodná veličina \\
   $f(x)$; $f_X(x)$                                               &   hustota pravděpodobnosti náhodné veličiny $X$ \\ %probability density of the random variable $X$ \\
   $F(x)$; $F_X(x)$				 &  distribuční funkce náhodné veličiny $X$ \\
%   $f(x; \theta)$                                    &   probability density function of random variable $X$ with distribution dependent on scalar parameter $\theta$ \\
%   $f(x,t)$                                          &    probability density of random process $X(t)$ at fixed time $t$ \\
%   $f(x,t | x_0, t_0)$                               &    probability density of random process $X(t)$ at fixed time $t$ conditioned by its state $x_0$ at time $t_0$ \\
   $X\sim \mathcal{L}(\boldsymbol{\theta})$                                &   náhodná veličina $X$ mající rozdělením pravděpodobnosti $\mathcal{L}$ s parametry  $\boldsymbol{\theta}=(\theta_1,\ldots,\theta_n)$ \\ %random variable $X$ having general probability distribution $\mathcal{L}$\\
   $\mathsf{E}(X)$;  $\mathsf{E}X$                         	      &   střední hodnota náhodné veličiny $X$ \\
   $\mathsf{D}(X)$;  $\mathsf{D}X$                       	      &   rozptyl náhodné veličiny $X$ \\
   $\mathsf{C}(X_i,X_j)$             		      &   kovariance náhodných veličin $X_i$ a $X_j$\\
   $\mathsf{N}(\mu, \sigma^{2})$                      &   Normální (Gaussovo) rozdělení pravděpodobnosti se střední hodnotou $\mu$ a rozptylem $\sigma^2$  \\
   \end{tabular}\\\\\\
%
%
\textbf{Náhodné vektory}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
  $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$                 &     $n$-rozměrný náhodný vektor \\
  $f(\mathbf{x})$; $f_{\boldsymbol{X}}(\mathbf{x})$                                             &   sdružená hustota pravděpodobnosti náhodného vektoru  $\boldsymbol{X}$\\
   $F(\mathbf{x})$; $F_{\boldsymbol{X}}(\mathbf{x})$                                             &   sdružená distribuční funkce náhodného vektoru  $\boldsymbol{X}$\\
%   $\boldsymbol{\theta}=(\theta_1,\ldots,\theta_m)$  &    m-dimensional vector parameter \\
%   $f(\mathbf{x};\boldsymbol{\theta})$               &    probability density of the random vector $\boldsymbol{X}$ with vector parameter $\boldsymbol{\theta}$ \\
    $\mathsf{E}(\boldsymbol{X})$; $\mathsf{E}\boldsymbol{X}$                             &   vektor středních hodnot náhodného vektoru $\boldsymbol{X}$\\
   $\mathsf{D}(\boldsymbol{X})$; $\mathsf{D}\boldsymbol{X}$                             &   kovarianční matice náhodného vektoru $\boldsymbol{X}$\\
    $\boldsymbol{\Sigma}(\boldsymbol{X_i},\boldsymbol{X_j})$     &   kovarianční matice náhodných vektorů $\boldsymbol{X_i}$ a $\boldsymbol{X_j}$\\
   \end{tabular}\\\\\\
%
%
%
%\\\\
\textbf{Matematická analýza}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $f(t)$				& reálná funkce jedné proměnné\\
   $f'(t)$				& první derivace reálné funkce $f$\\
   $\mathrm{d}f$				& diferenciál funkce $f$\\
   $f(t,x)$					&reálná funkce dvou proměnných\\ 
   $f(t,\cdot)$				& reálná funkce jedné proměnné, tato proměnná je zastoupena tečkou\\
   $\frac{\partial f(t,x)}{\partial t}$				& parciální derivace funkce $f$ podle proměnné $t$\\
   $\left.\frac{\partial f(t,x)}{\partial t}\right|_{t=t_0}$				& parciální derivace funkce $f$ podle proměnné $t$, do~které za proměnnou $t$ dosadíme hodnotu $t_0$\\
   $||\boldsymbol x||$				& Eukleidovská norma\\
   $\langle a,b\rangle$				& uzavřený interval\\
   $\left(a,b\right)$				          & otevřený interval\\
   $\left\lfloor x\right\rfloor$			& dolní celá část reálného čísla $x$\\
   $\log(x)$		  		& přirozený logaritmus reálného čísla $x$\\
   $\mathrm{e}$			& Eulerovo číslo (základ přirozeného logaritmu)
   \end{tabular}\\\\\\
%
%
\textbf{Stochastická analýza}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
     $X(t,\omega)$; $X(t)$; $X_t$                       &   stochastický proces \\
    %   $F_{\boldsymbol{t}}(\boldsymbol{x})$; 
   $F_{t_1,\dots,t_n}(x_1,\dots,x_n)$                       &  distribuční funkce stochastického procesu \\
   $\mathcal{T}$					& indexová množina (často interpretovaná jako čas)\\
   $W(t,\omega)$; $W(t)$; $W_t$                       &   standardní Wienerův proces \\
%   $\boldsymbol{\Delta} W_t$			                      &   přírůstek Wienerova procesu \\
   $\Delta W_k=W_{t_{k+1}}-W_{t_k}$				 &   přírůstek Wienerova procesu \\
   $\Delta t$						& přírůstek času \\
   $\Delta W=W_{t+\Delta t}-W_{t}$				 &   přírůstek Wienerova procesu za čas $\Delta t$\\
   $\mathrm{d}X(t,\omega)$; $\mathrm{d}X(t)$; $\mathrm{d}X_t$    &  stochastický diferenciál \\ %continuous-time random process \\
   $\int_0^Tf(t,\omega)\,\mathrm{d}W$                              &   It\^oův integrál pro stochastický proces $f(t,\omega)$ \\
   $\boldsymbol{X}(\boldsymbol{t},\boldsymbol{\omega})$; $\boldsymbol{X}(\boldsymbol{t})$; $\boldsymbol{X}_{\boldsymbol{t}}$  		& vektorový stochastický proces\\
   $\boldsymbol{W}(\boldsymbol{t})$ 		& standardní $n$-rozměrný Wienerův proces\\
   \end{tabular}\\\\\\
% \end{table}
%
%
\newpage \noindent
\textbf{Teorie portfolia}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $I_t$ 								& množina všech investorů na trhu v čase $t$\\
   $P_j(t)$                             &   cena aktiva $j$ v čase $t$ \\
   $\boldsymbol{P}(t)$                             &   vektor cen aktiv v čase $t$\\
   $N_j(t)$                             &   objem aktiva $j$ v čase $t$ \\
   $\boldsymbol{N}(t)$     &   vektor objemů aktiv v čase $t$\\
   $V_j(t)=P_j(t)N_j(t)$       &  tržní hodnota aktiva $j$\\
   $r_j$  								& míra výnosnosti podkladového aktiva $j$\\
   $\boldsymbol{r}=(r_1,\dots,r_n)^\mathrm{T}$  		& vektor výnosností aktiv držených v~portfoliu\\
   $\mu_j$ 								& očekávaná míra výnosnosti podkladového aktiva $j$\\
   $\sigma_j$								& riziko podkladového aktiva $j$\\
   $B(t)$ 								& cena bezrizikového aktiva v čase $t$\\
   $r_f(t)$ 								& bezriziková úroková míra v čase $t$\\
   $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$		& vektor vah podkladových aktiv držených v~portfoliu\\
   $\mathsf{C}(r_j,r_k)=\sigma_{jk}$				& kovariance výnosnosti aktiva~$j$ a~výnosnosti aktiva~$k$\\
   $\boldsymbol{\Sigma}$						& kovarianční matice výnosností podkladových aktiv držených v~portfoliu\\
   $\xi_{jk}(t)$ 							& proces volatility podkladových aktiv $j$ a $k$ držených v~portfoliu\\
   $\boldsymbol{\xi}$						& matice volatilit podkladových aktiv držených v~portfoliu\\
   $\gamma_j(t)$ 							& míra růstu  podkladového aktiva $j$\\
   $w_{j}(i,t)$ 							& optimální objem prostředků investovaných do aktiva $j$ investorem $i$ v čase $t$\\
   $\boldsymbol{w}(i,t)$					 	& optimální alokace prostředků investora $i$ držených v portfoliu všech aktiv v čase $t$\\
   $\lambda(i,t)$							& rizikové preference investora $i$ v čase $t$ \\  
\end{tabular}\\\\\\
%
%
%
\newpage \noindent
\textbf{Teorie řízení finančních rizik}\\\\
%  \begin{table}[h]
   \begin{tabular}{p{4cm} p{9.3cm}}
   $CCR$ 								& kreditní riziko protistrany\\
   $CVA$								& Credit Valuation Adjustment\\
   $D(t)$								& diskontní faktor pro odbobí od času $t$ do času 0\\
   $EAD$								& výše expozice v okamžiku selhání protistrany\\
   $LGD$								& ztrátovost ze selhání\\
   $R$									& míra návratnosti\\
   $PD$								& pravděpodobnost selhání protistrany\\
   $PD_{1Y}$								& pravděpodobnost selhání protistrany během jednoho roku\\
   $PD(i)$								& pravděpodobnost selhání protistrany v $i$-tém roce\\
   $IRS$								& úrokový swap\\
   $M$									& počet let do maturity finančního derivátu zaokrouhlený nahoru\\
\end{tabular}\\\\\\
%
%
%

\chapter*{Úvod}\addcontentsline{toc}{chapter}{Úvod} 
%\chapter{Úvod}
\pagestyle{plain}
\setcounter{page}{1}
\pagenumbering{arabic}


%příliš žluťoučký kůň úpěl ďábelské ódy

%Wienerův proces využívaný za účelem modelování chování cen aktiv a finančních instrumentů.

%ekonomické modely nabídky a poptávky – většinou jde o teoretické modely, chybí zde omezení platící v reálném trh

%Investiční rozhodování (capital budgeting) a oceňování podniku patří ke klíčovým úlohám finančního rozhodování.
%Oceňování je jedním z ústředních nástrojů finančního řízení a rozhodování. 
%Klíčovými faktory jsou neurčitost finančních toků a dynamická flexibilita. 

%Nejprve uvedeme základní matematický aparát, který využíváme v této práci.
%Budeme používat obvyklé značení, jehož přehled je uveden na začátku práce. 
%Zavedeme základní definice a vztahy využívané ve stochastickém modelování.

Stochastické metody analýzy dat se těší stále větší oblibě.
Vznikají nové stochastické modely sloužící k popisu náhodných dějů a nachází uplatnění v~širokém spektru oblastí.
Stochastická analýza se také čím dál více rozšiřuje do výuky na vysokých školách a absolventi přenáší své vědomosti do praxe.
Rovněž v ekonomické praxi se stále častěji setkáváme s potřebou popsat dynamiku sofistikovanějšími metodami a modely.
Přestože v této oblasti existuje velké množství zahraniční literatury, nepodařilo se nám nalézt téměř žádné texty psané v~českém jazyce.
Všechny tyto skutečnosti nás vedly k rozhodnutí sepsat práci, která poskytne základní přehled o tomto tématu, ukáže možnosti jak stochastické metody aplikovat na aktuální problémy v praxi a~motivuje čtenáře k podrobnějšímu zájmu o tuto oblast finanční matematiky.
Stochastické metody analýzy dat budeme aplikovat ve dvou ekonomických oborech -- v teorii portfolia a v teorii řízení finančních rizik. 

Teorie portfolia se zabývá zkoumáním kapitálových trhů a popisem chování cen finančních aktiv.
Na základě těchto poznatků je hledán způsob, jak zvolit optimální množinu finančních aktiv.
Přitom je využívána nejen teorie pravděpodobnosti, ale v novějších přístupech i stochastická analýza.

Za zakladatele moderní teorie portfolia je považován Harry Markowitz. 
Jeho práci z roku 1952 dále rozvíjeli například James Tobin a William Sharpe a staví na ní i některé současné přístupy.
%Zjednodušující předpoklady používané v teorii portfolia bývají předmětem kritiky.
%V této práci představíme některé metody z teorie portfolia a budeme diskutovat o jejich výhodách a nevýhodách.
%
%Budeme vycházet z klasické Markowitzovy teorie portfolia, která používá statický přístup (tzv. jednokrokový model).
%Představíme rozšíření navržené Jamesem Tobinem, které přináší Separační teorém a navazuje na něj Capital Asset Pricing Model (CAPM).
%
Vývojem optimálního portfolia ve spojitém čase se zabýval Robert Merton, který přinesl první řešení tohoto problému v roce 1971.
Ve svém přístupu předpokládal, že ceny finančních aktiv se řídí It\^oovými procesy s konstantními parametry. 
Dalším jeho předpokladem byla tržní rovnováha.
%
Nicméně jeho zjednodušující předpoklady se staly v roce 1976 předmětem kritiky Ohlsona a Rosenberga, formulované v tzv. Ohlson-Rosenbergově paradoxu.
Hledání vhodného modelu chování cen finančních aktiv v portfoliu ve spojitém čase je tedy stále aktuálním tématem. 
V~posledních letech se jím zabývá také Robert Fernholz ve své stochastické teorii portfolia. 
Tato teorie ale nepředpokládá tržní rovnováhu.
%v této části práce 
%Také my navrhneme stochastický model, který bude mít volnější předpoklady než Mertonův přístup a nebude tudíž zatížen jejich rozporem.
Závěr třetí kapitoly je věnován konstrukci modelu, který odstraňuje logickou nekonzistenci vedoucí k zmíněnému paradoxu. 
Model vychází přirozeným způsobem z Markowitzovy a Sharpeho teorie se zachováním předpokladu tržní rovnováhy.

%V další části představíme Ohlson-Rosenbergův paradox publikovaný v roce 1976, který dokazuje rozpor mezi Mertonovými předpoklady.  
%Uvedeme metody, které tímto rozporem nejsou zatíženy.
%Jednou z nich je stochastická teorie portfolia, kterou rozvíjí Robert Fernholz.
%Navrhneme vlastní metodu, která bude mít volnější předpoklady než Mertonův přístup.
%Navržený model budeme aplikovat na reálná data. 

%\begin{comment}
Z teorie řízení finančních rizik jsme si pro aplikaci stochastických metod vybrali aktuální téma, jehož řešení vyžadují regulatorní požadavky z posledních let.
Jedná se o modelování Credit Valuation Adjustment (CVA), což je bankou sledovaná a účtovaná hodnota, která slouží jako úprava reálné hodnoty derivátů o kreditní riziko protistrany.
Podle odhadu Basilejského výboru pochází tři čtvrtiny ztrát způsobených kreditním rizikem protistrany během finanční krize ze ztrát daných změnou CVA, nikoli kvůli samotným selháním protistran. 
Od roku 2015 předepisuje regulatorní standard Basel III bankám povinnost počítat kapitalový požadavek pro riziko změny CVA.

Současná situace na bankovním trhu vyvíjí na banky velký tlak hledat nové možnosti jak dosáhnout zisku.
Běžné způsoby tvorby zisku v současnosti selhávají.
Na trhu můžeme pozorovat nejen nízké až záporné úrokové sazby, ale i konkurenční boj o klienty, který přináší neustálý tlak na snižování bankovních poplatků a poskytování téměř nerentabilní klientských úvěrů.
Banky proto hledají nové možnosti, jak snižovat náklady, kterými jsou například opravné položky k úvěrům klientů nebo k finančním derivátům.
Jednou z možností může být nalezení způsobu jak CVA modelovat tak, aby dodržely předepsané standardy a zároveň zajistily co nejmenší dopad na svůj zisk. 
Banky často používají triviální parametrické modely, které jsou kvůli rizikové obezřetnosti nastaveny velmi konzervativně.
Předpokládáme, že sofistikovanější model by mohl přinést nižší CVA a tudíž i nižší rizikové náklady pro banku. 
%\end{comment}

\begin{comment}
Otazník před komentářem označuje, že tato literatura ještě není citována.\\
Klasická kniha o Stochastických diferenciálních rovnicích \cite{oksendal2003stochastic}\\%
Numerické řešení stochastických diferenciálních rovnic a jejich soustav \cite{kloeden1997}\\
Vzorec pro váhy tržního portfolia čerpáme z \cite{fabozzi}\\
Základy teorie portfolia pokládá Markowitz v \cite{markowitz}\\%
Tobin v \cite{tobin} rozšiřuje Markowitzův přístup o bezrizikové aktivum.%
Capital Asset Pricing Model (CAPM), který nezávisle na sobě zkonstruovali Sharpe (1964) v \cite{sharpe1964}, Lintner (1965) v \cite{lintner1965} a Mossin (1966) v \cite{mossin1966} zkoumá chování trhu v případě, že se všichni investoři chovají podle Markowitzovy teorie.%
První řešení spojitého modelu v teorii portfolia dává Merton v \cite{merton1971}\\%
Na rozpor předpokladů v Mertonově článku \cite{merton1971} upozorňují Ohlson a Rosenberg v \cite{ohlson}\\%
Na jejich článek reaguje Merton v \cite{merton1975} a jeho reakce vychází ješte před článkem Ohlsona a Rosenberga.\\%
\\
Konzistentní dynamický přístup k teorii portfolia dává Fernholz ve své knize Stochastická teorie portfolia \cite{fern} a v článku s Karatzasem\cite{kara}\\
\\
Stochastický kalkul, oceňování finančních derivátů, arbitrážní teorie - Pascucci\cite{pascucci}\\%
\\ \\
?Continuous asset model \cite{higham2004introduction}\\
?Riziková averze, vše o portfoliu, separační teorém, objemný \cite{ingersoll1987theory}\\
?Dynamic portfolio optimization \cite{prigent2007portfolio}\\
?General Equilibrium Asset Pricing \cite{wickens2012macroeconomic}\\
Arbitráž, asset pricing model, numerické metody \cite{wilmott1995mathematics}\\
?Teorie portfolia \cite{de2010portfolio}, \cite{brada}, \cite{sharpe}, úvod \cite{bohdalova}
Diferenciální rovnice, numerické metody \cite{cyganowski1998maple}, \cite{cyganowski2002elementary}\\
Stochastické procesy \cite{allen2010introduction} \\%
Stochastické procesy a rovnováha na trhu\cite{karatzas1998methods} \\
Numerické řešená SDE ve financich \cite{sauer2012numerical} \\


?Finanční trhy, modely volatility, optimální portfolio, opce \cite{bouchaud2003theory} \\
?Black-Scholes, Arbitraz, opce, numericke metody \cite{duffie2010dynamic} \\
?arbitraz, Ito, spojite modely, stochasticka volatilita \cite{duffie2003intertemporal} \\
mnohorozmerny model ceny aktiva. \cite{etheridge2002course} \\%
?vse o portfoliu \cite{fabozziportfolio} \\
?Na optimalizaci portfolia pomocí bayesovských metod se specializuje v článku \cite{fabozzi2007robust}\\
?modely volatility \cite{gali2009monetary} \\
?ocekavana vynosnost, arbitrazni teorie, konstrukce portfolia \cite{gridold1999active} \\
Wienerův proces, volatilita, základní numerické metody, VaR \cite{hull} \\
?Základy finanční matematiky a teorie portfolia \cite{melichercik} \\
?Dynamická teorie portfolia, \cite{oberuc2003dynamic}\\
Úvod do SDE \cite{karatzas2012brownian}, \cite{gard}\\%
Stochastická analýza \cite{shreve2012stochastic} a \cite{shreve2004stochastic}\\%

CVA \cite{zhu2007} \cite{pykhtin2010} \cite{gregory2010} \cite{brigo2014}   zahrnutí Wrong-Way do Monte Carlo simulace \cite{hull2012cva} přehledový článek \cite{arora2012}

\end{comment}

%V modelech pro CCR a CVA je nutné zohlednit jak riziko kreditní kvality protistrany, tak i náhodnost v hodnotě budoucí expozice vůči protistraně. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Cíle práce a metodika}\addcontentsline{toc}{chapter}{Cíle práce a metodika} 
Cílem této disertační práce je přehledně představit základy teorie stochastických procesů a stochastických diferenciálních rovnic a 
zasvětit čtenáře do problematiky stochastických modelů využívaných při analýze ekonomických dat.
Tento cíl budeme naplňovat v Kapitolách~\ref{stochasticka_analyza_kap}~a~\ref{stoch_model}.
Dalším cílem této práce je využít teoretické poznatky a aplikovat je při analýze reálných dat v~konkrétních ekonomických oborech.
Prvním z těchto oborů bude teorie portfolia prezentovaná v~Kapitole~\ref{teorie_portfolia_kap} a druhým teorie řízení finančních rizik představená v~Kapitole~\ref{rizika_kap}.
Navíc si klademe za cíl, aby námi použité metody přinášely některé nové výhody oproti modelům uvedeným v teoretické části.

Představíme historii vývoje modelování v teorii portfolia a srovnáme výhody a nevýhody klasického přístupu a dynamického přístupu, který využívá stochastické modelování.
Naším cílem je seznámit čtenáře s nekonzistencí předpokladů v Mertonově dynamickém přístupu známé z Ohlson-Rosenbergova paradoxu.
Stěžejní část kapitoly bude obsahovat navržení nového modelu pro popis chování cen finančních aktiv založeného na vztahu mezi váhami portfolia a výnosností finančních aktiv v portfoliu.
Navržený model si klade za cíl popsat dynamiku cen aktiv bez nekonzistence předpokladů.
Model následně aplikujeme na reálná data z pražské burzy cenných papírů.
%Pro všechny výpočty, simulace a zobrazení grafů vytvoříme programy v prostředí \R (verze 3.3.0).
Simulace a grafy prezentované v Kapitole~\ref{teorie_portfolia_kap} vytvoříme pomocí programů vyvinutých v prostředí~\R (verze 3.3.0).
Jejich ukázky budou uvedeny v Příloze~\ref{priloha_programy}.

V dalším části práce, zaměřené na  řízení finančních rizik, bude naším cílem představit a aplikovat model pro CVA úrokových swapů, který respektuje regulační normy a~zároveň přináší nižší ocenění CVA než metody využívané v bankovní praxi.
Při výpočtu CVA budeme využívat různé stochastické metody analýzy dat.
Monte Carlo simulace použijeme k vytvoření  možných scénářů vývoje úrokových měr na trhu. 
Tyto simulace jsou prováděny s využitím Hull-Whitova jednofaktorového modelu úrokových měr.
Následně pro každý scénář úrokové míry oceňujeme daný úrokový swap metodami pro oceňování derivátů a~určujeme očekávanou expozici protistrany.
Pro odhad pravděpodobnosti selhání protistrany využíváme přístup založený na exponenciálním rozdělení.
Výpočty a simulace prezentované v Kapitole \ref{rizika_kap} realizujeme v prostředí \MATLAB (verze  R2014b).
Ukázky z programu uvedeme v Příloze \ref{priloha_programy}.

%%%%%%%%%%%%%%%%%%{Stochastická analýza}

\chapter{Stochastická analýza}\label{stochasticka_analyza_kap}
%\chapter{Teoretická východiska}
%\begin{comment}
Stochastická analýza v sobě spojuje poznatky z teorie pravděpodobnosti, statistiky a matematické analýzy.
Její aplikace najdeme v mnoha různých oblastech mezi které patří například finanční matematika, pojistná matematika a biologie.
Stochastická analýza poskytuje matematický aparát využívaný pro popis vývoje náhodných dějů.

Mezi základní pojmy stochastické analýzy patří stochastický proces, stochastický integrál a stochastická diferenciální rovnice.
Definice a vztahy zavedené v této kapitole budeme dále využívat při stochastickém modelování.

Tato teoretická část práce čerpá především z klasické monografie Bernta {\O}ksendala o stochastických diferenciálních rovnicích \cite{oksendal2003stochastic}, 
podobně jako knihy Thomase Garda  \cite{gard} 
a rozsáhlé publikace Andrei Pascucci zabývající se matematickými metodami oceňování opcí \cite{pascucci}.
Jako další reference byly využity \cite{karatzas2012brownian}, \cite{allen2010introduction},  \cite{shreve2012stochastic} a \cite{shreve2004stochastic}.
Ve zmiňované literatuře je možno nalézt další podrobnosti.

\section{Stochastické procesy a jejich vlastnosti}
Stochastické procesy slouží k popisu dynamiky náhodných jevů a příklady takových jevů nacházíme v mnoha vědeckých oborech.
Mezi nejznámější patří Brownův pohyb pevných částic, difuze a bílý šum.

Základy teorie stochastických procesů byly položeny na konci devatenáctého století.
První zmínky popisu Brownova pohybu najdeme v článku dánského matematika Thorvalda Nicolae Thielea z roku 1880 zabývajícím se metodou nejmenších čtverců (podrobněji viz \cite{lauritzen2002thiele}). %(viz \cite{gulisashvili2012analytically}).
V roce 1900 Louis Bachelier ve své disertační práci \cite{bachelier} používá Brownův pohyb k popisu pohybu cen akcií na trhu.
Díky ní je Bachelier uznávaný jako zakladatel kvantitativních metod ve finanční matematice.

Nezávisle na této práci popisují matematicky Brownův pohyb také fyzici Albert Einstein a Marian Smoluchowski. 
V roce 1905 Einstein aplikuje Brownův pohyb ve svém článku zabývajícím se molekulárně kinetickou teorií tepla \cite{einstein}.
O rok později Smoluchowski prezentuje článek \cite{Smoluchowski}, který se stane důležitým základem teorie náhodných procesů zvláště rovnice difuze.
Einsteinovu teorii v roce 1908 experimentálně ověřil Jean Baptiste Perrin \cite{perrin2013brownian} a za tento úspěch byl v roce 1926 oceněn Nobelovou cenou za fyziku. 

V neposlední řadě chceme zmínit význam amerického matematika Norberta Wienera, který dokázal existenci stochastického procesu používaného k popisu Brownova pohybu \cite{wiener1923differential}. 
Tento proces nese jeho jméno a je využíván v~mnoha různých odvětvích.

\subsection{Stochastický proces}
V této části práce definujeme stochastický proces a uvedeme některé jeho podstatné vlastnosti.
\begin{definice}[Stochastický proces]
Uvažujme  indexovou množinu $\mathcal{T}$ a pravděpodobnostní prostor $(\Omega,\mathcal{A}, \mathsf{Pr})$.
\textit{Stochastický proces} $X(t,\omega)$ je funkce dvou proměnných $X:\mathcal{T}\times\Omega\to\mathbb{R}$, kde 
$X(t,\cdot):\Omega\to\mathbb{R}$ je pro každé $t\in\mathcal{T}$ náhodná veličina.
%\begin{itemize}
%\item $X(t,\cdot):\Omega\to\mathbb{R}$ je pro každé $t\in T$ náhodná veličina,
%\item $X(\cdot,\omega):T\to\mathbb{R}$ je pro každé $\omega\in\Omega$ realizace náhodného procesu.
%\end{itemize}

Reálná funkce $X(\cdot,\omega)$ se nazývá \textit{trajektorie} nebo \textit{cesta} nebo \textit{realizace} stochastického procesu. 
\end{definice}
Množina parametrů $\mathcal{T}$ může být diskrétní nebo spojitá a v závislosti na tom pak mluvíme o \textit{diskrétním} nebo \textit{spojitém} stochastickém procesu. 

\begin{definice}[Ekvivalence stochastických procesů]
Dva stochastické procesy $X(t,\omega)$ a $Y(t,\omega)$ nazveme \textit{ekvivalentní} pokud platí
$$X(t,\cdot)=Y(t,\cdot)\text{ s pravděpodobností jedna pro každé }t\in\mathcal{T}.$$ 
V takovém případě hovoříme o tom, že jeden proces je \textit{verzí} druhého procesu.
\end{definice}

\begin{definice}[Systém distribučních funkcí stochastického procesu]
Nechť $\mathcal{T}_n$ je množina všech $n$-tic $\mathcal{T}_n=\{\boldsymbol{t}=(t_1,\dots,t_n):t_1\leq t_2\leq\cdots\leq t_n; t_i\in\mathcal{T}; i=1,\dots,n\}$,
pak \textit{distribuční funkcí} stochastického procesu rozumíme funkci
$$F_{\boldsymbol{t}}(\boldsymbol{x})=F_{t_1,\dots,t_n}(x_1,\dots,x_n)= \mathsf{Pr}(X_{t_1}\leq x_1,\dots,X_{t_n}\leq x_n),$$
pro všechna $\boldsymbol{t}=(t_1,\dots,t_n)\in \mathcal{T}_n$ a všechna $\boldsymbol{x}=(x_1,\dots,x_n)\in \mathbb{R}^n$.
Pro různá $n$ a různé $t_1,\dots,t_n$ dostáváme celý \textit{systém distribučních funkcí}, který označíme $\mathcal{F}$, a který plně popisuje pravděpodobnostní chovaní stochastického procesu.

\end{definice}

\begin{priklad}[Gaussovský proces]
\textit{Gaussovský proces} je stochastický proces, jehož rozdělení pravděpodobnosti je normální, tedy každá sdružená distribuční funkce $F_{\boldsymbol{t}}(\boldsymbol{x})$ je normální pro všechna $\boldsymbol{t}=(t_1,\dots,t_n)\in \mathcal{T}$ a $\boldsymbol{x}=(x_1,\dots,x_n)\in \mathbb{R}^n$.
\end{priklad}

Systém distribučních funkcí nese úplnou informaci o pravděpodobnostním chování stochastického procesu, nicméně podstatnou část této informace můžeme získat už jen z charakteristik popsaných v následující definicí.

\begin{definice}[Charakteristiky stochastického procesu]
Nechť $X(t)$ je stochastický proces takový, že pro každé $t\in \mathcal{T}$ existuje střední hodnota $\mathsf{E}{X(t)}$.
Pak funkce $\mu(t)$ definovaná na množině $\mathcal{T}$ předpisem
$$\mu(t)=\mathsf{E}{X(t)}$$
se nazývá \textit{střední hodnota stochastického procesu} $X(t)$.

Nechť $X(t)$ je stochastický proces takový, že pro každé $t\in\mathcal{T}$ platí $\mathsf{E}{|X(t)|^2<\infty}$ (říkáme, že má \textit{konečné druhé momenty}).
Pak funkce dvou proměnných $\gamma(s,t)$ definovaná na množině $\mathcal{T}\times \mathcal{T}$ předpisem
$$\gamma(s,t)=\mathsf{C}(X(s),X(t))=\mathsf{E}{\left[(X(s)-\mu(s))(X(t)-\mu(t))\right]}$$
se nazývá \textit{autokovarianční funkce stochastického procesu} $X(t)$.  
Speciálně hodnota $\gamma(t,t)=\mathsf{D}(X(t))$ této funkce se nazývá \textit{rozptyl stochastického procesu} v čase $t$ a budeme ji značit ${\sigma^2(t)}$.

Nechť $X(t)$ je stochastický proces s konečnými druhými momenty,
pak funkce $\rho(s,t)$ definovaná na množině $\mathcal{T}\times\mathcal{T}$ předpisem
$$\rho(s,t)=\frac{\mathsf{C}(X(s),X(t))}{\sqrt{\mathsf{D}(X(s))\mathsf{D}(X(t))}}=\frac{\gamma(s,t)}{\sqrt{\gamma(s,s)\gamma(t,t)}}$$
se nazývá \textit{autokorelační funkce stochastického procesu} $X(t)$.
\end{definice}

\begin{definice}[Stacionarita stochastického procesu]
Stochastický proces $X(t)$ nazveme \textit{striktně stacionární} pokud jsou jeho sdružené distribuční funkce invariantní vůči časovému posunu, tedy pro všechna $h\in\mathbb{R}$ takové, že $t_j\in\mathcal{T}$ a $t_j+h\in\mathcal{T}$ pro všechna $j$ platí
$$F_{t_1+h,\dots,t_n+h}(x_1,\dots,x_n)=F_{t_1,\dots,t_n}(x_1,\dots,x_n).$$   

Stochastický proces $X(t)$ nazveme \textit{slabě stacionární} pokud existuje konstanta $\mu\in\mathbb{R}$ a funkce $c:\mathbb{R}^+\to\mathbb{R}$ taková, že
$$\mathsf{E}{X(t)}=\mu\quad\text{ a }\quad\mathsf{C}(X(t),X(s))=c(|t-s|)$$
pro všechna $t,s\in\mathcal{T}$.
\end{definice}
Pro slabě stacionární proces zřejmě platí $\sigma^2(t)=c(0)$.
Procesy, které nejsou striktně stacionární, se nazývají evoluční. 

\begin{definice}[Nezávislost přírůstků stochastického procesu]
Přírůstky stochastického procesu $X(t)$ jsou \textit{nezávislé} právě tehdy, když pro všechny časové posloupnosti $\{t_i\}_{i=1}^N\subseteq\mathcal{T}$, kde $t_i<t_{i+1}$ a $N\in\mathbb{N}$, jsou přírůstky $X(t_{i+1})-X(t_i)$ nezávislé náhodné veličiny.
\end{definice}
%K popisu pravděpodobnostního chování stochastického procesu s nezávislými přírůstky je tedy dostačující znát distribuční funkci náhodné veličiny $X(t)$ a přírůstku stochastického procesu $X(t)-X(s)$, %pro pevně zvolené $t$ a $s$
%kde $t>s$.

\begin{definice}[Spojitost stochastického procesu]
Řekneme, že stochastický proces $X(t)$ je \textit{stochasticky spojitý v bodě} $t_0\in\mathcal{T}$, jestliže pro každé $\epsilon>0$ platí
%$$\lim_{t\to t_0}\Pr(|X_t-X_{t_0}|>\epsilon)=0.$$
$$\lim_{t\to t_0}\Pr(|X(t)-X(t_0)|>\epsilon)=0.$$
Stochastický proces je  \textit{stochasticky spojitý} (spojitý podle pravděpodobnosti), je-li spojitý v každém bodě množiny $\mathcal{T}$.
\end{definice}
Proces, který je spojitý podle předcházející definice, nemusí mít spojité trajektorie (například Poissonův proces).

%\begin{definice}[]
%\end{definice}

\subsection{Wienerův proces}\label{WP_kap}
Wienerův proces byl zaveden Norbertem Wienerem jako matematický popis Brownova pohybu.
Může být také interpretován jako limita náhodné procházky pro infinitezimální časový a prostorový krok.
%Zajímavostí Wienerova procesu je kombinace dvou vlastností,
%s pravděpodobností jedna má spojitou trajektorii a zároveň je nediferencovatelný v každém bodě. 
%Výjimečnou vlastností 
Pro trajektorie Wienerova procesu je typická kombinace dvou vlastností, spojitost a zároveň nediferencovatelnost v každém bodě.
Wienerův proces je základním stavebním kamenem pro konstrukci stochastického integrálu.

\begin{definice}[Wienerův proces]\label{WP_def}
Reálný stochastický proces $\{W(t):t\ge0\}$ na pravděpodobnostním prostoru $(\Omega,\mathcal{A},\mathsf{Pr})$ se nazývá \textit{Wienerův proces}, jestliže platí
\begin{enumerate}
\item$W(0)=0$, 
\item(spojitost trajektorií Wienerova procesu) s pravděpodobností jedna je funkce $t\to W(t)$ spojitá v $t$,
%\item(nezávislost a stacionarita přírůstků) přírůstky procesu jsou nezávislé a stacionární, tj.  pro každé $t\ge s\ge0$ má $W(t+s)-W(s)$ stejné rozdělení jako $W(t)-W(0)$,
\item(nezávislost přírůstků) přírůstky procesu jsou nezávislé,
\item(normalita přírůstků) pro každé $t\ge s\ge0$ má přírůstek $W(t)-W(s)$ normální rozdělení $\mathsf{N}(0, t-s)$.
\end{enumerate}
\end{definice}

Ukázku trajektorií Wienerova procesu můžeme vidět na Obrázku \ref{WP_graf}.

Z definice Wienerova procesu je zřejmé, že jeho střední hodnota $\mu(t)~=~0$ pro všechna $t\ge0$.
Snadno odvodíme vztah pro autokovarianční funkci Wienerova procesu $\rho(s,t)=\min(s,t)$.
Jestliže $0\leq s<t$, pak
\begin{align*}
\rho(s,t)=\mathsf{C}(W(s),W(t))&=\mathsf{E}{\left[(W(s)-\mu(s))(W(t)-\mu(t))\right]} \\
&=\mathsf{E}{\left[W(s)W(t)\right]}  \\
&=\mathsf{E}{\left[W(s)(W(t)-W(s)+W(s))\right]} \\
&=\mathsf{E}{\left[W(s)\right]}\mathsf{E}{\left[W(t)-W(s)\right]}+\mathsf{E}{\left[W(s)\right]}^2 \\
&=0\cdot0+s.
\end{align*}
To znamená, že Wienerův proces není slabě stacionární.

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 40]{IMG/WP_v2.pdf}
  \caption{Ukázka pěti trajektorií Wienerova procesu}  \label{WP_graf}
\end{figure}

Ceny aktiv na finačních trzích se podle teorie dokonalých trhů chovají zcela náhodně a nezávisle na předchozím vývoji.
Wienerův proces se tedy nabízí jako vhodný nástroj k popisu chování cen aktiv.
Při modelování ve finanční matematice využíváme procesy, které jsou zobecněním či modifikací Wienerova procesu. 
Uvažujme proces s nenulovým parametrem růstu, označovaným jako drift, a parametrem variability, jenž odpovídá směrodatné odchylce procesu.
\begin{definice}[Wienerův proces s driftem]\label{Wieneruv_proces_s_driftem}
Stochastický proces $X(t)$ definovaný jako
$$X(t)  = \mu\, t + \sigma\, W (t),$$
kde $\mu$ a $\sigma$ jsou konstanty a $W (t)$ je Wienerův proces,
se nazývá \textit{Wienerův proces  s driftem} $\mu$ a volatilitou $\sigma$.
\end{definice}
Pokud bychom chtěli využít tento proces k modelování cen podkladových aktiv, setkáme se s dvěma problémy.
Nejenže Wienerův proces s driftem může nabývat záporných hodnot, což je v rozporu s realitou chování cen podkladových aktiv, ale navíc by se model nechoval stejně při různých absolutních cenách aktiv. 
Aktivum s nižší současnou cenou by mělo větší riziko a také vyšší očekávaný výnos než aktivum s vyšší cenou.
Proto chceme proces upravit tak, aby absolutní očekávaný výnos a výše směrodatné odchylky byly proporcionální k ceně podkladového aktiva. 

Nejběžnější modifikací Wienerova procesu splňující tyto požadavky je Geometrický Wienerův proces, který v kontextu finanční matematiky použil poprvé Paul Samuelson \cite{samuelson1964rational}.
K rozšíření modelu používajícího tento proces přispěli především Fischer Black a Myron Scholes \cite{black1973pricing} a to zejména v kontextu oceňování opcí.

%V definici Geometrického Wienerova procesu využijeme stochastické diferenciální rovnice, které budou definovány v Kapitole \ref{SDR_kap}.
Geometrický Wienerův proces bývá často definován pomocí  stochastické diferenciální rovnice (které budou zavedeny v Kapitole \ref{SDR_kap}).
\begin{definice}[Geometrický Wienerův proces]\label{Geometricky_Wieneruv_proces}
Stochastický proces $S(t)$, který je řešením stochastické diferenciální rovnice 
\begin{equation}\label{SDE_GWP}
\frac{\mathrm{d} S(t)}{S(t)} = \mu\,\mathrm{d}t + \sigma\,\mathrm{d}W (t), 
\end{equation}
kde  $\mu$ a $\sigma$ jsou konstanty a $W (t)$ je Wienerův proces,
se nazývá \textit{Geometrický Wienerův proces}.

Toto řešení můžeme vyjádřit následovně
\begin{equation}\label{GWP}
S(t) = S(0)\,\mathrm{e}^{X(t)},
\end{equation}
kde $X(t) = (\mu - \frac{\sigma^2}{2})\,t + \sigma W (t)$ je Wienerův proces s driftem (viz Definice \ref{Wieneruv_proces_s_driftem}).
\end{definice}
Člen $\mathrm{d}W(t)$ ve stochastické diferenciální rovnici \eqref{SDE_GWP} označuje infinitezimální přírůstek Wienerova procesu a $\mathrm{d}t$ je infinitezimální změna času.

Z Definice \ref{Geometricky_Wieneruv_proces} je zřejmé, že Geometrický Wienerův proces nabývá pouze kladných hodnot a jeho relativní přírůstky jsou nezávislé a mají stejné rozdělení. 
Kromě toho se s tímto procesem docela snadno pracuje ve výpočtech. 
Díky těmto vlastnostem se stal nejrozšířenějším modelem chování cen aktiv ve finanční matematice.

Ukázku trajektorií Geometrického Wienerova procesu s různými parametry driftu a volatility znázorňuje Obrázek \ref{GP_graf}.

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/GP_v2.pdf}
  \caption{Ukázka pěti trajektorií Geometrického Wienerova procesu s různými parametry driftu $\mu$ a volatility $\sigma$}  \label{GP_graf}
\end{figure}


\subsection{Mnohorozměrný Wienerův proces}
Chceme-li uvažovat finanční trh s více rizikovými aktivy a zabývat se jejich vzájemnými vztahy, musíme zavést vícerozměrný Wienerův proces.
Aplikaci tohoto vektorového stochastického procesu využijeme v dynamické teorii portfolia.

\begin{definice}
Standardní \textit{$n$-rozměrný Wienerův proces} je vektorový stochastický proces
$$\boldsymbol{W}(t) = (W_1(t), \dots, W_n(t))^\mathrm{T}$$
jehož složky $W_k(t)$ jsou nezávislé, standardní jednorozměrné Wienerovy procesy.
\end{definice}
%Wienerův proces je stavebním kamenem matematického modelování ve finanční matematice. 
%Tento stochastický proces se používá pro popis chování ceny aktiva v čase. 

Na Obrázku \ref{WP_2D_graf} vidíme ukázku trajektorie dvourozměrného Wienerova procesu.
\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 20 25 50]{IMG/WP_2D_v6.pdf}
  \caption{Ukázka trajektorie dvourozměrného Wienerova procesu}  \label{WP_2D_graf}
\end{figure}


%\section{It\^oův integrál a It\^oovo lemma}
\subsection{It\^oův integrální počet a It\^oův proces}\label{Ito_kalkul}
Chceme-li používat modely založené na stochastických procesech se spojitým časem neobejdeme se bez stochastického integrálního počtu.
Proto se nyní budeme věnovat konstrukci stochastického integrálu, uvedeme It\^oovo lemma a vysvětlíme jeho přínos pro modelování ve finanční matematice.
Věty a lemmata budeme uvádět pouze bez důkazů, které jsou k nalezení v literatuře, viz například \cite{karatzas2012brownian}.

Kiyosi It\^o byl japonský matematik, jenž modernizoval stochastické modely a jeho metody jsou dodnes používány v mnoha odvětvích vědy především ve financích a biologii.
Svou práci začal stavět v roce 1940 na základě dřívějších objevů Alberta Einsteina a Norberta Wienera.
V teorii stochastických procesů aplikoval metody diferenciálního a integrálního počtu.
%Matematický rámec pro popis chování stochastických procesů, který zkonstruoval se je po něm pojmenován It\^oův kalkul.
Matematický rámec zahrnující stochastické integrály a stochastické diferenciální rovnice vešel ve známost jako It\^oův kalkul.
Z významných It\^ových textů zmiňme 
článek \cite{ito1944} z roku 1944 obsahující konstrukci stochastického integrálu
a publikace \cite{ito1946} a
\cite{ito1951stochastic}, kde zavádí koncept stochastických diferenciálních rovnic.

Robert C. Merton, nositel Nobelovy za ekonomii, využívá teoretické poznatky Kiyosi It\^oa jako nástroj pro výzkum vývoje cen akcií v portfoliu a k oceňování finančních derivátů.
Tyto postupy více přiblížíme v Kapitole \ref{stoch_model} o stochastickém modelování.

Abychom mohli v následujícím textu zavést stochastický integrál definujme nejdříve následující třídy procesů.
\begin{definice}
Nechť $\{W(t):t\ge0\}$ je Wienerův proces na pravděpodobnostním prostoru $(\Omega,\mathcal{A},\mathsf{Pr})$.
Řekneme, že stochastický proces $\{f(t,\omega):t\ge~0\}$ je \textit{neanticipativní}, jestliže pro všechna $t\ge0$ hodnota $f(t,\omega)$ závisí jen na hodnotách Wienerova procesu do času $t$.
\end{definice}

\begin{definice}\label{M}
Nechť $W(t,\omega)$ je Wienerův proces na pravděpodobnostním prostoru $(\Omega,\mathcal{A},\mathsf{Pr})$.
Symbolem $M$ označme třídu stochastických procesů \linebreak$f(t,\omega):\langle0,\infty)\times\Omega\to\mathbb R$ takových, že
\begin{enumerate}
\item $f(t,\omega)$ je neanticipativní, 
\item $\text{E}\left[\int_0^Tf^2(t,\omega)\,\mathrm{d}t\right]<\infty.$ 
\end{enumerate}
\end{definice}

\subsubsection{It\^oův integrál}\label{Ito_integral}
Důležitým nástrojem pro řešení stochastických diferenciálních rovnic je It\^oův integrál (nazývaný též jen stochastický integrál).
Jeho zavedení je vyžadováno nediferencovatelností trajektorií Wienerova procesu.

Konstrukci stochastického integrálu podle Wienerova procesu představil v letech 1942--1944 Kiyosi It\^o v \cite{ito1942differential} a \cite{ito1944}. 
Obecnější stochastický integrál, který je založený na širší třídě stochastických procesů, zkonstruovali v roce 1967 Hiroshi Kunita a Shinzo Watanabe v \cite{kunita1967square}.


Stochastický integrál budeme konstruovat obdobným způsobem jako Riemannův integrál.
Nejprve It\^oův integrál definujeme pro jednoduché procesy, následně definici rozšíříme na větší třídu procesů pomocí aproximace.

\begin{definice}\label{jednoduchafunkce}
Stochastický proces $S$ se nazývá \textit{jednoduchý}, %(nebo \textit{jednoduchá funkce}), 
jestliže existuje dělení $D=\{0=t_0<t_1<\cdots<t_{n-1}<t_n=T\}$ tak, že pro každé $t$, $t_k\le t<t_{k+1}$, $k=0,1,\dots,n-1$, je $S(t,\omega)=S_k(\omega)$, pro nějaké náhodné veličiny $S_k$. 
\end{definice}
Z Definice \ref{jednoduchafunkce} vyplývá, že trajektorie jednoduchého procesu je po částech konstantní. 

\begin{definice}
Nechť $S$ je jednoduchý proces a zaveďme označení \linebreak$\Delta W_k=W(t_{k+1},\omega)-W(t_k,\omega)$.
Pak
$$\int_0^TS\,\mathrm{d}W=\sum_{k=0}^{n-1}S_k\Delta W_k$$
se nazývá \textit{It\^oův integrál} procesu $S$ na intervalu $\langle 0,T\rangle$.
\end{definice}

Pomocí limitního přechodu rozšíříme definici It\^oova integrálu pro jednoduché procesy na integrál pro obecný stochastický proces.

\begin{lemma} \label{itoint}
Nechť $f$ je stochastický proces patřící do třídy $M$ dle Definice \ref{M}.
Pak existuje posloupnost jednoduchých procesů $\{f_n:n\in\mathbb N\}$ tak, že pro $n\to\infty$ platí
$$\mathrm{E}\left[\int_0^T\big[f(t)-f_n(t)\big]^2\mathrm{d}t\right]\longrightarrow0.$$
\end{lemma}

\begin{definice}[It\^oův integrál]\label{Ito_int}
Nechť $\{f_n:n\in\mathbb N\}$ je posloupnost jednoduchých procesů z Lemmatu \ref{itoint}.
Pro obecný proces $f(t,\omega)\in M$ definujeme \textit{It\^oův integrál} předpisem
$$\int_0^Tf(t,\omega)\,\mathrm{d}W=\lim_{n\to\infty}\int_0^Tf_n(t,\omega)\,\mathrm{d}W.$$
\end{definice}
Definice \ref{Ito_int} není závislá na volbě aproximující posloupnosti $f_n$ viz \cite{oksendal2003stochastic}.

\subsubsection{It\^oův proces}
%Abychom mohli v následujícím textu zavést stochastický integrál definujme nejdříve širokou třídu procesů, tzv. It\^oových procesů.
%Zavedeme obecný stochasticky proces, který využijeme při konstrukci It\^oova lemmatu v další části. 
%Stochastický proces dostatečně obecný abychom mohli zavést stochastický integrál, pojmenovaný po známém matematikovi

It\^oův integrál využijeme při definování obecného stochastického procesu, který využijeme při konstrukci It\^oova lemmatu v další části.
Bude se jednat o nejobecnější typ stochastického procesu, který v této práci budeme uvažovat.

\begin{definice}[It\^oův proces]
Nechť $W(t,\omega)$ je Wienerův proces na pravděpodobnostním prostoru $(\Omega,\mathcal{A},\mathsf{Pr})$.
\textit{It\^oův proces} je stochastický proces
$$X(t,\omega)=X(0,\omega)+\int_0^tU(s,\omega)\,\mathrm{d}s+\int_0^tV(s,\omega)\,\mathrm{d}W(s,\omega),$$
kde $U(t,\omega)$ a $V(t,\omega)$ jsou stochastické procesy patřící do třídy $M$,
první integrál je Lebesgueův a druhý It\^oův. %(který je definován v Kapitole \ref{Ito_integral}).

Často se používá diferenciální tvar nazývaný \textit{stochastický diferenciál}
$$\mathrm{d}X(t,\omega)=U(t,\omega)\,\mathrm{d}t+V(t,\omega)\,\mathrm{d}W(t,\omega).$$
\end{definice}

%Geometrický Wienerův proces je speciálním případem It\^oova procesu, kde $U(t,\omega)=\mu\,X(t,\omega)$ a $V(t,\omega))=\sigma X(t,\omega)$.

\subsubsection{It\^oovo lemma}
It\^oovo lemma je nástrojem pro práci s It\^oovým integrálem a stochastickými diferenciálními rovnicemi.
Říká, že It\^oovy procesy tvoří uzavřenou třídu vzhledem ke skládání s hladkými funkcemi.
Kiyosi It\^o jej publikoval v roce 1944 v článku \cite{ito1944}.
\begin{veta}[It\^oovo lemma]\label{ito_lemma}
Nechť $X(t,\omega)$ je It\^oův proces se stochastickým diferenciálem
$$\mathrm{d}X=U\,\mathrm{d}t+V\,\mathrm{d}W.$$
Nechť $g(t,x):(0,\infty)\times\mathbb R\to\mathbb R$ je dvakrát spojitě diferencovatelná funkce.
Potom $Y(t)=g(t,X(t))$ je také It\^oův proces.
Jeho stochastický diferenciál má tvar
\begin{alignat*}{2}
\mathrm{d}Y=\frac{\partial g}{\partial t}\mathrm{d}t+\frac{\partial g}{\partial x}\,\mathrm{d}X+\frac12\frac{\partial^2 g}{\partial x^2}(\mathrm{d}X)^2=\left[\frac{\partial g}{\partial t}+\frac{\partial g}{\partial x}U+\frac12\frac{\partial^2 g}{\partial x^2}V^2\right]\mathrm{d}t+\frac{\partial g}{\partial x}V\mathrm{d}W.
\end{alignat*}
\end{veta}

It\^oovo lemma můžeme považovat za analogii Taylorova rozvoje v integrálním počtu.
Tento důležitý vztah stochastické analýzy budeme využívat pro oceňování finančních derivátů, jejichž hodnota je závislá na hodnotě podkladového aktiva.


\subsection{Ornstein–Uhlenbeckův proces}\label{OU_kap}
Další často využívanou modifikací Wienerova procesu jsou stochastické procesy s tendencí vracet se k dlouhodobé rovnovážné hodnotě.
Nazývají se \textit{mean-reversion procesy} a nachází četné využití ve fyzice, matematice i ekonomii.
Ve finanční matematice se používají pro modelování úrokových sazeb, kurzů měn, cen komodit a volatility.
%Ornstein–Uhlenbeckův proces je další často využívanou modifikací Wienerova procesu.
%Mean-reversion jsou procesy, ve kterých se náhodná veličina vrací k dlouhodobé rovnovážné hodnotě. 
%Používají se zvláště pro modely úrokových sazeb. 
%V následujícím textu jsou uvedeny nejčastěji užívané procesy.

Holandští fyzikové Leonard Salomon Ornstein a George Eugene Uhlenbeck zformulovali jako první mean-reversion proces v roce 1930 a publikovali v textu \cite{OrnsteinUhlenbeck1930}. 

\begin{definice}[Ornstein–Uhlenbeckův proces]
\textit{Ornstein–Uhlenbeckův proces} je definován jako
\begin{equation}\label{OUP}
X(t) = X(0)\,\mathrm{e}^{-\theta t} + \mu\,(1-\mathrm{e}^{-\theta t}) + \mathrm{e}^{-\theta t}\int_0^t \sigma\,\mathrm{e}^{\theta s}\,\mathrm{d}W(s),
\end{equation}
kde parametr $\theta>0$ je koeficient rychlosti reverze, parametr $\mu\in\mathbb{R}$ je rovnovážná hodnota, parametr $\sigma>0$ je volatilita a $W_t$ je Wienerův proces.
Ornstein–Uhlenbeckův proces může být také definován jako řešení stochastické diferenciální rovnice
\begin{equation}\label{SDE_OUP}
\mathrm{d}X(t) = \theta(\mu-X(t))\,\mathrm{d}t + \sigma\,\mathrm{d}W(t).
\end{equation}
\end{definice}

Ornstein–Uhlenbeckův proces je stacionární Gaussovský proces s ohraničeným rozptylem. 
Koeficient $\theta$ určuje rychlost přibližování k rovnovážné hodnotě $\mu$. %(nebo také střední hodnotě).
Čím je $\theta$ větší tím pohotověji proces reaguje na odchýlení od rovnováhy. 
Na rozdíl od Wienerova procesu nemá Ornstein–Uhlenbeckův proces konstantní koeficient driftu, jelikož závisí na jeho aktuální hodnotě.
Pokud je aktuální hodnota procesu $X_t$ menší než rovnovážná hodnota $\mu$, pak je koeficient driftu kladný.
Naopak když $X_t>\mu$, tak je koeficient driftu záporný.

Ukázku trajektorií Ornstein–Uhlenbeckova procesu s danými parametry najdeme na Obrázku \ref{OU_graf}.

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/OU_v4.pdf}
  \caption{Ukázka pěti trajektorií Ornstein–Uhlenbeckova procesu s parametry $\theta=1$, $\mu=2$ a  $\sigma=0,1$ a počáteční hodnotou $X_0=2$.}  \label{OU_graf}
\end{figure}

%\cite{Benth2016}
Vlastnostem Ornstein–Uhlenbeckova procesu (především stacionaritě) se zevrubně věnují Fred Espen Benth a Asma Khedher v knize \cite{podolskij2015fascination} z roku 2015, která je aktuální sbírkou prací vědců v oboru pravděpodobnosti, statistiky a jejich aplikací ve financích, ekonomii, fyzice, řízení rizika a systémů hromadné obsluhy.



%%%%%%%%%%%%%%%%%%{Stochastické diferenciální rovnice}

\section{Stochastické diferenciální rovnice}
%http://artax.karlin.mff.cuni.cz/~masas7am/bakalarka/bakalarka.pdf
%Stochastické diferenciální rovnice (SDR) se používají při modelování dynamických jevů, v nichž hraje roli náhoda. 
%Za první počiny v této oblasti lze považovat pokusy o matematický model Brownova pohybu z přelomu 19. a 20. století. 
%Ale až stochastický integrál, který definoval v roce 1944 japonský matematik Kiyoshi It\^o, a s ním spojený It\^oův kalkul umožnil formulovat a řešit skutečné stochastické diferenciální rovnice. 
%Ty od té doby našly uplatnění v mnoha oborech -- od fyziky přes biologii až po modelování cen akcií ve finanční matematice.
%vývoj a chování v čase
%Pomocí diferenciálních rovnic lze popsat celou řadu zákonitostí, které se objevují v přírodních a společenských vědách.
%Řešeními diferenciálních rovnic jsou funkce, které popisují vlastnosti zkoumaných jevů. 

Pomocí diferenciálních rovnic jsme schopni popsat množství zákonitostí platných ve vědeckých oborech přírodních, společenských i ekonomických.
Řešení diferenciálních rovnic jsou funkce popisující vlastnosti zkoumaných jevů.
Stochastické diferenciální rovnice (SDR) nám umožňují modelovat dynamiku \textit{náhodných jevů}.
K formulování a řešení SDR je využíván It\^oův kalkul popsaný v Kapitole \ref{Ito_kalkul}.
Aplikací stochastických diferenciálních rovnic ve stochastickém modelování se zabýváme v Kapitole \ref{stoch_model}, kde uvádíme modely popisující vývoj a chování cen finančních aktiv v čase.

Základní studijní literaturou nám byla monografie Bernta {\O}ksendala \cite{oksendal2003stochastic}.
Pracovali jsme také s texty \cite{cyganowski1998maple} a \cite{cyganowski2002elementary}, které napsal Sasha Cyganowski s kolektivem autorů.

%Stochastická diferenciální rovnice je rovnice popisující přírůstky stochastického procesu v čase. 
%Ve finanční matematice se používá například pro popis přírůstku hodnoty nějakého aktiva.
\subsection{Úvod do teorie stochastických diferenciálních rovnic}\label{SDR_kap}
Na úvod do teorie SDR uveďme základní definice, používané značení a podmínky řešitelnosti.
\begin{definice}[Stochastická diferenciální rovnice]
Nechť $\alpha(t,x)$ a $\beta(t,x)$ jsou funkce dvou proměnných $\alpha,\beta:\mathcal{T}\times\mathbb{R}\to\mathbb{R}$.

\textit{Stochastickou diferenciální rovnicí (SDR)} rozumíme rovnici
\begin{equation}\label{SDR_reseni}
X(t)=X_0+\int_{t_0}^t\alpha(s,X(s))\,\mathrm{d}s+\int_{t_0}^t\beta(s,X(s))\,\mathrm{d}W(s),
\end{equation}
kde první integrál je Lebesgueův a druhý integrál je It\^oův definovaný v Kapitole \ref{Ito_integral}.
Častěji se s SDR setkáváme v jejím diferenciálním tvaru
\begin{align}\label{SDR_def}
\mathrm{d}X(t)&=\alpha(t,X(t))\,\mathrm{d}t+\beta(t,X(t))\,\mathrm{d}W(t),\\%\qquad 
X(t_0)&=X_0.\notag
\end{align}
Náhodnou veličinu $X(t_0)=X_0$ nazýváme \textit{počáteční podmínkou SDR} a stochastický proces $X(t)$ splňující vztah \eqref{SDR_reseni}, nazýváme \textit{řešením SDR} na $\mathcal{T}$.
\end{definice}
%Uvažujme o existenci a jednoznačnosti řešení SDR.

Uvažujme $n$ stochastických procesů $X_1(t),\dots,X_n(t)$, které popisují nějakým způsobem související náhodné jevy, například vývoj cen $n$ různých akcií na kapitálovém trhu. 
K popisu chování takových procesů v čase slouží soustavy stochastických diferenciálních rovnic (někdy označované jako systémy SDR) .
\begin{definice}[Soustava $n$ stochastických diferenciálních rovnic]
Nechť
%$$\boldsymbol\alpha(\boldsymbol t,\boldsymbol X(t))=\big(\alpha^1(t,\boldsymbol{X}(t)),\dots,\alpha^n(t,\boldsymbol{X}(t))\big)^\mathrm{T}$$
$$\boldsymbol\alpha( t,\boldsymbol x)=\big(\alpha^1( t,\boldsymbol{x}),\dots,\alpha^n(t,\boldsymbol{x})\big)^\mathrm{T}$$
je spojitá vektorová funkce $\boldsymbol\alpha:\mathcal{T}\times\mathbb{R}^n\to\mathbb{R}^n$.
Pro $j=1,\dots,m$ označíme 
%$$\boldsymbol\beta^{j}(\boldsymbol t,\boldsymbol X(t))=\big(\beta^{1,j}(t,\boldsymbol{X}(t)),\dots,\beta^{n,j}(t,\boldsymbol{X}(t))\big)^\mathrm{T}$$
$$\boldsymbol\beta^{j}(t,\boldsymbol x)=\big(\beta^{1,j}(t,\boldsymbol{x}),\dots,\beta^{n,j}(t,\boldsymbol{x})\big)^\mathrm{T}$$
a nechť $\boldsymbol{B}=(\boldsymbol\beta^{1},\dots,\boldsymbol\beta^{m})$ je spojitá maticová funkce $\boldsymbol{B}:\mathcal{T}\times\mathbb{R}^n\to\mathbb{R}^{n\times m}$.

Pro $j=1,\dots,m$ rozumíme \textit{soustavou stochastických diferenciálních rovnic} systém
\begin{equation}\label{SSDR_reseni}
X^i(t)=X^i_0+\int_{t_0}^t\alpha^i(s,\boldsymbol{X}(s))\,\mathrm{d}s+\sum_{j=1}^m\int_{t_0}^t\beta^{i,j}(s,\boldsymbol{X}(s))\,\mathrm{d}W^j(s),\\%\qquad 
\end{equation}
kde první integrál je opět Lebesgueův a integrály v sumě jsou It\^oovy stochastické integrály.
Diferenciální tvar soustav SDR zapíšeme ve formě
\begin{align}\label{SSDR_def}
\mathrm{d}X^i(t)&=\alpha^i(t,\boldsymbol{X}(t))\,\mathrm{d}t+\sum_{j=1}^m\beta^{i,j}(t,\boldsymbol{X}(t))\,\mathrm{d}W^j(t),\\%\qquad 
X^i(t_0)&=X^i_0.\notag
\end{align}
kde $\boldsymbol{W}({t})=(W^1(t),\dots,W^m(t))^\mathrm{T}$ je $m$-rozměrný Wienerův proces.
\end{definice}

\subsubsection{Existence a jednoznačnost řešení}
Teorie o existenci a jednoznačnosti řešení stochastických diferenciálních rovnic a jejich soustav vychází z podobných přístupů jako v případě obyčejných diferenciálních rovnice.
Zejména se předpokládají určité vlastnosti koeficientů rovnic jako je lokální Lipschitzova spojitost.
Následující věta shrnuje podmínky existence a jednoznačnosti řešení soustavy stochastických diferenciálních rovnic.
\begin{veta}[O existenci a jednoznačnosti řešení soustav SDR]
Nechť jsou $\boldsymbol\alpha:\mathcal{T}\times\mathbb{R}^n\to\mathbb{R}^n$ a $\boldsymbol{B}:\mathcal{T}\times\mathbb{R}^n\to\mathbb{R}^{n\times m}$ měřitelné funkce splňující podmínku
\begin{equation}\label{glob_Lipschitzova_podminka}
||\boldsymbol\alpha( t,\boldsymbol x)||+||\boldsymbol{B}( t,\boldsymbol x)||\leq C(1+{||\boldsymbol x||}),
\end{equation}
pro každé $\boldsymbol x\in\mathbb{R}^n$ a $t\in \mathcal{T}$ a pro nějakou kladnou konstantu $C$.
Dále nechť funkce $\boldsymbol\alpha$ a $\boldsymbol B$ splňují podmínku
\begin{equation}\label{loc_Lipschitzova_podminka}
||\boldsymbol\alpha( t,\boldsymbol x)-\boldsymbol\alpha( t,\boldsymbol y)||+||\boldsymbol{B}( t,\boldsymbol x)-\boldsymbol{B}( t,\boldsymbol y)||\leq D||\boldsymbol x-\boldsymbol y||,
\end{equation}
pro každé $\boldsymbol x , \boldsymbol y\in\mathbb{R}^n$ a $t\in \mathcal{T}$ a pro nějakou kladnou konstantu $D$.
Dále nechť $\boldsymbol X_0$ je náhodný vektor, který může být závislý na hodnotách Wienerova procesu $\boldsymbol W(t)$ pouze v čase $t_0$,%nezávislý na trajektorii Wienerova procesu $\boldsymbol W(t)$ 
a platí
\begin{equation}\label{podminka_tri}
\mathrm{E}\left[||\boldsymbol X_0||^2\right]<\infty.
\end{equation} 
Pak má soustava stochastických diferenciálních rovnic \eqref{SSDR_def} jednoznačné řešení na $\mathcal{T}$.
\end{veta}
\begin{proof}
Viz \cite{oksendal2003stochastic}.
\end{proof}

\subsection{Numerické metody řešení stochastických diferenciálních rovnic}
%citace: Peter E. Kloeden Eckhard Platen Henri Schurz Numerical Solution of SDE Through Computer Experiments
%An Introduction to Stochastic Processes with Applications to Biology Linda J. S. Allen
Numerické metody využíváme v případě kdy není možno určit řešení SDR analyticky.
Základním principem numerických metod je diskretizace proměnných.
Numerická metoda určí aproximaci řešení v diskrétních časových hodnotách a spojitou aproximaci řešení získáme použitím interpolačních metod.

Pro obeznámení s numerickými metodami řešení SDR a jejich soustav jsme zvolili monografii Petera Erise Kloedena, Eckharda Platena a Henriho Schurze \cite{kloeden1997}.
Dalším zdrojem nám byla již zmiňovaná kniha \cite{cyganowski2002elementary} autorů Cyganowski, Kloeden a Ombach.
Využití numerických řešení SDR při oceňování finančních derivátů popisuje Timothy Sauer \cite{sauer2012numerical}.

\subsubsection{Eulerova metoda}
Základní numerická metoda pro řešení obyčejných diferenciálních rovnic je pojmenovaná po významném švýcarském matematikovi a fyzikovi Leonhardu Paulu Eulerovi, který ji zpracoval ve své knize \textit{Institutionum calculi integralis} publikované roku 1768, \cite{euler1768institutionum}.
Tato metoda byla v roce 1955 modifikována japonským matematikem Gisiro Maruyamou \cite{maruyama1955continuous}, aby umožňovala řešit SDR.
Jedná se o nejjednodušší metodu, která slouží ke konstrukci složitějších numerických metod pro řešení SDR.

Uvažujme It\^oův proces $X(t)$, který je řešením SDR definované vztahem \eqref{SDR_def}.
Nechť $\{t_n\}_{n=0}^N\subseteq \mathcal{T}$ je časová posloupnost, kde pro všechna $n$ platí $t_n<t_{n+1}$.
Tato  posloupnost se nazývá \textit{diskretizace} časové proměnné.
V Eulerově metodě diferenciál $\mathrm{d}X(t)$ aproximujeme přírůstkem stochastického procesu $\Delta X_n=X(t_{n+1})-X(t_n)$.
Hodnota $X(t_{n+1})$ je aproximována pomocí hodnoty $X(t_{n})$ v předcházejícím časovém kroku.
\begin{definice}\label{Euler_def}
Nechť $X_n$ značí aproximaci řešení $X(t_{n})$ stochastické diferenciální rovnice \eqref{SDR_def} v čase $t_n$.
Pak \textit{Eulerova metoda} řešení SDR je definována rekurzívním vztahem
\begin{equation}\label{Euler}
X_{n+1}=X_n+\alpha(t_n,X_n)\Delta_n+\beta(t_n,X_n)\Delta W_n,
\end{equation}
kde $\Delta_n=\int_{t_n}^{t_{n+1}}\mathrm{d}t=t_{n+1}-t_n$ je délka časového intervalu $(t_n,t_{n+1})$
a $\Delta W_n=\int_{t_n}^{t_{n+1}}\mathrm{d}W(t)=W(t_{n+1})-W(t_n)$ je přírůstek Wienerova procesu $W$ v čase $(t_n,t_{n+1})$.

Zobecníme-li Eulerovu metodu pro soustavu $m$ stochastických diferenciálních rovnic \eqref{SSDR_def}, pak vztah pro $i$-tou složku aproximace řešení je definován předpisem
\begin{equation}\label{Euler_soustava}
X_{n+1}^i=X_n^i+\alpha^i(t_n,\boldsymbol{X}_n)\Delta_n+\sum_{j=1}^m\beta^{i,j}(t_n,\boldsymbol{X}_n)\Delta W_n^j.
\end{equation}
%kde $\boldsymbol{X}$ je $m$-rozměrný Wienerův proces.
\end{definice}

\textit{Eulerova aproximace} je spojitý stochastický proces, který v daných časech $\{t_n\}_{n=0}^N\subseteq \mathcal{T}$ splňuje vztah \eqref{Euler} a hodnoty mezi těmito časovými body získáme pomocí lineární interpolace.

Většinou se předpokládá, že časová posloupnost $\{t_n\}_{n=0}^N\subseteq \mathcal{T}$ je ekvidistantní. 
Důležitou problematikou při používání numerických metod je způsob výpočtu $\Delta W_n$.
Z vlastnosti Wienerova procesu plyne, že $\Delta W_n\sim\mathsf{N}(0, \Delta_n)$.

\subsubsection{Milsteinova metoda}
Milsteinova numerická metoda řešení SDR je popsána v knihách Eckharda Platena \cite{platen2010numerical} a Paula Glassermana \cite{glasserman2003monte}.
Tuto metodu poprvé představil Grigori N. Milstein ve svém článku \cite{milstein1974approximate} v roce 1974.
Metoda se snaží zdokonalit aproximaci difuzního členu tím, že aditivně připojuje třetí člen k Eulerovově diskretizaci.
%Přitom se využívá stochastický Taylorův rozvoj. 
Pro odvození podoby tohoto členu je využíváno  It\^oovo lemma, které je aplikováno na koeficienty stochastického procesu.
Následnými úpravami a zanedbáním členů vyšších řádů získáme vztah uvedený v Definici \ref{Milstein_def}.
Poznamenejme, že pro správné fungování Milsteinovy metody je narozdíl od Eulerovy metody potřebný předpoklad diferencovatelnosti funkce $\beta(t,\boldsymbol{x})$ podle složek $\boldsymbol{x}$.
\begin{definice}\label{Milstein_def}
Nechť $X_n$ značí aproximaci řešení $X(t_{n})$ stochastické diferenciální rovnice \eqref{SDR_def} v čase $t_n$.
Pak \textit{Milsteinova metoda} řešení SDR je definována rekurzívním vztahem
\begin{align}\label{Milstein}
X_{n+1}&=X_n+\alpha(t_n,X_n)\Delta_n+\beta(t_n,X_n)\Delta W_n \\ \notag
&+\frac12\beta(t_n,X_n)\beta'(t_n,X_n)\big((\Delta W_n)^2-\Delta_n\big),
\end{align}
kde $\beta'(t_n,X_n)$ je derivace $\beta(t_n,X_n)$ podle $X_n$,
$\Delta_n=\int_{t_n}^{t_{n+1}}\mathrm{d}t=t_{n+1}-t_n$ je délka časového intervalu $(t_n,t_{n+1})$
a $\Delta W_n=\int_{t_n}^{t_{n+1}}\mathrm{d}W(t)=W(t_{n+1})-W(t_n)$ je přírůstek Wienerova procesu $W$ v čase $(t_n,t_{n+1})$.

Poznamenejme, že v případě, kdy koeficient $\beta(t,X(t))=\beta(t)$ nezávisí na procesu $X(t)$, pak $\beta'(t,X(t))=0$ a Milsteinova metoda je identická s metodou Eulerovou.

Zobecníme-li Milsteinovu metodu pro soustavu $m$ stochastických diferenciálních rovnic \eqref{SSDR_def}, pak vztah pro $i$-tou složku aproximace řešení je definován předpisem
\begin{align}\label{Milstein_soustava}
X_{n+1}^i&=X_n^i+\alpha^i(t_n,\boldsymbol{X}_n)\Delta_n+\sum_{j=1}^m\beta^{i,j}(t_n,\boldsymbol{X}_n)\Delta W_n^j \\ \notag 
%&+\sum_{j=1}^m\sum_{k=1}^m\beta^{i,j}(t_n,\boldsymbol{X}_n)\sum_{l=1}^m\frac{\partial\beta^{i,k}(t_n,\boldsymbol{X}_n)}{\partial X_l}\int_{t_n}^{t_{n+1}}\!\int_{t_n}^{t}\mathrm{d}W^k(s)\mathrm{d}W^j(t).
&+\sum_{j=1}^m\sum_{k=1}^m\beta^{i,j}(t_n,\boldsymbol{X}_n)\sum_{l=1}^m\frac{\partial\beta^{i,k}(t_n,\boldsymbol{X}_n)}{\partial X_l}\int_{t_n}^{t_{n+1}}\big(W^k(t)-W^k(t_n)\big)\,\mathrm{d}W^j(t).
\end{align}
%kde $\boldsymbol{X}$ je $m$-rozměrný Wienerův proces.
\end{definice}

Pro $j=k$ je možno It\^oův integrál $\int_{t_n}^{t_{n+1}}\big(W^k(t)-W^k(t_n)\big)\,\mathrm{d}W^j(t)$ vyjádřit pomocí časového přírůstku $\Delta_n$ a přírůstku Wienerova procesu $\Delta W^k_n$ jako 
$$\int_{t_n}^{t_{n+1}}\big(W^k(t)-W^k(t_n)\big)\,\mathrm{d}W^k(t)=\frac12\big((\Delta W^k_n)^2-\Delta_n\big).$$
Avšak pro $j\neq k$ obdobné vyjádření neexistuje a integrál je nutné simulovat.
V uvedené literatuře lze nalézt různé přístupy k tomuto problému.
Například simulace využívající distribuční funkce, nebo substituování jednodušší náhodnou veličinou, případně zavedení zjednodušujících předpokladů o funkci volatility $\beta(t,\boldsymbol{x})$.
%Nicméně tyto úvahy jsou již nad rámec této práce.

\subsubsection{Konvergence}
Chceme-li posuzovat kvalitu jednotlivých numerických metod řešení SDR a~vzájemně je porovnávat, zkoumáme odchylku aproximace řešení od přesného řešení (tzv. chybu aproximace).
V literatuře se běžně setkáváme se dvěma kategoriemi kriterií sloužící k posouzení konvergence aproximace k~přesnému řešení.
Jsou to silná konvergenční kritéria a slabá konvergenční kritéria. 

Označme $X(t)$ přesné řešení SDR v čase $t$ a $\hat X(t)$ jeho aproximaci určenou pomocí zvolené numerické metody.
Uvědomme si, že v každém čase~$t$ jsou jak přesné řešení SDR, tak jeho aproximace náhodné veličiny.
Slabá konvergence sleduje velikost odchylky středních hodnot řešení SDR a jeho aproximace, naproti tomu silná konvergence uvažuje střední hodnotu odchylek $X(t)$ a~$\hat X(t)$.
%Uvažujme za jakých podmínek aproximace řešení SDR konverguje k přesnému řešení pro zmenšující se časový krok.  
%Uvědomme si, že jak přesné řešení SDR $X(t_{n})$, tak jeho aproximace $X_n$ jsou v každém čase $t_n$ náhodné veličiny.
%Budeme definovat dva typy konvergence.
%Slabá konvergence sleduje velikost odchylky středních hodnot řešení SDR a jeho aproximace, naproti tomu silná konvergence uvažuje střední hodnotu odchylek $X(t_{n})$ a $X_n$.
%K porovnání jednotlivých numerických metod řešení SDR slouží mimo jiné řád konvergence.

V následujících Definicích \ref{konvergence_weak_def} a \ref{konvergence_def} budeme předpokládat, že diskretizace času $\{t_n\}_{n=0}^N\subseteq \langle0,T\rangle$ je ekvidistantní posloupnost, tzn. $\Delta_n=\Delta$ pro všechna~$n$.
Pro ekvidistantní posloupnost platí $t_n=n\Delta$, kde přirozená čísla $n\in\left\langle0,\left\lfloor\frac{T}{\Delta}\right\rfloor\right\rangle$.

\begin{definice}\label{konvergence_weak_def}
%Uvažujme diskretizaci času $\{t_n\}_{n=0}^N\subseteq \mathcal{T}$.%\subseteq\langle 0,T\rangle$.
%Označme $X(t_n)$ přesné řešení SDR v čase $t_n$ a $X_n$ příslušnou aproximaci řešení v čase $t_n$.
%Řekneme, že aproximace $\hat X(t)$ \textit{slabě konverguje} k přesnému řešení $X(t)$ v čase $t$, jestliže platí
Řekneme, že aproximace $\hat X(T)$ \textit{slabě konverguje} k přesnému řešení $X(T)$ v čase $T$, jestliže platí
\begin{equation}
%\lim_{\Delta\to0}\left[\sup_{0\leq t\leq T}\left|\mathsf{E}\big(f(X(t))\big)-\mathsf{E}\big(f(\hat X(t))\big)\right|\right]=0
\lim_{\Delta\to0}\left|\mathsf{E}\big(f(X(T))\big)-\mathsf{E}\big(f(\hat X(T))\big)\right|=0
\end{equation}
pro každou polynomiální funkci $f(x)$.

%Řekneme, že numerická metoda má \textit{slabý řád konvergence $q$}, jestliže existuje kladná konstanta $K$ taková, že pro všechna $n$ platí
%Řekneme, že numerická metoda má \textit{slabý řád konvergence $q$}, jestliže existuje kladná konstanta $K$ taková, že pro všechna $t$ platí
Řekneme, že numerická metoda má \textit{slabý řád konvergence $q$}, jestliže existuje kladná konstanta $K$, nezávislá na $\Delta$, taková, že platí
\begin{equation}\label{konvergence_weak_vztah}
%\left|\mathsf{E}\big(f(X(t_n))\big)-\mathsf{E}\big(f(X_n)\big)\right|\leq K\Delta^q,
%\left|\mathsf{E}\big(f(X(t))\big)-\mathsf{E}\big(f(\hat X(t))\big)\right|\leq K\Delta^q.
\left|\mathsf{E}\big(f(X(T))\big)-\mathsf{E}\big(f(\hat X(T))\big)\right|\leq K\Delta^q.
\end{equation}
%kde  $\Delta=\max_{0\leq n\leq N-1}\Delta_n$.
Levá strana vztahu \eqref{konvergence_weak_vztah} se nazývá slabá chyba aproximace.
\end{definice}
Pro různou volbou polynomu $f(x)$ dostáváme konvergenci různých momentů řešení SDR.

\begin{definice}\label{konvergence_def}
%Uvažujme diskretizaci času $D=\{t_n\}_{n=0}^N\subseteq \mathcal{T}$.
%Řekneme, že aproximace $\hat X(t)$ \textit{silně konverguje} k přesnému řešení $X(t)$ v čase $t$, jestliže platí
Řekneme, že aproximace $\hat X(T)$ \textit{silně konverguje} k přesnému řešení $X(T)$ v čase $T$, jestliže platí
\begin{equation}
%\lim_{\Delta\to0}\left[\sup_{0\leq t\leq T}\mathsf{E}\big(|X(t)-\hat X(t)|\big)\right]=0.
\lim_{\Delta\to0}\mathsf{E}\big(|X(T)-\hat X(T)|\big)=0.
\end{equation}
%kde $||D||=\max_{0\leq n\leq N-1}\Delta_n$, $X(T)$ je přesné řešení SDR v čase $T$ a $X_D(T)$ značí aproximaci řešení v čase $T$ příslušnou diskretizaci $D$.

%Řekneme, že numerická metoda má \textit{silný řád konvergence $p$}, jestliže existuje kladná konstanta $K$ taková, že pro všechna $D$ platí
%Řekneme, že numerická metoda má \textit{silný řád konvergence $p$}, jestliže existuje kladná konstanta $K$ taková, že pro všechna $t$ platí
Řekneme, že numerická metoda má \textit{silný řád konvergence $p$}, jestliže existuje kladná konstanta $K$, nezávislá na $\Delta$, taková, že platí
\begin{equation}\label{konvergence_vztah}
%\mathsf{E}\big(|X(T)-X_D(T)|\big)\leq K\Delta^p,
%\mathsf{E}\big(|X(t)-\hat X(t)|\big)\leq K\Delta^p.
\mathsf{E}\big(|X(T)-\hat X(T)|\big)\leq K\Delta^p.
\end{equation}
%kde  $\Delta=\max_{0\leq n\leq N-1}\Delta_n$.
Levá strana vztahu \eqref{konvergence_vztah} se nazývá silná chyba aproximace.
\end{definice}
Poznamenejme, že silná konvergence implikuje slabou konvergenci.

Abychom získali co nejpřesnější aproximaci trajektorií řešení stochastické diferenciální rovnice, používáme metody s co největším silným řádem konvergence.
Ačkoli je známo, že Eulerova numerická metoda řešení obyčejných diferenciálních rovnic má silný řád konvergence 1, 
tak stochastická Eulerova numerická metoda má řád konvergence $\frac12$.
Tuto skutečnost dokázali roku 1972 Gikhman a Skorokhod v \cite{gikhman1972stochastic}.
Naproti tomu Milsteinova numerická metoda má silný řád konvergence jedna.
Platí tedy, že v obecném případě, kdy se v koeficientu volatility $\beta(t,x)$ vyskytuje proměnná $x$, Milsteinova metoda konverguje k přesnému řešení SDR rychleji než Eulerova metoda (spolu se zmenšováním časového kroku $\Delta$).

%\end{comment}
%%%%%%%%%%%%%%%%%%{Stochastické modelování}

\chapter{Stochastické modelování}\label{stoch_model}

Stochastický model slouží k popisu dějů, ve kterých je přítomná náhodná složka.
%náhodných jevů, které vyjadřujeme pomocí stochastických procesů.
Pomocí stochastického modelu lze simulovat průběh děje a pozorovat jeho chování při nastavení různých parametrů modelu.
Aplikace stochastického modelování a simulace chování dějů umožňují nejen jejich popis, ale také jejich analýzu.
Na základě analýzy chování modelu a simulací můžeme získat informace pro řízení procesů a k rozhodování.
%Metody stochastického modelování mají význam pro podporu rozhodovacího procesu v situacích za neurčitosti a pro řízení procesů a dějů náhodnou složkou.

V této práci se zaměříme na ekonomické modely popisující, jak se na finančním trhu díky nabídce a poptávce formují ceny finančních aktiv.
%ekonomické modely nabídky a poptávky
Finanční aktiva poskytují investorovi potenciální nárok na budoucí příjem.
Mezi finanční aktiva zahrnujeme také finanční deriváty.

Modelovat budeme vývoj ceny jak podkladových aktiv, tak finančních derivátů.
Finanční derivát je finanční produkt, jehož hodnota je odvozena od ceny jiného finančního aktiva, tzv. podkladového aktiva.
%Derivát má termínový charakter, to znamená, že doba od sjednání obchodu do jeho vypořádání v budoucnosti má ekonomický význam.
%Podkladové aktivum je nástroj, jehož v čase se měnící cena slouží jako základ pro pohyb ceny finančních derivátů.
Podkladovými aktivy mohou být akcie, úrokové míry, komodity, měny, akciové indexy a~mnoho dalších finančních instrumentů.
Podstatou derivátu je termínový obchod, tedy takový, kde doba od sjednání obchodu do jeho vypořádání v budoucnosti  je delší než vyžaduje technické vypořádání obchodu.%má ekonomický význam, je tedy delší než vyžaduje technické vypořádání obchodu.
%Obecně jakékoliv aktivum, jehož cena se vyvíjí v čase.
%Finanční derivát je finanční produkt, jehož podstatou je forma termínového obchodu a jehož hodnota je odvozena od ceny jiného finančního aktiva, tzv. podkladového aktiva.

Chování cen aktiv vykazuje stochastický charakter a cenové změny jsou náhodné a nepředvídatelné.
%, k jehož modelování využíváme stochastické diferenciální rovnice.
%K modelování stochastického charakteru chování cen podkladových aktiv využíváme stochastické diferenciální rovnice.
Kolísání cen aktiv v čase je způsobené především vzájemným působením nabídky a poptávky na trhu.
%Teorie efektivního trhu tvrdí, že ceny aktiv velmi rychle plně odrážejí veškeré tržní informace.
Mezi základní teoretická východiska v teorii finančních trhů patří hypotéza efektivního trhu,
která tvrdí, že ceny aktiv velmi rychle plně odrážejí veškeré tržní informace
a zcela reflektují všechna očekávání investorů ohledně budoucího vývoje cen aktiv.

%Pro přehled uvadíme základní teorie finančních trhů:
%\begin{itemize}
%\item[-]Ceny aktiv jsou výsledkem mnoha náhodných událostí a nelze je předpovídat.
%cenové zmeny jsou náhodné a nepredvídatelné
%\\\item[-]Teorie efektivního trhu tvrdí, že ceny aktiv velmi rychle plně odrážejí veškeré tržní informace.
%V každém případě dlouhodobě je vývoj akciových kurzů odrazem trendů ve
%\\\item[-]Kolísání cen aktiv v čase je způsobené vzájemným působením nabídky a poptávky na trhu.
%Úroková míra je určována trhem -- bankami, které přijímají vklady a poskytují úvěry, a subjekty působícími na kapitálovém trhu.
%Cenová změna aktiv je výsledkem mnoha náhodných událostí a nelze ji předpovídat.
%cenotvorba
%\end{itemize}

Teorie finančních trhů je podrobně zpracována v české literatuře.
Z velkého množství textů odkažme na \cite{rejnus2011}, \cite{fuchsfinancni} a \cite{veselainvestovani}, které jsme při psaní práce využívali.
Stochastickým modelováním v ekonomii se pak zabývá převážně zahraniční literatura, ze které jsme nejvíce pracovali s \cite{hull}, \cite{wilmott1995mathematics} a \cite{karatzas1998methods}.

\section{Stochastické modelování cen finančních aktiv}\label{stoch_model_aktiv}
%na základě střetu nabídky a poptávky možné určit rovnovážnou cenu 

%Tržní hodnota akcie, kterou určuje burza je tedy především oceněním hospodaření podniku.
%Hodnota akcie je tedy dána jejím hospodařením. Zájem o akcii pak tvoří její cenu, protože převis poptávky ji zvyšuje a převis nabídky snižuje. Kdo chce znát cenu akcie, zjistí si ji na burze. Cena akcie je prostě dána její podnikatelskou hodnotou, jak ji vidí akcionáři a obchodníci na burzách.
%Finanční teorie zpravidla definuje investiční instrumenty (investiční nástroje) jako aktiva, která investorovi (majiteli) přináší nějaký nárok na budoucí příjem (např. dividendy, kuponové platby, úroky či kapitálové výnosy).

%Aplikace SDR ve financích najdeme v \cite{karatzas2012brownian}. Už citováno.

%Citace:  \cite{baxter1996financial} a  \cite{franke2004statistics}

V následující části popíšeme konstrukci matematických modelů používaných ve finanční matematice pro popis vývoje cen aktiv na finančních trzích.
Na začátek poznamenejme, že ceny aktiv jsou pozorovány a~zaznamenávány v~diskrétních časech s~malým časovým krokem.
Avšak je běžné předpokládat, že proces ceny aktiva je proces ve spojitém čase.
Důvodem je zjednodušení následných analýz a~modelování.
%Na začátek poznamenejme, že ceny aktiv jsou stochastické procesy s diskrétním časem a malým časovým krokem. 
%Avšak je běžné předpokládat, že se jedná o procesy spojité.
%Důvodem je zjednodušení následných analýz a modelování.
%Pro jednoduchost analýzy ale budeme předpokládat, že se jedná o procesy spojité.

V Kapitole \ref{WP_kap} jsme uvažovali nad požadavky kladenými na chování stochastického procesu, který můžeme využít k modelování cen aktiv, aby byl model smysluplný.
Zrekapitulujme kvalitativní znaky modelu aktiv:
\begin{itemize}
\item[-] v dlouhodobém časovém horizontu mají ceny aktiv přibližně exponenciální růst,
\item[-] fluktuace cen aktiv je náhodná,
\item[-] ceny aktiv jsou nezáporné,
\item[-] model je univerzální pro různé úrovně cen aktiv.
\end{itemize}
%Modeling with Itô Stochastic Differential Equations Od autorů: Edward Allen (googlebooks) - multidimenzní Ito formule 
%Dynamic Asset Pricing Theory Od autorů: Darrell Duffie (googlebooks) - Black-Scholes
Jak už bylo naznačeno v Kapitole \ref{WP_kap}, základní model splňující uvedené požadavky je založen na geometrickém Wienerově procesu. 
%Model byl zaveden a prosazen Paulem Samuelsonem \cite{samuelson1965proof}.
Budeme předpokládat, že proces popisující vývoj ceny aktiva v čase se řídí následující stochastickou diferenciální rovnicí %následujícím modelem
\begin{equation}\label{risk_asset_model}
\mathrm{d}P(t)=P(t)\,\mu(t)\,\mathrm{d}t+P(t)\,\sigma(t)\,\mathrm{d}W(t),
\end{equation}
kde $P(t)$ je cena aktiva v čase $t$, $\mu(t)$ a $\sigma(t)$ jsou stochastické procesy a~$W(t)$  je jednorozměrný Wienerův proces.
Tento model předpokládá, že na trhu je pouze jedno rizikové aktivum. %, což není zcela realistické.
Jedná se o zjednodušující předpoklad, který bývá běžně používán v modelech finančních aktiv. 
Stejný předpoklad nalezneme i v Black-Scholesově modelu, který představíme v Kapitole \ref{derivaty_kap}.

Chceme-li popisovat vývoj ceny více rizikových aktiv na trhu a jejich vzájemné vztahy využijeme následující model, který předpokládá existenci $n$~rizikových aktiv a je popsán rovnicí
\begin{equation}\label{multi_risk_asset_model}
\mathrm{d}P_j(t)=P_j(t)\,\mu_j(t)\,\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}(t)\,\mathrm{d}W_k(t),
\end{equation}
kde $P_j(t)$ je cena aktiva $j$ v čase $t$, $\mu_j(t)$ a $\xi_{jk}(t)$ jsou stochastické procesy a $\boldsymbol{W}(t)=(W_1(t),\dots,W_n(t))^\mathrm{T}$ je $n$-rozměrný Wienerův proces. 
Pro více informací o mnohorozměrných modelech viz \cite{etheridge2002course}.

Některé modely zabývající se chováním cen aktiv na trhu předpokládají existenci \textit{bezrizikového aktiva}.
Jedná se o aktivum, které má jistou (nenáhodnou) výnosnost a tudíž nulové riziko.
Výnosností a rizikem aktiva se budeme podrobněji zabývat v Kapitole \ref{charakteristiky_portfolia}. 
S modely zahrnujícími bezrizikové aktivum nás seznámí Kapitola \ref{KTP}.
Výnosnost bezrizikového aktiva se nazývá \textit{bezriziková úroková míra}.
Modelování úrokových měr se věnuje Kapitola \ref{model_urok_miry_kap}.
V praxi neexistuje skutečně bezriziková investice, ale z krátkodobého a střednědobého hlediska lze návratnost některých investic považovat prakticky za jistou.
Obvykle se za takovou teoretickou investici považují státní pokladniční poukázky.
Jedná se o krátkodobé dluhopisy, které vydává centrální banka a slouží ke krytí státního deficitu.

Chování ceny bezrizikového aktiva je popsáno rovnicí
\begin{equation}\label{risk-free_asset_model}
\mathrm{d}B(t)=B(t)\,r_f(t)\,\mathrm{d}t,
\end{equation}
kde $B(t)$ je cena bezrizikového aktiva v čase $t$ a $r_f(t)$ je bezriziková úroková míra.
%Řešení diferenciální rovnice \eqref{risk-free_asset_model} dává cenu bezrizikového aktiva jako
%\begin{equation}\label{risk-free_asset_reseni}
%B(t)=\mathrm{e}^{\int_0^t r_f(s)\,\mathrm{d}s}.
%\end{equation}

Příklady trajektorií procesů popsaných modely \eqref{risk_asset_model} a~\eqref{risk-free_asset_model} zobrazuje Obrázek~\ref{asset_model_graf}.

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/GWP_RFA_v5.pdf}
  \caption{Hodnota ceny bezrizikového aktiva s úrokovou mírou $r_f=1$ a~trajektorie ceny rizikového aktiva s parametry $\mu=1$ a  $\sigma=0,1$ a počáteční hodnotou $P(0)=1$.}  \label{asset_model_graf}
\end{figure}

%\subsection{Black–Scholesův model}
\subsection{Modely cen finančních derivátů}\label{derivaty_kap}
Přehledný úvod do problematiky oceňování finančních derivátů poskytuje kniha \textit{Financial Calculus} od autorů Martina Baxtera a Andrewa Rennieho~\cite{baxter1996financial}.
Odvození Black–Scholesova modelu je srozumitelně zpracováno také v učebnici Alison Etheridge \cite{etheridge2002course}.

Při konstrukci modelů cen finančních derivátů v této kapitole budeme uvažovat finanční trh s jedním rizikovým aktivem a s jedním bezrizikovým aktivem (obvykle se v tomto případě předpokládá, že se jedná o hotovost).
Definujme portfolio složené z těchto aktiv.
\begin{definice}
\textit{Portfolio} $\big(\phi(t),\psi(t)\big)$ je dvojice stochastických procesů $\phi(t)$ a $\psi(t)$, která udává podíly rizikového a bezrizikového aktiva držené v čase $t$.
%Stochastický proces $\phi(t)$ je neanticipativní (podíl rizikového aktiva v portfoliu v čase $t$ může být ovlivněn pouze informacemi známými do času $t$).
Stochastické procesy  $\phi(t)$ a $\psi(t)$ jsou neanticipativní (podíly aktiv v portfoliu v čase $t$ mohou být ovlivněny pouze informacemi známými do času $t$).

Předpokládejme, že cena rizikového aktiva se řídí stochastickým procesem $P(t)$ a cenu bezrizikového aktiva v čase $t$ označme $B(t)$.
Pak \textit{hodnota portfolia} v čase $t$ je dána jako
\begin{equation}\label{hodnota_portfolia}
V(t)=\phi(t)P(t)+\psi(t)B(t).
\end{equation}
\end{definice}

Proces $\phi(t)$  nabývá kladných hodnot, nicméně pokud je na trhu povolen tzv. \textit{prodej na krátko (short sell)} může nabývat i hodnot záporných.
Prodává-li na krátko investor rizikové finanční aktivum, jedná se o~spekulativní metodu obchodování na finančním trhu, kdy investor očekává pokles ceny tohoto aktiva.
Investor si finanční aktivum vypůjčí od věřitele na předem stanovenou dobu a ihned ho prodá třetí straně.
Nejpozději za stanovenou dobu investor nakoupí finanční aktivum na trhu a vrátí jej věřiteli.
Rozdíl mezi prodejní a nákupní cennou je výsledný zisk nebo ztráta.
Kvůli vysoké rizikovosti je prodej na krátko často regulován a v některých zemích dokonce zcela zakázán.
Při prodeji na krátko může investor dosáhnout pouze omezeného zisku, ale teoreticky neomezené ztráty.

%Samofinancující strategie spočívá ve vytvoření takového portfolia, které má stejné základní charakteristiky jako finanční derivát. 
%Toto portfolio nazýváme \textit{replikační portfolio}.
%Stává se z jednoho rizikového a jednoho bezrizikového aktiva.

%Další pojem, se kterým se při konstrukci modelu setkáme, je \textit{finanční strategie}.
%%Dynamická finanční strategie je popsána pomocí dvojice stochastických procesů $(\phi,\psi)$, která udává množství jednotlivých aktiv držených v portfoliu v každém okamžiku. 
%Definice finanční strategie je stejná jako definice portfolia, jedná se tedy o dvojici stochastických procesů $(\phi,\psi)$, která udává množství jednotlivých aktiv držených v portfoliu v každém okamžiku. 
%Speciální typ finanční strategie, který využijeme při tvorbě modelu, je samofinancující strategie. 
%Portfolio je samofinancující, pokud 

V literatuře, popisující konstrukci modelu cen finančních derivátů, se často setkáme s pojmem \textit{finanční strategie}.
%Pojmy \textit{strategie} a \textit{portfolio} mají stejnou definici, proto je můžeme chápat jako synonyma a v dalším textu této kapitoly mohou být volně zaměňována.
Pojmy \textit{strategie} a \textit{portfolio} bývají v těchto textech používány pro označení toho samého a prolínají se.
Proto tyto pojmy budeme v dalším textu této kapitoly chápat jako synonyma a~mohou být volně zaměňovány.

Speciálním typem finanční strategie, který využijeme při tvorbě modelu, je samofinancující strategie.
Jedná se o takovou strategii, kdy investor v průběhu času nedodává do portfolia další prostředky (ani prostředky nestahuje).
Proto změna hodnoty portfolia závisí pouze na změnách cen aktiv držených v portfoliu. 
Samofinancující strategie je definována pomocí stochastické diferenciální rovnice.
\begin{definice}[Samofinancující strategie]\label{samofinancujici_strategie}
Řekneme, že strategie $\big(\phi(t),\psi(t)\big)$ je \textit{samofinancující strategie} právě tehdy, když platí
\begin{equation}\label{samofinancujici_strategie_vztah}
\mathrm{d}V(t)=\phi(t)\,\mathrm{d}P(t)+\psi(t)\,\mathrm{d}B(t),
\end{equation}
kde $B(t)$ je cena bezrizikového aktiva v čase $t$, $P(t)$ je cena rizikového aktiva v čase $t$ a $V(t)$ je hodnota portfolia v čase $t$.
\end{definice}

\begin{priklad}\label{samofinancujici_portfolio_priklad}
Nechť se cena rizikového aktiva řídí Wienerovým procesem (tedy $P(t)=W(t)$ pro všechna $t$) a cena bezrizikového aktiva je konstantní (předpokládejme, že $B(t)=1$ pro všechna $t$).

Uvažujme portfolio $\big(\phi(t),\psi(t)\big)$, ve kterém po celou dobu držíme jedno rizikové aktivum a jedno bezrizikové aktivum, tedy $\phi(t)=\psi(t)=1$ pro všechna $t$. 
Dokažme, že toto portfolio je samofinancující.

Hodnota portfolia je $V(t)=W(t)+1$.
Přírůstky jednotlivých aktiv jsou
\begin{align*}
\mathrm{d}B(t)&= 0, \\
\mathrm{d}P(t)&=\mathrm{d}W(t). 
\end{align*}
Ověřme podmínku \eqref{samofinancujici_strategie_vztah} z Definice \ref{samofinancujici_strategie}.
\begin{align*}
\mathrm{d}V(t)&=\mathrm{d}\big(W(t)+1\big)=\mathrm{d}W(t),\\
\phi(t)\,\mathrm{d}P(t)+\psi(t)\,\mathrm{d}B(t)&=1\cdot\mathrm{d}W(t)+1\cdot0=\mathrm{d}W(t).
\end{align*}
Podmínka \eqref{samofinancujici_strategie_vztah} tedy platí a portfolio $\big(\phi(t),\psi(t)\big)$ je samofinancující.
\end{priklad}

\begin{priklad}
Předpokládejme, že ceny rizikového a bezrizikového aktiva se řídí stejnými procesy jako v Příkladu \ref{samofinancujici_portfolio_priklad}.
Uvažujme portfolio $\big(\phi(t),\psi(t)\big)$, kde $\phi(t)=2W(t)$ a $\psi(t)=-t-W^2(t)$. 

Ověřme zda se jedná o samofinancující portfolio dle Definice \ref{samofinancujici_strategie}.
Hodnota portfolia je 
\begin{align*}
V(t)=\phi(t)P(t)+\psi(t)B(t)=2W(t)\cdot W(t)-t-W^2(t)=W^2(t)-t. 
\end{align*}
Dosadíme-li do It\^oova lemmatu \ref{ito_lemma} dostaneme
\begin{alignat*}{2}
\mathrm{d}V(t)&=\left[-1+2W(t)\cdot0+\frac12\cdot2\cdot1^2\right]\mathrm{d}t+2W(t)\cdot1\cdot\mathrm{d}W\\
&=2W(t)\,\mathrm{d}W(t).\\
%\end{alignat*}
\text{Zároveň platí}\hspace{2.1cm}\\
%\begin{alignat*}{2}
\phi(t)\,\mathrm{d}P(t)+\psi(t)\,\mathrm{d}B(t)&=2W(t)\,\mathrm{d}W(t)+(-t-W^2(t))\cdot0\\
&=2W(t)\,\mathrm{d}W(t).
\end{alignat*}
Podmínka \eqref{samofinancujici_strategie_vztah} tedy platí a portfolio $\big(\phi(t),\psi(t)\big)$ je samofinancující.
\end{priklad}

Dále budeme definovat replikující strategii pro danou pohledávku (např. finanční derivát), jejíž hodnotu označíme $X(t)$.
Při konstrukci oceňovacího modelu předpokládáme, že na trhu neexistuje arbitráž.
%Tržní arbitráž je způsob obchodování, který využívá odlišných cen identického zboží na různých trzích.
%Současným nákupem téhož zboží na jednom trhu a prodejem na jiném trhu za rozdílné ceny můžeme dosáhnout bezrizikového zisku.
Tržní arbitráž je způsob obchodování, při kterém investor s nulovou investicí dosahuje bezrizikového zisku. 
Pokud na trhu není arbitrážní příležitost, pak hodnota pohledávky $X(t)$ musí být stejná jako hodnota replikujícího portfolia.
\begin{definice}[Replikující portfolio]
Předpokládejme, že na trhu je k dispozici bezrizikové aktivum s cenou $B(t)$ a rizikové aktivum, jehož cena se řídí procesem $P(t)$ s volatilitou $\sigma(t)$.
%Uvažujme existenci finančního derivátu, jehož cenu popisuje stochastický proces $X(t)$, který závisí na údálostech do času $T$.
Uvažujme existenci finančního derivátu, jehož hodnotu v čase vypořádání $T$ označíme $X(T)$.
\textit{Replikující portfolio} $\big(\phi(t),\psi(t)\big)$ pro tento finanční derivát je taková samofinancující strategie, že platí
\begin{equation}\label{replikacni_portfolio}
V(T)=\phi(T)P(T)+\psi(T)B(T)=X(T)
\end{equation}
a $\int_0^T\sigma^2(t)\phi^2(t)\,\mathrm{d}t<\infty$.
Poznamenejme, že se v literatuře můžeme setkat také s pojmem \textit{replikační portfolio}.
\end{definice}
Předpokládáme-li, že na trhu neexistuje arbitráž a zároveň k finančnímu derivátu najdeme replikující portfolio $\big(\phi(t),\psi(t)\big)$, pak pro proces ceny derivátu $X(t)$ musí platit
\begin{equation}\label{replikacni_portfolio_vztah}
X(t)=\phi(t)P(t)+\psi(t)B(t).
\end{equation}
Pokud by vztah \eqref{replikacni_portfolio_vztah} neplatil, bylo by možné najít arbitrážní příležitost.
Například, pokud by cena derivátu v čase $t<T$ byla nižší než hodnota replikujícího portfolia v čase $t$, pak by obchodník mohl koupit v čase $t$ jeden derivát a prodat na krátko $\phi(t)$ jednotek rizikového aktiva a $\psi(t)$ jednotek bezrizikového aktiva. 
Jelikož je replikující portfolio $\big(\phi(t),\psi(t)\big)$ samofinancující, je zaručeno, že v čase $T$ bude mít hodnotu $X(T)$, aniž by bylo nutné dodávat další prostředky mezi časem $t$ a $T$.
V čase $T$ tedy hodnota derivátu pokryje náklady na nákup portfolia prodaného na krátko.
Obchodník inkasuje zisk ve výši rozdílu $X(t)-V(t)$ a to bez rizika.
Opačný příklad by byl analogický.
 
%To znamená, že díky vztahu \ref{replikacni_portfolio_vztah} jsme schopni pomocí replikačního portfolia modelovat cenu finančního derivátu.

Pomocí konceptu představeného v této kapitole je možno modelovat cenu finančního derivátu.
K derivátu nalezneme jeho replikující portfolio, využijeme vztah \eqref{replikacni_portfolio_vztah}, cenu aktiv v portfoliu modelujeme dle modelů představených v Kapitole \ref{stoch_model} a k ocenění derivátu používáme It\^oovo lemma. 

%Tento přístup poprvé představili
Oceňováním finančních derivátů se poprvé zabývali v roce 1973 Fischer Black a Myron Scholes \cite{black1973pricing} v kontextu oceňování opcí. 
Jejich oceňovací metoda vešla později ve známost jako Black-Scholesův model.
Na dalším rozvoji se podílel také Robert Merton, který představil přístup využívající samofinancující portfolio.
Jejich práce byla v roce 1997 oceněna Nobelovou cenou za ekonomii.
 
%Předpokládejme existenci konstantní bezrizikové úrokové míry $r$, volatility akcie $\sigma$ a driftu akcie $\mu$. 
%Dále předpokládáme nulové transakční náklady a možnost obchodovat v libovolném čase libovolné množství v dlouhé i v krátké pozici za stanovenou cenu.

\section{Stochastické modelování úrokových měr}\label{model_urok_miry_kap}
%Tato kapitola čerpá z obsáhlé monografie Interest Rate Models autorů Damiana Briga a Fabia Mercuria \cite{brigo2007interest} a z učebnice finanční matematiky slovenských autorů působících na Univerzitě Komenského v Bratislavě \cite{melichercik}.
Tato kapitola čerpá z obsáhlé monografie Interest Rate Models autorů Briga a Mercuria \cite{brigo2007interest} a z učebnice finanční matematiky slovenských autorů Melicherčíka, Olšarové a Úradníčka působících na Univerzitě Komenského v~Bratislavě \cite{melichercik}.
Než začneme představovat konkrétní modely úrokových měr, definujeme okamžitou úrokovou míru a~seznámíme se s~pojmy diskontování a~časová struktura úrokové míry, na jejímž vývoji závisí hodnoty finančních derivátů úrokových měr.

Časovou strukturu úrokové míry budeme popisovat pomocí cen bezkupónových dluhopisů.
Dluhopis je cenný papír, který vyjadřuje závazek emitenta vůči věřiteli, a~je s ním spojeno právo požadovat splacení dlužné částky (tzv. nominální hodnoty) v~předem určenou dobu.
%V této práci budeme předpokládat, že dluhopisy jsou bezriziková aktiva a tudíž pro popis jejich cen budeme používat stejný model jako pro bezrizikové aktivum v Kapitole \ref{stoch_model_aktiv}.
%Uvažujme dluhopis emitovaný v čase $t_0$ a splatný v čase $T$.
%Řešení diferenciální rovnice \eqref{risk-free_asset_model} dává cenu dluhopisu jako
%\begin{equation}\label{risk-free_asset_reseni}
%B(T)=B(t_0)\,\mathrm{e}^{\int_{t_0}^T r(t)\,\mathrm{d}t},
%\end{equation}
%kde $t_0\leq t\leq T$,
%$r(t)$ je \textit{okamžitá úroková míra} v čase $t$ a $B(T)$ je cena dluhopisu v~době splatnosti~$T$.
%Dluhopis můžeme tedy chápat jako finanční derivát úrokové míry.
%Cena dluhopisu popisuje časovou strukturu peněz.

\begin{definice}[Úroková míra]
Uvažujme dluhopis emitovaný v čase $t_0$ a~splat\-ný v čase $T$.
Jeho cenu v čase $t$, kde $t_0\leq t\leq T$, označíme $B(t,T)$.
Předpokládejme, že dluhopis má nominální hodnotou jedna, tzn. $B(T,T)=1$.
Míru výnosnosti tohoto dluhopisu do času $T$ označíme $R(t,T)$.
Platí tedy
\begin{equation}
B(t,T)=\mathrm{e}^{-R(t,T)\cdot(T-t)}.
\end{equation} 
Funkce $R(t,T)$ se nazývá \textit{$(T-t)$-roční úroková míra} (dále jen \textit{úroková míra}).
\end{definice}
Je tedy zřejmé, že z cen bezkupónových dluhopisů $B(t,T)$ je možné odvodit hodnoty úrokových měr $R(t,T)$ a naopak.
Platí
\begin{equation}\label{urokova_mira_z_dluhopisu_vztah}
R(t,T)=-\frac{1}{T-t}\log B(t,T),
\end{equation} 
pro $t_0\leq t\leq T$.

Vzhledem k uvedené terminologii můžeme na dluhopis nahlížet jako na finanční derivát, jehož podkladovým aktivem je úroková míra.
%Jak ukážeme později, dluhopis také můžeme chápat jako finanční derivát úrokové míry.

Časová struktura úrokové míry vyjadřuje vztah mezi úrokovou mírou a~termínem splatnosti příslušného dluhopisu.
Její grafickou reprezentací je \textit{výnosová křivka}, která ukazuje závislost výnosu do doby splatnosti (svislá osa) na době do splatnosti dluhopisu (vodorovná osa). 
\begin{definice}[Výnosová křivka]
Funkce $R(t,\cdot)$ je nazývána \textit{výnosová křivka}.
\end{definice}
Výnosová křivka je konstruována pro dané dluhopisy, které se liší pouze dobou do splatnosti, ale ostatní vlastnosti (jako třeba emitenta) mají stejné.

%Časovou strukturu úrokové míry můžeme popsat pomocí ceny bezrizikového aktiva, kterou jsme modelovali v kapitole \ref{stoch_model}.  
%Dluhopis je finanční derivát úrokové míry.
%Finanční derivát úrokové míry se nazývá \textit{dluhopis}.

%Pracujeme s tzv. okamžitou úrokovou mírou 
%Příliš krátké sazby však vykazují určité anomálie (poměrně dlouhá období relativně stabilních sazeb střídají silné skokové pohyby jako důsledek externích šoků v podobě zásahů centrální banky)


Úroková míra se používá při spojitém diskontování, které budeme využívat v další části práce při výpočtu kapitálového požadavku ke kreditnímu riziku protistrany. 
Diskontování je proces, při kterém je přepočítána (diskontována) budoucí cena aktiva na současnou hodnotu s použitím diskontní míry nazývané také diskontní faktor.
Jak už jsme zmínili v Kapitole \ref{stoch_model_aktiv}, kvůli zjednodušení výpočtů je běžné aproximovat vývoj cen aktiv spojitým procesem a v takovém případě má smysl i spojité diskontování, i~když reálné chování finančních instrumentů je diskrétní.
\begin{definice}
Spojitý \textit{diskontní faktor} je dán jako
\begin{equation}\label{diskontni_faktor}
%D(T)=\frac{B(t_0)}{B(T)}=\mathrm{e}^{-\int_{t_0}^T r(t)\,\mathrm{d}t},
D(T)=\frac{B(t_0,T)}{B(T,T)}=\mathrm{e}^{-R(t_0,T)\cdot(T-t_0)},
\end{equation}
kde $R(t,T)$ je úroková míra.
\end{definice}
Diskontní faktor můžeme také chápat jako cenu dluhopisu s nominální hodnotou jedna.

Uvažujme nyní úrokovou míru na velmi krátký (infinitezimální) časový okamžik.
Jedná se o takovou úrokovou míru, kde doba splatnosti se limitně blíží k času emitování dluhopisu.
\begin{definice}[Okamžitá úroková míra]
\textit{Okamžitou úrokovou míru} $r(t)$ definujeme jako
\begin{align}\label{okamzik_urok_mira_vztah}
r(t)=\lim_{T\to t}R(t,T)&=\lim_{T\to t}-\frac{\log B(t,T)-\log B(t,t)}{T-t}\notag\\
&=\left.-\frac{\partial\log B(t,T)}{\partial T}\right|_{T=t}.%-\frac{\partial\log B(t,t)}{\partial T}.
\end{align} 
\end{definice}
Poslední rovnost ve vztahu \eqref{okamzik_urok_mira_vztah} plyne z definice parciální derivace funkce dvou proměnných.
Okamžitá úroková míra představuje bod výnosové křivky, který je umístěn nejvíce vlevo.
Při oceňování finančních derivátů úrokových měr v Kapitole~\ref{metodyCVA} budeme využívat modely okamžité úrokové míry.
%K určení okamžité úrokové míry je vhodné používat okamžitou forwardovou úrokovou míru

V další části se budeme zabývat forwardovými úrokovými mírami.
Ukážeme, že výnosovou křivku můžeme přepočítat na křivku forwardových úrokových měr a naopak. 
Z matematického hlediska je snadnější modelovat křivku forwardových úrokových měr, což využijeme při konstrukci Hull-Whitova modelu v Kapitole \ref{H-W_model_kap}.
%Zároveň z okamžité forwardové úrokové míry můžeme odvodit okamžitou úrokovou míru $r(t)$.

Principem forwardového kontraktu je uzavření dohody mezi dvěma stranami o nákupu (nebo prodeji) finančního aktiva za cenu stanovenou v současnosti, přičemž obchod se uskuteční v určený čas v budoucnosti. 
Forwardová úroková míra je míra mezi dvěma časovými okamžiky v budoucnosti za podmínek dohodnutých v současnosti (v čase $t_0$).
Při odvození její hodnoty využíváme předpoklad o neexistenci arbitráže na finančním trhu. 
\begin{definice}[Forwardová úroková míra]\label{forward_def}
\textit{Forwardovou úrokovou míru} \linebreak 
$F(t,t_1,T)$ v čase $t$ na dobu od $t_1$ do $T$, kde platí $t_0\leq t\leq t_1<T$ definujeme jako řešení rovnice
\begin{equation}\label{forward_rov}
\mathrm{e}^{R(t,T)\cdot(T-t)}=\mathrm{e}^{R(t,t_1)\cdot(t_1-t)}\cdot\mathrm{e}^{F(t,t_1,T)\cdot(T-t_1)}.
\end{equation} 
\end{definice}
%Vyřešme rovnici z Definice \ref{forward_def} 
Řešení rovnice \eqref{forward_rov} nám dá vztah pro forwardovou úrokovou míru jako
\begin{alignat*}{2}
\frac{1}{ B(t,T)}&=&\frac{1}{B(t,t_1)}\cdot\mathrm{e}^{F(t,t_1,T)\cdot(T-t_1)}\\
&\Downarrow&\\
F(t,t_1,T)&=&\frac{\log B(t,t_1)-\log B(t,T)}{T-t_1}.
\end{alignat*}

Obdobně jako při odvození okamžité úrokové míry nyní definujme okamžitou forwardovou úrokovou míru. 
\begin{definice}[Okamžitá forwardová úroková míra]
\textit{Okamžitou forwardovou úrokovou míru} $f(t,t_1)$ pro $0\leq t\leq t_1$ definujeme jako
\begin{equation}\label{okamzik_forward_rov}
f(t,t_1)=\lim_{T\to t_1}F(t,t_1,T)=\left.-\frac{\partial\log B(t,T)}{\partial T}\right|_{T=t_1}.%-\frac{\partial\log B(t,t_1)}{\partial T}.
\end{equation} 
\end{definice}
Dokažme, že znalost ceny dluhopisu $B(t,T)$ je ekvivalentní znalosti okamžité úrokové míry $f(t,T)$.
Platí
\begin{align*}
%\begin{equation*}
\log B(t,T)=\log B(t,T)-\log B(t,t)
&=\int_{t}^T \frac{\partial\log B(t,s)}{\partial s}\,\mathrm{d}s=-\int_{t}^Tf(t,s)\,\mathrm{d}s\\
&\Downarrow\\
B(t,T)&=\mathrm{e}^{-\int_{t}^T f(t,s)\,\mathrm{d}s}.
%\end{equation*} 
\end{align*}
Navíc platí $r(t)=f(t,t)$, což využijeme při modelování okamžité úrokové míry pomocí Hull-Whitova modelu v Kapitole \ref{H-W_model_kap}.
Znamená to také, že výnosová křivka $R(t,\cdot)$ a křivka forwardových úrokových měr $f(t,\cdot)$ mají stejný počáteční bod $r(t)$.
Nicméně dál se křivky mohou lišit a snadno se dá odvodit, že mezi nimi existuje vztah
\begin{equation}
f(t,T)=R(t,T)+(T-t)\frac{\partial R(t,T)}{\partial T}.
\end{equation} 

\subsection{Modely okamžité úrokové míry}
Při zpracovávání problematiky modelů okamžité úrokové míry jsme čerpali z~publikace o metodách oceňování finančních derivátů autorů Daniela Ševčoviče, Beáty Stehlíkové a Karola Mikuly \cite{sevcovic2009}. 

%Dosud jsme předpokládali, že úroková míra je buď konstantní nebo je známou deterministickou funkcí času.
V Black-Scholesově modelu se používá předpoklad konstantní úrokové míry.
Nicméně v realitě na finančním trhu nemáme jistotu jak se bude úroková míra vyvíjet.
Je tedy přirozené uvažovat o úrokové míře jako o stochastickém procesu a konstruovat její stochastické modely.
Přiblížíme se tak více k realitě.
V dalších částech Kapitoly \ref{model_urok_miry_kap} budeme tedy předpokládat stochastické chování úrokové míry.
%Dluhopis pak můžeme chápat jako finanční derivát úrokové míry.

%Nyní už můžeme přistoupit k modelování úrokových měr.
Zaměříme se na modely okamžité úrokové míry, jelikož je budeme využívat v další části práce při ocenění derivátů úrokových měr.
Tyto modely jsou v literatuře často nazývané \textit{modely krátkodobých úrokových měr}.
U okamžité úrokové míry budeme předpokládat stochastické chování stejně jako u~jiných finančních aktiv,
ale na rozdíl od akcií nebo komodit vykazuje chování úrokových měr následující příznačné vlastnosti. %zvláštnosti.
Úrokové sazby se pohybují v určitém rozmezí a %obvykle nerostou do nekonečna ani neklesají pod nulu.
mají tendenci se vracet k určité rovnovážné hodnotě.
Tento jev se nazývá \textit{mean reversion}, jak už bylo zmíněno v Kapitole \ref{OU_kap}. %-- reverze k průměrné hodnotě.
Stochastické modely, které popisují chování úrokových měr musí tedy brát v~úvahu výše uvedené vlastnosti.

%Modelování úrokových sazeb je velice důležité zejména pro aplikace ve finanční matematice a aktuárských vědách. 
%V posledních desetiletích bylo vyvinuto několik modelů, které se snaží co nejvěrohodněji popsat chování výnosové křivky, přičemž tyto modely ve většině případů používají aparát z teorie pravděpodobnosti a náhodných procesů.
%Jednofaktorové modely pracují pouze s jedním zdrojem nejistoty a jejich základní tvar modeluje výše definovanou okamžitou úrokovou sazbu.

%Vašíček 1977 model úrokové sazby
%Modely krátkodobých úrokových měr modelují okamžitou úrokovou míru a dále se dělí na jednofaktorové a mnohofaktorové (obvykle dvoufaktorové).
Modely krátkodobých úrokových měr se dělí na jednofaktorové a vícefaktorové.
%Jednofaktorové modely popisují vývoj krátkodobých úrokových měr na základě pouze jednoho zdroje tržního rizika.
Jednofaktorové modely popisují vývoj krátkodobých úrokových měr na základě pouze jednoho zdroje nejistoty, který je modelován pomocí Wienerova procesu.
Vícefaktorové modely poskytují na jednu stranu více volnosti a možností v modelování vývoje úrokové míry, na druhou stranu jejich kalibrace, ale i interpretace, je mnohem složitější. 
Pro potřeby této práce se omezíme jenom na modely jednofaktorové. 

Jednofaktorové modely krátkodobých úrokových měr předpokládají, že okamžitá úroková míra $r(t)$ je charakterizovaná pomocí řešení stochastické diferenciální rovnice, která má tvar
%dvoufaktorove r odvozuji od dvou informaci x, y
\begin{equation}\label{model_urok_miry}
\mathrm{d}r(t)=\mu(t,r)\,\mathrm{d}t+\sigma(t,r)\,\mathrm{d}W(t),
\end{equation}
kde $W(t)$ je Wienerův proces.
Koeficient $\mu(t, r)$ určuje drift ve vývoji úrokové míry, tj. trend, kterým by se úroková míra řídila za předpokladu neexistence náhodných vlivů.
Volatilita $\sigma(t, r)$ určuje vlastnosti náhodných výchylek.
Proces $\sigma(t, r)$ se v literatuře nazývá také difuzní koeficient.

Jeden z prvních modelů úrokové míry použil v roce 1973 Robert C. Merton v článku \cite{merton1973theory} k odvození modelu cen bezkupónových dluhopisů.
Parametry tohoto modelu nejsou závislé na čase, jedná se tedy o Wienerův proces s~driftem (definovaný v Definici \ref{Wieneruv_proces_s_driftem}) 
\begin{equation}\label{model_urok_miry_Merton}
\mathrm{d}r(t)=\mu\,\mathrm{d}t+\sigma\,\mathrm{d}W(t).
\end{equation}
Mertonův model předpokládá, že změny úrokové míry mají normální rozdělení, což plyne z vlastností Wienerova procesu.
Nevýhodou Mertonova modelu je absence mean reversion vlastnosti.

\subsection{Vašíčkův model}\label{Vasickuv_model_kap}
Model, který představíme v této kapitole, uveřejnil původem český matematik Oldřich Vašíček v roce 1977 v článku \cite{vasicek1977equilibrium}, kde ho využil k odvození modelu cen bezkupónových dluhopisů.
Tento model se stal velice oblíbeným a často citovaným.
Mnoho autorů dalších modelů krátkodobých úrokových měr vycházelo z Vašíčkova modelu.
Vašíčkův model předpokládá, že okamžitá úroková míra $r(t)$ je charakterizovaná pomocí řešení stochastické diferenciální rovnice, která má tvar
\begin{equation}\label{Vasickuv_model}
\mathrm{d}r(t) = \kappa\big(\theta - r(t)\big)\,\mathrm{d}t + \sigma\,\mathrm{d}W(t)
\end{equation}
kde $W(t)$ je Wienerův proces a $\kappa$, $\theta$ a $\sigma$ jsou konstanty, jejichž význam je následující:
\begin{itemize}
\item[-] $\theta$ je limitní úroková míra, 
\item[-] $\kappa$ je rychlost reverze k limitní úrokové míře, 
\item[-] $\sigma$ je volatilita úrokové míry.
\end{itemize}

Drift této rovnice je $\mu(t, r) = \kappa\big ( \theta - r(t)\big)$ a volatilita je $\sigma(t, r) = \sigma$. 
Uvedený model má vlastnost mean reversion, což znamená, že drift táhne proces krátkodobých úrokových měr k průměrné hodnotě dané konstantou~$\theta$. 
Daný proces je Ornstein-Uhlenbeckův proces definovaný v Kapitole \ref{OU_kap}.

Mezi výhody Vašíčkova modelu patří existence explicitního vyjádření odhadů parametrů $\theta$, $\kappa$ a  $\sigma$ metodou maximální věrohodnosti.
Na druhou stranu za nevýhodu bývá považováno, že Vašíčkův model připouští i záporné úrokové míry. 
K tomuto jevu dochází v případě, kdy se úroková míra přiblíží nule, přičemž volatilita je stále táž konstanta a stochastický člen může způsobit pokles do záporných hodnot.

\subsection{CIR model}\label{CIR_model_kap}
Možnost záporných úrokových měr odstraňuje model, který na bázi Vašíčkova modelu vyvinuli John C. Cox, Jonathan E. Ingersoll a~Stephen A. Ross a~publikovali v roce 1985 v článku \cite{cox1985theory}.
Autoři modifikovali difuzní koeficient ve Vašíčkově modelu tak, že je úměrný úrokové míře.
Cox-Ingersoll-Rossův model (CIR model) je ve tvaru 
\begin{equation}\label{CIR_model}
\mathrm{d}r(t) = \kappa\big(\theta - r(t)\big)\,\mathrm{d}t + \sigma\sqrt{r(t)}\,\mathrm{d}W(t).
\end{equation}
Povšimněme si, že při malých úrokových mírách je malá také volatilita a převažuje vliv driftu. Kdyby byla úroková míra dokonce nulová, bude volatilita také nulová a změna úrokové míry bude dána pouze driftem, který bude v tomto případě kladný.
%Úroková míra v čase $t + \Delta t$ je rovna $r(t) + \kappa ( \theta - r(t))\Delta t + \sigma \Delta W$.

%Model vyvinuly John C. Cox, Jonathan E. Ingersoll a Stephen A. Ross a publikovali v roce 1985 v článku \cite{cox1985theory}.

\subsection{Hull-Whitův model}\label{H-W_model_kap}
Modely uvedené v Kapitolách \ref{Vasickuv_model_kap} a \ref{CIR_model_kap} nereflektují aktuální časovou strukturu úrokové míry.
Na tuto nevýhodu reagovali John C. Hull a Alan White, kteří v roce 1990 publikovali článek \cite{hull1990pricing} s vlastním modelem. %, kde představují svůj model reflektující aktuálně pozorované hodnoty výnosové křivky. 
%Další model odvozený z Vašíčkova modelu je Hull-Whitův model.
%The first Hull–White model was described by John C. Hull and Alan White in 1990. The model is still popular in the market today.
%Poprvé tento model popsali John C. Hull a Alan White v roce 1990 v článku \cite{hull1990pricing} a později zveřejnili i zobecnění modelu v textu \cite{hull2001general}.
%The Hull-White model is a one-factor model of the short rate $r(t)$, first published in \cite{hull1990pricing} and generalized later \cite{hull2001general}.
%A general overview of the model can be found in \cite{brigo2007interest}.
Podrobnosti o Hull-Whitově modelu lze nalézt v již zmiňované publikaci \cite{brigo2007interest}.
Hull a White později zveřejnili i zobecnění svého modelu v textu \cite{hull2001general}.

%The well known interest rate evolution model, Hull-White one-factor model, will be used for modeling of the interest rate term structure. 
%%The Hull-White model is a one-factor model of the short rate $r(t)$, first published in \cite{hull1990pricing} and generalized later \cite{hull2001general}.
%The model was first published by John Hull and Alan White in \cite{hull1990pricing} and generalized later in \cite{hull2001general}.
%%The need for an exact fit to the currently-observed yield curve, led Hull and White to the introduction of a time-varying parameter in the Vasicek model. 
%The requirement for more accurate fit to the currently-observed yield curve, led Hull and White to the introduction of a time variable parameter in the Vasicek model. 
%%The model assumes that short rates have a normal distribution, and that the short rates are subject to mean reversion.
%The model assumes that short rates have a normal distribution, and also that the short rates exhibit the mean reversion character. 
%%Volatility is likely to be low when short rates are near zero, which is reflected in a larger mean reversion in the model. 
%The Hull-White model extends the Vasicek and Cox-Ingersoll-Ross (CIR) models.

Autoři modelu rozšiřují Vašíčkův model úpravou parametru limitní úrokové míry $\theta$ tak, že se parametr mění v čase a reflektuje pozorované aktuální hodnoty výnosové křivky.
Poznamenejme, že existuje i verze Hull-Whitova modelu odvozená z CIR modelu, ale tou se v této práci nebudeme zabývat.
Hull-Whitův model okamžité úrokové míry je dán stochastickou diferenciální rovnicí
\begin{equation}\label{H-W_model}
 \mathrm{d}r(t)=\big(\theta(t)-\alpha r(t)\big)\,\mathrm{d}t+\sigma\,\mathrm{d}W(t),
\end{equation}
kde $\alpha$ a $\sigma$ jsou konstanty a $\theta(t)$ je deterministická funkce času definovaná jako
%\begin{description}
%\item [$ \mathrm{d}r$] The change in the interest rate after a small change in time, $ \mathrm{d}t$.
%\item [$\alpha$   ] Mean reversion rate.
%\item [$\sigma$   ] Volatility of the interest rate.
%\item [$ \mathrm{d}W$] A Wiener process.
%\item [$\theta(t)$] Drift function defined as
%\end{description}
\begin{equation}
%\theta(t)=F'_{t}(0,t)+\alpha F(0,t)+\frac{\sigma^2}{2 \alpha}\left(1- \mathrm{e}^{-2\alpha t}\right),
\theta(t)=\frac{\partial  f(0,t)}{\partial t}+\alpha f(0,t)+\frac{\sigma^2}{2 \alpha}\big(1-\mathrm{e}^{-2\alpha t}\big),
\end{equation}
kde $f(t,T)$ je okamžitá forwardová úroková míra sjednaná v čase $t$ pro čas~$T$.

%Forwardový kontrakt a jeho princip. Spotová sazba je pozorovatelná na trhu a forward se z ní odvozuje?
%Principem forwardového kontraktu je uzavření dohody mezi dvěma stranami o nákupu (nebo prodeji) finančního aktiva za cenu stanovenou v současnosti, přičemž obchod se uskuteční v určený čas v budoucnosti. 
%Znalost cen bezrizikového bezkuponového dluhopisu P(t;T) je tudíž ekvivalentní znalosti okamžité forwardové úrokové míry f (t;T).
Okamžitou forwardovou úrokovou míru budeme určovat z cen bezkupónových dluhopisů s nominální hodnotou jedna a různými maturitami. 
Tyto ceny můžeme pozorovat na trhu.
Využijeme vztah
%\begin{equation}
%B(t,T)=\mathrm{e}^{-\int_{t}^T f(t,s)\,\mathrm{d}s},
%\end{equation}
%kde $B(t,T)$ je cena bezkupónového dluhopisu v čase $t$ s nominální hodnotou jedna vyplácenou v čase $T$.
\eqref{okamzik_forward_rov}.

%\begin{description}
%\item[$F(0,t)$] okamžitá forwardová úroková míra v čase $t$.%Instantaneous forward rate at time $t$.
%\item[$F'_{t}(0,t)$] Partial derivative of $F$ with respect to time $t$.
%\end{description}
Stejně jako Vašíčkův model má i tento model vlastnost mean reversion, ale limitní úrokovou míru tentokrát reprezentuje funkce $\theta(t)$ určená počáteční křivkou forwardových úrokových měr.%výnosovou křivkou.

Hull a White předpokládali, že úroková míra má normální rozdělení, čímž připustili možnost záporných hodnot.
Jedná se o stejný nedostatek jako jsme zmínili u Vašíčkova modelu.
Na druhou stranu mezi výhody Hull-Whitova modelu patří možnost kalibrace s využitím počáteční výnosové křivky, což zohledňuje ceny dluhopisů pozorované na trhu.
Díky této vlastnosti si model získal širokou oblibu.

%V Kapitole \ref{aplikaceCVA_kap} budeme využívat rozšíření okamžité úrokové míry $r(t)$ na celou výnosovou křivku $R(t,\cdot)$ podle vztahu
Při aplikaci Hull-Whitova modelu v Kapitole \ref{aplikaceCVA_kap} budeme chtít simulovat celou výnosovou křivku $R(t,\cdot)$.
Brigo a Mercurio v \cite{brigo2007interest} a Hull v \cite{hull} vysvětlují, jak je možné popsat dynamiku výnosové křivky, pokud předpokládáme, že okamžitá úroková míra se řídí Hull-Whitovým modelem.
Naznačíme hlavní myšlenku jejich přístupu a uvedeme výsledný vztah pro výnosovou křivku.
Pro podrobnější odvození odkazujeme na literaturu. 

Je-li hodnota okamžité úrokové míry známý stochastický proces, můžeme odvodit cenu bezkupónového dluhopisu s nominální hodnotou jedna vyplácenou v čase $T$ pomocí následujícího vztahu.
%a následujícího vztahu pro cenu bezkupónového dluhopisu s nominální hodnotou jedna vyplácenou v čase $T$.
Platí, že cena tohoto dluhopisu v čase $t$ je dána očekáváním ve světe rizikově neutrálním vůči peněžnímu trhu
\begin{equation}\label{ocekavana_cena_dluhopisu}
B(t,T)=\mathsf{E}_t\left(\mathrm{e}^{-\int_{t}^T r(s)\,\mathrm{d}s}\right),
\end{equation}
kde $\mathsf{E}_t$ značí střední hodnotu podmíněnou informacemi známými do času $t$.
% podle vztahu

Za předpokladu normality okamžité úrokové míry $r(s)$, pro všechna $t\leq s\leq T$, můžeme určit očekávání v rovnici \eqref{ocekavana_cena_dluhopisu}.
Vztah pro výnosovou křivku pak odvodíme z očekávané ceny dluhopisu dosazením do rovnice \eqref{urokova_mira_z_dluhopisu_vztah} a dostáváme
\begin{eqnarray}\label{H-W_vynosova_krivka}
R(t,T)&=&-\frac{1}{T-t}\left(\log \frac{B(0,T)}{B(0,t)}+\frac{1-\mathrm{e}^{-\alpha(T-t)}}{\alpha}f(0,t)\right)+ \nonumber\\
&&+\frac{\sigma^2}{4\alpha^3(T-t)}\left(\mathrm{e}^{-\alpha T}-\mathrm{e}^{-\alpha t}\right)^2\left(\mathrm{e}^{2\alpha t}-1\right)+  \nonumber\\
&&+\frac{1-\mathrm{e}^{-\alpha(T-t)}}{\alpha(T-t)}r(t),
\end{eqnarray}
kde $B(t,T)$ je cena bezkupónového dluhopisu v čase $t$ %, který vyplácí nominální hodnotu jedna v čase $T$,
s nominální hodnotu jedna vyplácenou v čase $T$,
$f(t,T)$ označuje okamžitou forwardovou úrokovou míru sjednanou v čase $t$ pro čas~$T$ 
a~$r(t)$ je okamžitá úroková míra daná Hull-Whitovým modelem.
Ze vztahů \eqref{ocekavana_cena_dluhopisu} a \eqref{H-W_vynosova_krivka} vidíme, že celá výnosová křivka (a tedy časová struktura úrokové míry) je charakterizována pouze dynamikou okamžité úrokové míry.
%Zadaná dynamika pro r(t) už určuje celou časovou strukturu pomoci očekávání ve světe risk neutralním vůči peněžnímu trhu.

%%%%%%%%%%%%%%%%%%{Teorie portfolia}

\chapter{Teorie portfolia}\label{teorie_portfolia_kap}
%%z mého článku
%Teorie portfolia se zabývá zkoumáním kapitálových trhů a popisem chování cen finančních aktiv.
%Na základě těchto poznatků je hledán způsob, jak zvolit optimální množinu finančních aktiv.
%Přitom je využívána nejen teorie pravděpodobnosti, ale v novějších přístupech i stochastická analýza.
%
%%Za zakladatele moderní teorie portfolia je považován Harry Markowitz. 
%Jeho práci z roku 1952 dále rozvíjeli například James Tobin a William Sharpe a staví na ní i některé současné přístupy.
%Zjednodušující předpoklady v teorii portfolia bývají předmětem kritiky.
%V této práci představíme některé metody z teorie portfolia a budeme diskutovat o jejich výhodách a nevýhodách.
%
%Budeme vycházet z klasické Markowitzovy teorie portfolia, která používá statický přístup (tzv. jednokrokový model).
%Představíme rozšíření navržené Jamesem Tobinem, které přináší Separační teorém a navazuje na něj Capital Asset Pricing Model (CAPM).
%
%Vývojem optimálního portfolia ve spojitém čase se zabýval Robert Merton, který přinesl první řešení tohoto problému v roce 1971.
%Ve svém přístupu předpokládal, že ceny finančních aktiv se řídí It\^oovými procesy s konstantními parametry. 
%Dalším jeho předpokladem byla tržní rovnováha.
%
%V další části představíme Ohlson-Rosenbergův paradox publikovaný v roce 1976, který dokazuje rozpor mezi Mertonovými předpoklady.  
%Uvedeme metody, které tímto rozporem nejsou zatíženy.
%Jednou z nich je stochastická teorie portfolia, kterou rozvíjí Robert Fernholz.
%Na závěr zkusíme navrhnout vlastní metodu, která bude mít volnější předpoklady než Mertonův přístup.
%Navržený model budeme aplikovat na reálná data. 

Stochastické metody analýzy dat pronikají do mnoha vědních oborů, získávají zde své místo a stávají se stále populárnějšími.
Jedním z nich je i teorie portfolia.
V této části práce čtenáře seznámíme se základy teorie portfolia, představíme některé modely používané v tomto oboru a uvedeme jejich výhody a nevýhody.
Následně zavedeme vlastní model popisující chování cen finančních aktiv v portfoliu a~budeme jej aplikovat na reálná data.

Úvod do teorie portfolia poskytuje učebnice Jaroslava Brady \cite{bradateorie} nebo Františka Čámského \cite{vcamskyteorie}, ze kterých jsme čerpali.
Dalším zdrojem informací nám byla monografie Franka Fabozziho \cite{fabozziportfolio}.

\textit{Portfolio} je množina finančních aktiv držených fyzickou nebo právnickou osobou zvanou \textit{investor} za účelem dosažení zisku v budoucnosti.
Dalším důvodem sestavování portfolia je diverzifikace rizika.
Investoři se snaží maximalizovat výnos z portfolia vzhledem ke svým rizikovým preferencím.
Teorie portfolia se zabývá způsoby určení tzv. \textit{optimálního portfolia}, které vyhovuje investorovým požadavkům na maximalizaci výnosu při daném riziku (resp. minimalizaci rizika při pevně zvolené výnosnosti).
Využívá k tomu poznatky o~chování cen finančních aktiv, konkrétně charakteristiky finančních aktiv a~charakteristiky portfolia.

%Podle teorie portfolia se investoři snaží minimalizovat riziko své investice spolu s maximalizací svých výnosů.

%Teorie portfolia\\
%- definice investování na finančních trzích\\
%- definice investora\\
%- popis tvorby portfolia\\

%Teorie portfolia se zabývá volbou optimálního portfolia.


%%%%%%%%%%%%%%%%%%{Základní charakteristiky portfolia}

\section{Základní charakteristiky portfolia}\label{charakteristiky_portfolia}
V teorii portfolia se investoři snaží minimalizovat investiční riziko a~zároveň maximalizovat investiční výnos. 
Avšak se zvyšováním očekávaného výnosu je spojen i~růst rizika, proto základním problémem při optimalizaci portfolia je hledání kompromisu mezi maximalizací výnosu a~minimalizací rizika spojeného s~investováním.  
V následující části popíšeme a~definujeme tyto základní charakteristiky portfolia.

\subsection{Výnosnost}
\textit{Míra výnosnosti} (nebo \textit{relativní výnosnost}) aktiva je charakteristika, která udává zisk nebo ztrátu z~investice za pevně stanovené období vyjádřená v~poměru k~množství investovaných prostředků.

\begin{definice}
Investujeme-li $Y$ korun do nějakého aktiva $j$ v čase $t$, pak korunová hodnota investice v čase $t+\Delta t$ bude $\big(1+r_j(t,t+\Delta t)\big)Y$, kde  $r_j(t,t+\Delta t)$ definujeme jako \textit{míru výnosnosti}.  
\end{definice}
 
Relativní výnosnost bývá často označována pouze jako \textit{výnosnost}.
Vzhledem k~tomu, že výnosnost aktiva je pro investora nejistá (s výjimkou bezrizikového aktiva), budeme ji v~teorii portfolia chápat jako náhodnou veličinu. % a~budeme ji značit $r_j$.
Rozdělení pravděpodobnosti této náhodné veličiny nelze určit, nicméně v~teorii portfolia se obejdeme bez znalosti rozdělení a~využijeme pouze dále uvedené základní charakteristiky náhodné veličiny.

První z~těchto charakteristik bude střední hodnota výnosnosti aktiva, kterou označíme $\mathsf{E}(r_j)=\mu_j$.
V~teorii portfolia se ve spojitosti s~touto charakteristikou setkáváme s~pojmem \textit{očekávaná výnosnost}.
Rozptyl výnosnosti aktiva označíme $\mathsf{D}(r_j)=\sigma_j^2$.

Následující značení využijeme při definicích charakteristik porfolia.
Nechť $\boldsymbol{r}=(r_1,\dots,r_n)^\mathrm{T}$ značí náhodný vektor, jehož složky jsou výnosnosti aktiv držených v~portfoliu $p$.
Relativní podíly aktiv, ze kterých se skládá portfolio, se nazývají \textit{váhy} portfolia.
Vektor vah portfolia budeme značit $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$ a~přirozeně platí, že $\sum_{j=1}^nX_j=1$. 
Mezi základní charakteristiky portfolia patří jeho \textit{výnosnost}, která je dána jako $r_p=\boldsymbol{X}^\mathrm{T}\boldsymbol{r}=\sum_{j=1}^nX_jr_j$ a~je rovněž náhodnou veličinou.   
Jedním z faktorů pro výběr portfolia v Markowitzově teorii je \textit{očekávaná výnosnost portfolia}, kterou označíme $\mathsf{E}(r_p)=\mu_p$ a je zřejmé, že platí $\mu_p=\sum_{j=1}^nX_j\mu_j$.

\subsection{Riziko}
\textit{Riziko} popisuje míru nejistoty, že se skutečná výnosnost investice bude lišit od očekávané výnosnosti.  
\textit{Riziko aktiva} definujeme jako směrodatnou odchylku výnosnosti aktiva a~označíme ho $\sqrt{\mathsf{D}(r_j)}=\sigma_j$.
Analogicky je \textit{riziko portfolia} definováno jako směrodatná odchylka výnosnosti portfolia a~značeno $\sqrt{\mathsf{D}(r_p)}=\sigma_p$.  

Riziko celého portfolia v~sobě zahrnuje nejen rizika jednotlivých aktiv v~portfoliu, ale také riziko z~vzájemné závislosti výnosností jednotlivých aktiv.
Míra vzájemné závislosti dvou výnosností je mimo jiné popsána jejich kovariancí. 
Kovarianci výnosnosti aktiva~$j$ a~výnosnosti aktiva~$k$ označíme $\mathsf{C}(r_j,r_k)=\sigma_{jk}$.
Snadno se dá dokázat, že $\sigma_p=\sqrt{\sum_{j=1}^n\sum_{k=1}^nX_jX_k\sigma_{jk}}$.
Riziko portfolia je dalším faktorem pro výběr portfolia v~Markowitzově teorii.  


%%%%%%%%%%%%%%%%%%%%%%%%{Klasická teorie portfolia}


\section{Klasická teorie portfolia}\label{KTP}

Základy klasické teorie portfolia položil Harry Markowitz svým článkem v~roce 1952 \cite{markowitz}, ve kterém upozornil na nutnost zohledňovat při výběru portfolia nejenom očekávanou výnosnost, ale i riziko změny výnosnosti.
Jeho největším přínosem bylo kvantifikování očekávaného výnosu a rizika portfolia. 
Dalším přínosem byl důkaz výhod diverzifikace portfolia.
Obě tyto skutečnosti byly do té doby chápány pouze intuitivně.
Markowitz zkonstruoval množinu všech dostupných portfolií v prostoru výnos -- riziko, zavedl pojem \textit{efektivní množina portfolií}, ze které investor vybírá optimální portfolio pomocí indiferenčních křivek popisujících investorův vztah k riziku.
Konstrukcí množiny dostupných (nebo též přípustných) portfolií se bude věnovat Kapitola \ref{Markowitz_kap}. 
Na Obrázku \ref{obr_Markowitz} je znázorněna množina přípustných portfolií  a množina efektivních portfolií v prostoru výnosnost -- riziko. 

\begin{figure}[!htbp]
  \centering 
  \includegraphics[width=11cm]{IMG/graf_2a.pdf}
  \caption{Množina přípustných portfolií  a množina efektivních portfolií v prostoru výnosnost -- riziko dle Markowitzovy teorie portfolia.} 
  \label{obr_Markowitz}
\end{figure}

V roce 1958 rozšířil James Tobin \cite{tobin} Markowitzův model o možnost investování do bezrizikového aktiva.
Bezrizikové aktivum má jistý výnos a tedy nulové riziko.
To má velký vliv především na efektivní množinu portfolií, která je tvořena tečnou k původní Markowitzově efektivní množině procházející bezrizikovým aktivem, což je zobrazeno na Obrázku \ref{obr_Tobin_1}.
V bodě dotyku pak leží tzv. tangenciální portfolio (viz Obrázek \ref{obr_Tobin_2}).
Postup investora při hledání optimálního portfolia shrnuje Tobinův separační teorém, který se později vžil v souvislosti s CAPM, což je model, který bude popsán v další části textu. % \ref{kapitola_CAPM}.
Investor prvně určí tangenciální portfolio a~následně ho zkombinuje s~bezrizikový aktivem podle svých rizikových preferencí.

\begin{figure}[!htbp]
  \centering 
  \includegraphics[width=11cm]{IMG/graf_5b.pdf}
  \caption{Tobinův model - množina efektivních portfolií v případě, že není povolen prodej na krátko.}
  \label{obr_Tobin_1}
\end{figure}

\begin{figure}[!htbp]
  \centering 
  \includegraphics[width=11cm]{IMG/graf_1.pdf}
  \caption{Tobinův model - zobrazení tangenciálního portfolia (rizikového portfolia, do kterého dle Separačního teorému investují všichni investoři při tvorbě optimálního portfolia).}
  \label{obr_Tobin_2}
\end{figure}

%\subsection{Kapitálový model aktiv -- CAPM}\label{kapitola_CAPM}
\textit{Capital Asset Pricing Model (CAPM)} vyvinuli nezávisle na sobě autoři William Sharpe \cite{sharpe1964}, John Lintner \cite{lintner1965} a Jan Mossin \cite{mossin1966} v letech 1964--1966. CAPM zkoumá chování trhu v případě, že se všichni investoři chovají podle Markowitzovy teorie.
Zároveň vychází z Tobinova modelu, protože zahrnuje bezrizikové aktivum.
CAPM stojí na několika výchozích předpokladech, které se dají shrnout do následujících tří:
\begin{itemize}
\item[-] kapitálový trh je efektivní,
\item[-] investoři při sestavování portfolia využívají Markowitzův přístup,
\item[-] investoři mají homogenní očekávání.
\end{itemize}
Předpoklad homogenity očekávání investorů má za následek, že všichni investoři drží stejné rizikové portfolio.
Optimální portfolia investorů se liší pouze v poměru, v jakém kombinují rizikové portfolio a bezrizikové aktivum v závislosti na svých rizikových preferencích.
Toto shrnuje následující věta.

\begin{veta}(Separační teorém)
Optimální kombinace rizikových cenných papírů může být stanovena bez jakékoliv znalosti investorových postojů k riziku a výnosnosti.
\end{veta}

Předpokládáme-li rovnováhu trhu, bývá tangenciální portfolio nazýváno jako \textit{tržní portfolio}.
Důležitým důsledkem pak je, že váha každého cenného papíru v tržním portfoliu je rovna jeho tržní ceně. \label{vahy_trznihodnota}
Tento poznatek budeme později využívat při konstrukci spojitého rovnovážného modelu.

\subsection{Markowitzova teorie portfolia}\label{Markowitz_kap}
Abychom blíže pochopili obrázky a pojmy používané v Kapitole \ref{KTP} stručně na tomto místě přiblížíme odvození množiny přípustných portfolií  dle Markowitzovy teorie portfolia.

Pro zjednodušení budeme uvažovat portfolio složené pouze ze dvou rizikových aktiv, které označíme $A$ a $B$.
Váhy tohoto portfolia budeme značit $(X_A,X_B)$ a zřejmě platí $X_A+X_B=1$.
Očekávaná výnosnost portfolia je pak dána jako 
\begin{equation}
 \mu_p=X_A\mu_A+X_B\mu_B,
\end{equation}
kde $\mu_A$ je očekávaná výnosnost aktiva~$A$ a $\mu_B$ je očekávaná výnosnost aktiva~$B$.
Korelační koeficient výnosností aktiva $A$ a $B$ označíme $\rho$ a platí
\begin{equation}
 \rho=\frac{\sigma_{AB}}{\sigma_A\sigma_B},
\end{equation} 
kde $\sigma_A$ a $\sigma_B$ jsou rizika aktiv $A$ a $B$, $\sigma_{AB}$ označuje kovarianci výnosnosti aktiva $A$ a výnosnosti aktiva $B$.
Riziko portfolia je pak dáno vztahem
\begin{equation}
 \sigma_p=\sqrt{X_A^2\sigma_A^2+X_B^2\sigma_B^2+2X_AX_B\rho\,\sigma_A\sigma_B}.
\end{equation}

Podoby různých množin přípustných portfolií v závislosti na hodnotě korelačního koeficientu výnosností rizikových aktiv vidíme na Obrázku \ref{odvozeni_Markowitz}.
\begin{figure}[!htbp]\label{odvozeni_Markowitz}
  \centering 
  \includegraphics[width=11cm]{IMG/pripustna_portfolia.pdf}
  \caption{Ukázky tvarů množin přípustných portfolií  dle Markowitzovy teorie portfolia složených ze dvou rizikových aktiv.}
\label{odvozeni_Markowitz}
\end{figure}
Uvažujeme-li portfolio složené z více rizikových aktiv dostáváme množinu přípustných portfolií v podobě zobrazené na Obrázku \ref{obr_Markowitz}.
Podrobný popis odvození tvarů množin přípustných portfolií včetně mnoha přehledných obrázků nalezneme ve skriptech \cite{bradateorie}. 


\subsection{Váhy tržního portfolia}\label{vahy_kap}
Významnost tržního portfolia pro investory jsme popsali v předchozí části.
Nyní odvodíme vztah pro váhy tržního portfolia, který dále využijeme při konstrukci modelu v Kapitole \ref{muj_model}.
Uvedeme pouze základní kroky pro určení těchto vah, podrobnosti lze nalézt v již citované literatuře \cite{vcamskyteorie} a \cite{fabozziportfolio}.

%Pro zjednodušení předpokládejme, že výnosnost bezrizikového aktiva $r_f=0$.
Nechť $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$ je vektor vah portfolia z množiny efektivních portfolií dle Markowitzovy teorie (viz Obrázek \ref{obr_Markowitz}).
Pak očekávaná výnosnost tohoto portfolia je dána vztahem
\begin{equation}\label{vynosnost_portfolia_vztah}
 \mu_p=\boldsymbol{X}^\mathrm{T}\boldsymbol{\mu}
\end{equation}
a jeho riziko je dáno vztahem 
\begin{equation}\label{riziko_portfolia_vztah}
\sigma_p=\sqrt{\boldsymbol{X}^\mathrm{T}\boldsymbol{\Sigma}\boldsymbol{X}},
\end{equation}
kde $\boldsymbol{\mu}=(\mu_1,\dots,\mu_n)^\mathrm{T}$ je vektor očekávaných výnosností rizikových aktiv  a $\boldsymbol{\Sigma}$ je kovarianční matice výnosností rizikových aktiv.
Výnosnost bezrizikového aktiva označíme $r_f$.

Váhy tržního portfolia musí splňovat vztahy \eqref{vynosnost_portfolia_vztah} a \eqref{riziko_portfolia_vztah} a zároveň musí maximalizovat hodnotu směrnice polopřímky, jejímž počátečním bodem je bezrizikové aktivum a která je tečnou ke křivce efektivních portfolií dle Markowitzovy teorie (viz Obrázek \ref{obr_Tobin_2}).
Tedy hledáme takový vektor $\boldsymbol{X}$, který maximalizuje výraz
\begin{equation} \label{maximalizacni_problem_vztah}
\frac{\mu_p-r_f}{\sigma_p}=\frac{\boldsymbol{X}^\mathrm{T}\left(\boldsymbol{\mu}-r_f\boldsymbol{1}\right)}{\left({\boldsymbol{X}^\mathrm{T}\boldsymbol{\Sigma}\boldsymbol{X}}\right)^\frac12}= f(\boldsymbol{X})
\end{equation}
za podmínky $\boldsymbol{1}^\mathrm{T}\boldsymbol{X}=1$, kde $\boldsymbol{1}$ je vektor jedniček.

Maximum funkce $f(\boldsymbol{X})$ dané výrazem \eqref{maximalizacni_problem_vztah} hledáme tak, že funkci derivujeme podle všech složek vektoru $\boldsymbol{X}$ a tyto derivace položíme rovny nule.
Získáme tak systém $n$ lineárních rovnic o $n$ neznámých
\begin{equation}\label{maximalizace_rovnice}
 \frac{\partial f(\boldsymbol{X})}{\partial{X_i}}=0,
\end{equation}
kde $i=1,\dots,n$

Postup řešení systému rovnic \eqref{maximalizace_rovnice} vyžaduje dvě substituce a je relativně zdlouhavý, proto jej zde nebudeme prezentovat a uvedeme jen výsledné řešení.
Vektor vah v tržním portfoliu  je dán vztahem
\begin{equation} \label{vahy_trzni}
\boldsymbol{X}=\frac{\boldsymbol{\Sigma}^{-1}\left(\boldsymbol{\mu}-r_f\boldsymbol{1}\right)}{\boldsymbol{1}^\mathrm{T}\,\boldsymbol{\Sigma}^{-1}\left(\boldsymbol{\mu}-r_f\boldsymbol{1}\right)},
\end{equation}
kde $\boldsymbol{1}$ je vektor jedniček, $\boldsymbol{\mu}=(\mu_1,\dots,\mu_n)^\mathrm{T}$ je vektor očekávaných výnosností rizikových aktiv, $\boldsymbol{\Sigma}$ je kovarianční matice výnosností rizikových aktiv a $r_f$ je výnosnost bezrizikového aktiva.


%%%%%%%%%%%%%%%%%%%%%%%%{Dynamická teorie portfolia}

\section{Dynamická teorie portfolia}
Hlavní výhodou dynamického modelu pro výběr aktiv v portfoliu je přizpůsobování se měnícím se podmínkám trhu a proto je více realistický než model statický.
Naproti tomu je dynamický model komplikovanější, hůře interpretovatelný a při jeho využití se nevyhneme složitější matematické teorii, kterou je stochastická analýza.

\begin{comment}
\subsection{Matematický úvod}
Na tomto místě připomeneme některé základní pojmy ze stochastické analýzy a značení obvykle užívané v dynamické teorii portfolia. 

\begin{definice}
Stochastický proces $\{W(t):t\ge0\}$ definovaný na pravděpodobnostním prostoru $(\Omega,\mathcal{A},\mathsf{Pr})$ se nazývá \textit{standardní (jednorozměrný) Wienerův proces} právě tehdy, když jsou splněny následující podmínky
\begin{enumerate}
\item[1.]$W(0)=0$, 
\item[2.]funkce $t\to W(t)$ (trajektorie Wienerova procesu) je spojitá s pravděpodobností jedna,
\item[3.]proces $\{W(t):t\ge0\}$ má nezávislé přírůstky, 
\item[4.]pro všechna $t\ge s\ge0$ jsou přírůstky $W(t)-W(s)$ normálně rozdělené se střední hodnotou nula a rozptylem $t-s$.
\end{enumerate}
Standardní \textit{$n$-rozměrný Wienerův proces} je vektorový stochastický proces
$$\boldsymbol{W}(t) = (W_1(t), \dots, W_n(t))^\mathrm{T}$$
jehož složky $W_k(t)$ jsou nezávislé, standardní jednorozměrné Wienerovy procesy.
\end{definice}
Wienerův proces je stavebním kamenem matematického modelování ve finanční matematice. 
Tento stochastický proces se používá pro popis chování ceny aktiva v čase. 

Budeme předpokládat, že proces popisující vývoj ceny aktiva v čase se řídí následujícím modelem
$$\mathrm{d}P(t)=P(t)\,\mu(t)\,\mathrm{d}t+P(t)\,\sigma(t)\,\mathrm{d}W(t),$$
kde $P(t)$ je cena aktiva v čase $t$, $\mu(t)$ a $\sigma(t)$ jsou stochastické procesy a $W(t)$  je jednorozměrný Wienerův proces.
Tento model předpokládá, že na trhu je pouze jedno rizikové aktivum.

Model pro vývoj ceny aktiv na trhu, který předpokládá existenci $n$ rizikových aktiv je dán jako
$$\mathrm{d}P_j(t)=P_j(t)\,\mu_j(t)\,\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}(t)\,\mathrm{d}W_k(t),$$
kde $P_j(t)$ je cena aktiva $j$ v čase $t$, $\mu_j(t)$ a $\xi_{jk}(t)$ jsou stochastické procesy a $\boldsymbol{W}(t)=(W_1(t),\dots,W_n(t))^\mathrm{T}$ je $n$-rozměrný Wienerův proces. 
Pro více informací o mnohorozměrných modelech viz \cite{etheridge2002course}.

Chování ceny bezrizikového aktiva je popsáno modelem
$$\mathrm{d}B(t)=B(t)\,r_f(t)\,\mathrm{d}t,$$
kde $B(t)$ je cena bezrizikového aktiva v čase $t$ a $r_f(t)$ je bezriziková úroková míra.
\end{comment}

\subsection{Mertonův model}
První článek zabývající se dynamickou teorií portfolia napsal Robert Carhart Merton v roce 1971 \cite{merton1971}.
Merton předpokládal platnost rovnovážného modelu CAPM a dál tuto teorii rozšířil o spojitý model pro cenu aktiva využívající stochastické procesy.
Přitom ukázal, že zůstává zachována platnost všech závěrů z teorie CAPM, zejména pak Separačního teorému.
Což znamená, že bez újmy na obecnosti můžeme uvažovat jen dvě aktiva -- bezrizikové aktivum s mírou výnosnosti $r_f$ a tržní portfolio (které můžeme považovat za jedno rizikové aktivum). 

Merton předpokládá, že hodnota tržního portfolia $P(t)$ se řídí stochastickým procesem
$$\mathrm{d}P(t)=P(t)\,\mu_p\,\mathrm{d}t+P(t)\,\sigma_p\,\mathrm{d}W(t)$$
kde $W(t)$ je jednorozměrný Wienerův proces a $\mu_p$, $\sigma_p$ jsou konstanty. 

V každém čase $t$ vybírá investor své optimální portfolio volbou vah portfolia.
Majetek, který investor investuje do optimálního portfolia v čase $t$, označíme $w(t)$.
Váhu tržního portfolia v optimálním portfoliu označíme $X_p(t)$ a váhu bezrizikového aktiva označíme $X_f(t)=(1-X_p(t))$. 
Proces popisující vývoj investorova majetku je dán jako
$$\frac{\mathrm{d}w(t)}{w(t)}=X_p(t)\,\frac{\mathrm{d}P(t)}{P(t)}+\big(1-X_p(t)\big)\,r_f\,\mathrm{d}t.$$
Merton odvodil explicitní řešení této stochastické diferenciální rovnice za předpokladu, že charakteristiky výnosnosti aktiva jsou konstantní.

Avšak Mertonův spojitý rovnovážný model vykazuje inkonzistenci, což dokázali Ohlson a Rosenberg \cite{ohlson} hned v roce 1976.
Ještě před zveřejněním jejich článku byla uveřejněna ve stejném periodiku Mertonova reakce \cite{merton1975}, ve které hájí své poznatky a poukazuje na jejich nepochopení ze strany oponentů.  
Ohlson a Rosenberg poukazují na rozpor mezi předpokladem, že střední hodnota a rozptyl výnosnosti aktiva jsou konstantní, a předpokladem tržní rovnováhy.
Podrobněji bude tento paradox rozebrán v Kapitole \ref{paradox}.


%%%%%%%%%%%%%%%%%%%%%%%%%%{Ohlson-Rosenbergův paradox}
\section{Ohlson-Rosenbergův paradox}\label{paradox}
V této kapitole představíme základní poznatky z článku Ohlsona a Rosenberga \cite{ohlson}, který byl publikován v roce 1976 v \textit{Journal of Financial and Quantitative Analysis}.
Ohlson a Rosenberg jako první poukázali na nekonzistenci Mertonova spojitého modelu \cite{merton1971} spočívající v rozporu předpokladů.

\subsection{Značení a předpoklady}
Na začátek zavedeme značení a  uvedeme základní definice a předpoklady. 
Uvažujme množinu $n$ různých aktiv na daném trhu a označme $\mathcal{T}$ množinu všech uvažovaných časů (diskrétní nebo spojitou).
Nechť $I_t$ značí množinu všech investorů na trhu v čase $t\in \mathcal{T}$.
Cenu aktiva $j$ v čase $t$ označíme $P_j(t)$ a~$\boldsymbol{P}(t)=(P_1(t),\dots,P_n(t))^\mathrm{T}$ je vektor cen aktiv v čase $t$.
Analogicky označíme $\boldsymbol{N}(t)=(N_1(t),\dots,N_n(t))^\mathrm{T}$ vektor podílů aktiv v čase $t$.
Potom tržní hodnota aktiva $j$ je rovna $V_j(t)=P_j(t)N_j(t)$.

Míru výnosnosti aktiva $j$, které drží investor v portfoliu v časovém intervalu $(t,t+\Delta t)$ označíme $r_j(t,t+\Delta t)$.
Jak bylo zmíněno výše výnosnost chápeme jako náhodnou veličinu a o její distribuční funkci v čase $t$ vyslovíme tři následující předpoklady:
\begin{enumerate}
\item \label{Stacionarita} \textit{Stacionarita:} distribuční funkce výnosnosti  je stejná ve všech časech $t$,                                                                            
\item \label{Martingalvl} \textit{Markovovská vlastnost:} pro každé $t$ je distribuční funkce výnosnosti nezávislá na všech cenách aktiva pozorovaných před časem~$t$,
\item \label{Homogenita} \textit{Homogenita:} distribuční funkce výnosnosti je stejná pro všechny investory z množiny $I_t$. 
\end{enumerate} 
Tyto předpoklady jsou konzistentní s předpoklady CAPM.

Označme $w_{j}(i,t)$ optimální objem prostředků investovaných do aktiva~$j$ investorem~$i$ v čase~$t$.
Nechť $\boldsymbol{w}(i,t)=(w_{1}(i,t),\dots,w_{n}(i,t))$ představuje optimální alokaci prostředků investora $i$ držených v portfoliu všech aktiv.
Funkce $w_{j}(i,t)$ tedy zohledňuje (rizikové) preference investora $i$ v čase $t$.
  
Nyní můžeme definovat dynamickou tržní rovnováhu jako stav, kdy  nabídka a poptávka jsou v dokonalé rovnováze v každém čase $t$.
Tento stav se také nazývá \textit{vyčištění trhu}.
         
\begin{definice}[Dynamická tržní rovnováha]
Řekneme, že kapitálový trh je v~\textit{dynamické rovnováze}, jestliže pro každý čas $t\in \mathcal{T}$, každé podkladové aktivum $j$ a~každého investora $i$ existuje vektor cen aktiv $\boldsymbol{P}(t)$ takový že
$$\sum_{i\in I} w_{j}(i,t)=N_j(t)P_j(t)=V_j(t).$$
Tyto ceny budeme nazývat \textit{rovnovážné ceny}.
\end{definice}

Důsledek Tobinova separačního teorému shrňme jako vlastnost pro prostředky investované do portfolia, kterou budeme dále využívat v~důkazu inkonzistence předpokladů spojitého modelu pro ceny aktiv.
\begin{definice}[Vlastnost separace]\label{vlastnost_separace}
Vektorová funkce pro optimální alokaci investorových prostředků do všech aktiv na trhu $\boldsymbol{w}(i,t)$ respektuje \textit{vlastnost separace} právě tehdy, když existuje vektor $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$ takový, že $\sum_{j=1}^nX_j=1$, a existují skalární parametry $\lambda(i,t)$ takové, že
$$\boldsymbol{w}(i,t)=\lambda(i,t)\boldsymbol{X},$$
pro všechny $i\in I$ a všechny $t\in \mathcal{T}$.
\end{definice}
Vlastnost separace definovaná Definicí \ref{vlastnost_separace} říká, že vektor $\boldsymbol{X}$ představuje váhy tržního portfolia (které se v čase nemění) a parametr $\lambda(i,t)$ zohledňuje rizikové preference investora.

\subsection{Rozpor mezi předpoklady}
Budeme-li předpokládat rovnováhu na trhu a stacionaritu distribuční funkce výnosností, dospějeme ke sporu, jak ukazuje následující věta a důsledek.

\begin{veta} \label{T1}
Nechť $\boldsymbol{P}(t)$ pro všechny $t\in \mathcal{T}$  jsou rovnovážné ceny.
Dále předpokládejme, že na trhu platí vlastnost separace (Definice \ref{vlastnost_separace}).
Pak
\begin{equation}\label{T1_eq}
\mathsf{Pr}\left(\frac{N_j(s)P_j(s)}{N_j(t)P_j(t)}=\frac{N_k(s)P_k(s)}{N_k(t)P_k(t)}\right)=1
\end{equation}
pro všechny časy $s,t\in \mathcal{T}$  a pro každé aktivum $j$ a $k$.
\end{veta}

\begin{proof}
Podle Definice \ref{vlastnost_separace} platí
\begin{equation}\label{CSW}
w_j(i,t)=\lambda(i,t)X_j
\end{equation}
pro všechny časy $t\in \mathcal{T}$, všechny investory $i\in I$ a pro každé aktivum $j$.

Předpoklad dynamické rovnováhy na trhu dává
\begin{equation}\label{E}
\sum_{i\in I} w_{j}(i,t)=N_j(t)P_j(t)
\end{equation}
pro všechny časy $t\in \mathcal{T}$ a pro každé aktivum $j$.

Dosazením vztahu \eqref{CSW} do rovnice \eqref{E} a vzhledem k tomu, že váhy $X_j$ jsou stejné pro všechny investory $i\in I$, dostáváme
$$N_j(t)P_j(t)=\sum_{i\in I}\lambda(i,t)X_j=X_j\sum_{i\in I}\lambda(i,t).$$
Proto platí
$$\frac{N_j(t)P_j(t)}{N_k(t)P_k(t)}=\frac{X_j\sum_{i\in I}\lambda(i,t)}{X_k\sum_{i\in I}\lambda(i,t)}=\frac{X_j}{X_k},$$
což je nezávislé na čase $t$.         
Z tohoto tvrzení zřejmě plyne vztah \eqref{T1_eq}.
\end{proof}

\begin{dusledek}\label{OR_dusledek}
Nechť 
$$r_j(t,t+\Delta t)=\frac{P_j(t+\Delta t)-P_j(t)}{P_j(t)}=\frac{P_j(t+\Delta t)}{P_j(t)}-1.$$
Budeme předpokládat $N_j(t)=N_j$ pro každé aktivum $i$ a všechna $t\in \mathcal{T}$. 
Z~Věty \ref{T1} plyne
\begin{align*}
\mathsf{Pr}\left(\frac{P_j(s)}{P_j(t)}=\frac{P_k(s)}{P_k(t)}\right)=1&\Longrightarrow\mathsf{Pr}\left(\frac{P_j(t+\Delta t)}{P_j(t)}=\frac{P_k(t+\Delta t)}{P_k(t)}\right)=1 \\
&\Longrightarrow\mathsf{Pr}\left(r_j(t,t+\Delta t)=r_k(t,t+\Delta t)\right)=1,
\end{align*}
pro všechna $t\in \mathcal{T}$ a pro všechna aktiva $j$ a $k$.
Proto jsou aktiva $j$ a $k$ vzájemně dokonale zastupitelné.
\end{dusledek}
Důsledek \ref{OR_dusledek} vede k degeneraci trhu, což poukazuje na významný rozpor mezi předpoklady.

Ve své době se Ohlson a Rosenberg nesetkali s pochopením.
Důkazem toho je okamžité odmítnutí jejich závěrů ze strany Mertona publikované v článků \cite{merton1975}, kde tvrdí, že rozporu bylo docíleno jen díky nereálným předpokladům. 
Ve skutečnosti reaguje jen na důsledky nikoli na důkaz stěžejní věty článku \cite{ohlson}.  
Za povšimnutí stojí, že Mertonova reakce vychází ještě před samotným článkem Ohlsona a Rosenberga.

%%%%%%%%%%%%%%%%%%%%%%%%%%{Stochastická teorie portfolia}

\section{Stochastická teorie portfolia}
V této kapitole jsou shrnuty některé základní poznatky Stochastické teorie portfolia, která byla pro nás inspirací pro studium spojitých modelů v teorii portfolia uvedených v této práci.
Budeme diskutovat o výhodách a nevýhodách tohoto přístupu.

Pojem \textit{Stochastická teorie portfolia} (SPT) zavedl Robert Fernholz ve své monografii \cite{fern}.
Jedná se o matematickou teorii, která zkoumá chování portfolia jakožto i strukturu kapitálového trhu.
Hlavní výhodou oproti klasické teorii portfolia jsou méně  striktní předpoklady, které dovolují konzistentní přístup bez výskytu Ohlson-Rosenbergova paradoxu.

Na rozdíl od Mertonova modelu se v SPT nepředpokládá tržní rovnováha.
Navíc parametry stochastického procesu, kterými se řídí cena aktiva, jsou v SPT stochastické procesy nikoli konstanty jako v Mertonově přístupu.
Dokonce, na rozdíl od klasického přístupu, se v SPT neklade důraz na předpoklad neexistence tržní arbitráže, přičemž se v práci diskutuje o vlastnosti trhu vedoucí k existenci arbitráže. 

Pro vývoj ceny aktiva Fernholz používá následující spojitý logaritmický model
$$\mathrm{d}\log P_j(t)=\gamma_j(t)\,\mathrm{d}t+\sum_{k=1}^{n}\xi_{jk}(t)\,\mathrm{d}W_k(t),$$
kde $P_j(t)$ je cena aktiva $j$ v čase $t$, $\gamma_j(t)$ a $\xi_{jk}(t)$ jsou stochastické procesy a $\boldsymbol{W}(t)=(W_1(t),\dots,W_n(t))^\mathrm{T}$ je $n$-dimenzionální Wienerův proces. 
Proces $\gamma_j(t)$ se nazývá \textit{míra růstu} a $\xi_{jk}(t)$ se nazývá proces \textit{volatility}.
Míru růstu v logaritmickém modelu je možno odvodit z míry výnosnosti ve standardním modelu a naopak podle následujícího vztahu
$$\mu_j(t)=\gamma_j(t)+\frac12\sum_{k=1}^{n}{\xi_{jk}}^2(t).$$
Robert Fernholz uvádí, že v dlouhém časovém horizontu je chování hodnoty portfolia lépe popsáno mírou růstu než mírou výnosnosti.
Uvažujeme-li kovarianční matici $\boldsymbol{\Sigma}$ výnosností aktiv, pak matice volatilit $\boldsymbol{\xi}$ je definována jako
$$\boldsymbol{\Sigma}=\boldsymbol{\xi}\boldsymbol{\xi}^\mathrm{T}.$$
Tedy $\boldsymbol{\xi}$ je maticová odmocnina z $\boldsymbol{\Sigma}$.

Jedním ze základních pojmů v SPT jsou \textit{portfolio generující funkce}, pomocí nichž jsou tvořeny portfolia, které mají dobře definované výnosnosti. 
Podrobnější informace je možno najít v knize \cite{fern} a článku \cite{kara}.

Studium SPT nás motivovalo k hledání vhodného spojitého modelu pro popis cen aktiv v portfoliu, který rovněž odstraní Ohlson-Rosenbergův paradox a zároveň bude zachovávat platnost poznatků teorie CAPM.
Tento model budeme konstruovat v Kapitole \ref{muj_model}.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Paradox v teorii portfolia a Věta o~separaci do~dvou fondů} \label{john}
Nekonzistencí obvyklých předpokladů dynamické teorie portfolia se v roce 2009 zabýval také John Stalker profesor na Trinity College, Dublin. 
V preprintu \cite{john} uvádí algebraický důkaz inkonzistence předpokladů, kde využívá Tobinovu \textit{Větu o~separaci do~dvou fondů}. 
V následujícím textu budou tyto myšlenky rozpracovány.

Uvažujme následující předpoklady obvyklé pro teorii portfolia:
\begin{enumerate}
\item \label{predpoklad_konstantnosti_vynosu_a_rizika} Ceny podkladových aktiv se řídí It\^oovými procesy, které mají konstantní očekávané míry výnosnosti a konstantní kovariance výnosností. 
\item Neexistují žádná omezení na množství aktiv držených investorem. Aktiva jsou navíc nekonečně dělitelná.
\item Neexistují žádné transakční náklady a cena prodeje a nákupu podkladového aktiva se neliší.
\item Investoři se chovají podle Markowitzovy teorie, což znamená, že minimalizují riziko svého portfolia pro dané očekávané míry výnosnosti.
\item \label{predpoklad_hodnost} Na trhu existuje pouze jedno bezrizikové aktivum. Kovarianční matice rizikových aktiv má maximální hodnost.
\item \label{predpoklad_konstantnosti_N} Na trhu existuje rovnováha a každý investor nabízející aktivum najde kupce a naopak.
\end{enumerate}

Dále dokážeme, že tyto předpoklady jsou nekonzistentní pro trh s více než dvěma rizikovými aktivy.
K tomu využijeme Větu o~separaci do~dvou fondů, kterou poprvé dokázal  James Tobin ve svém článku \cite{tobin}. 
Tobin předpokládal platnost předpokladů CAPM a zároveň zahrnul existenci bezrizikového aktiva.
Naproti tomu v knize Williama Sharpeho \cite{sharpe} a v článku Roberta Mertona \cite{merton} najdeme podobné závěry bez předpokladu existence bezrizikového aktiva.
Merton navíc tyto myšlenky zobecňuje pro více než dva fondy \cite{merton1973}.
Podrobnějším rozbor věty o dvou fondech je uveden v knize \cite{cass1970structure}.
\begin{veta}[Věta o~separaci do~dvou fondů]
%Efektivní portfolio každého investora lze získat jako kombinaci dvou fondů.
Optimální portfolio každého investora lze získat jako kombinaci dvou fondů.
\end{veta}
%Efektivní nebo spíš optimální?

Na trhu s~$m$ podkladovými aktivy uvažujme dvě portfolia (neboli dva fondy) a jejich váhy označme $\boldsymbol{a}=(a_1,\dots,a_m)^\mathrm{T}$ a $\boldsymbol{b}=(b_1,\dots,b_m)^\mathrm{T}$. Z těchto dvou fondů pak můžeme sestavit optimální portfolia všech investorů na trhu.
Množinu všech investorů označme $I$ a pro každého investora uvažujme jeho rizikové preference, které určují jeho optimální portfolio, a popišme je pomocí parametrů $\alpha_i(t)$ a $\beta_i(t)$.
Optimální portfolio $i$-tého investora bude zahrnovat $\alpha_ia_j+\beta_ib_j$ množství $j$-té akcie.

Váhy $\boldsymbol{a}$ a  $\boldsymbol{b}$ dvou uvažovaných fondů závisí pouze na očekávaných výnosnostech a riziku podkladových aktiv na trhu, které jsou v čase konstantní dle předpokladu \ref{predpoklad_konstantnosti_vynosu_a_rizika}.
Parametry $\alpha_i(t)$ a $\beta_i(t)$ závisí na individuálních preferencích jednotlivých investorů (např. rizikové preference nebo objem investic) a mohou se lišit.
Tyto preference se mohou v čase měnit a tak parametry mohou záviset i na čase.

Označme $A(t)$ součet všech parametrů $\alpha_i(t)$ pro všechny investory a analogicky $B(t)$ součet parametrů $\beta_i(t)$ .
Tedy $A(t)=\sum_{i\in I}\alpha_i(t)$ a $B(t)=\sum_{i\in I}\beta_i(t)$.
Pak celková hodnota držená všemi investory v $j$-tém aktivu je $Aa_j+Bb_j$ a musí být rovna tržní hodnotě aktiva.
Platí
$$A(t)\,a_j+B(t)\,b_j=P_j(t)\,N_j,$$
kde $P_j(t)$ je tržní cena podkladového aktiva $j$ v čase $t$ a $N_j$ je jeho dostupné množství.
Přičemž $A(t),B(t)$ a $ P_j(t)$ jsou funkce času a $N_j$ je konstantní v~čase podle předpokladu \ref{predpoklad_konstantnosti_N}.
Pro změnu ceny aktiva $j$ mezi časem $t$ a časem $t+\Delta t$ platí
\begin{displaymath}
\Delta P_j = \frac{a_j}{N_j}\Delta A + \frac{b_j}{N_j}\Delta B,
\end{displaymath}
kde $\Delta A = A(t+\Delta t) - A(t)$ a $\Delta B = B(t+\Delta t)- B(t)$.

Uvažujme míru výnosnosti podkladového aktiva $j$ za čas $\Delta t$
\begin{displaymath}
r_j(t,t+\Delta t)=\frac{\Delta P_j}{P_j(t)}=\frac{a_j}{N_jP_j(t)}\Delta A + \frac{b_j}{N_jP_j(t)}\Delta B
\end{displaymath}
a kovarianční matici výnosností podkladových aktiv držených v portfoliu
$$\boldsymbol{\Sigma}(\boldsymbol{r})=
\begin{pmatrix}
\mathsf{D}(r_1)  & \ldots & \mathsf{C}(r_1,r_m)  \cr \vdots & \ddots & \vdots\cr \mathsf{C}(r_m,r_1)   & \ldots & \mathsf{D}(r_m) 
\end{pmatrix}.$$
Vzhledem k vlastnostem kovariance (viz \cite{andel}) můžeme kovarianční matici výnosností rozložit na součin 
$$
%\begin{displaymath}
\boldsymbol{\Sigma}(\boldsymbol{r})= 
\begin{pmatrix}
\frac{a_1}{N_1P_1} & \frac{b_1}{N_1P_1}\cr \vdots & \vdots\cr \frac{a_m}{N_mP_m} & \frac{b_m}{N_mP_m}
\end{pmatrix}
%\end{displaymath}
\times
%\begin{displaymath*}
\begin{pmatrix}
\frac{\mathsf{C}(\Delta A, \Delta A)}{\Delta t} &
\frac{\mathsf{C}(\Delta A, \Delta B)}{\Delta t} \cr
\frac{\mathsf{C}(\Delta B, \Delta A)}{\Delta t} & \frac{\mathsf{C}(\Delta B,
\Delta B)}{\Delta t} 
\end{pmatrix}
%\end{displaymath*}
\times
%\begin{displaymath*}
\begin{pmatrix}
\frac{a_1}{N_1P_1} & \ldots & \frac{a_m}{N_mP_m}\cr \cr \frac{b_1}{N_1P_1} & \ldots &
\frac{b_m}{N_mP_m}
\end{pmatrix}.
%\end{displaymath*}
$$

Dále platí, že hodnost součinu matic je menší nebo rovna maximální z hodností matic jeho činitelů.
Vzhledem k tomu nemůže mít kovarianční matice výnosností podkladových aktiv držených v portfoliu hodnost větší než dvě.
Avšak to je v rozporu z předpokladem \ref{predpoklad_hodnost}, pokud uvažujeme portfolio s více než dvěma podkladovými aktivy.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Spojitý rovnovážný model s očekávanou výnosností závislou na ceně aktiva}\label{muj_model}
V Kapitolách \ref{paradox} a \ref{john} jsme ukázali, že v teorii portfolia běžně používaný dynamický model není konzistentní.
Proto se chceme pokusit navrhnout takový model, který by nebyl touto inkonzistencí předpokladů zatížen.
Uvažujme spojitý model, který bude mít méně omezující předpoklady než model Mertonův.
Model, který předkládáme v této kapitole, předpokládá rovnováhu na trhu, nicméně očekávaná míra výnosnosti není konstantní v čase.

Na základě poznatků z teorie portfolia budeme hledat vztah mezi očekávanou výnosností a cenou aktiva, který bychom mohli použít v modelu.
Nechť $\boldsymbol{P}$ je vektor cen $n$ podkladových aktiv.
Předpokládejme, že tyto ceny se řídí následující soustavou stochastických diferenciálních rovnic, pro $j=1,\dots,n$ platí
\begin{equation} \label{SDE}
\mathrm{d}P_j(t)=P_j(t)\mu_j(t)\,\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}(t)\,\mathrm{d}W_k(t),
\end{equation}
kde $\boldsymbol{W}(t)=(W_1(t),\dots,W_n(t))^\mathrm{T}$ je $n$-rozměrný Wienerův proces, $\mu_j(t)$ je očekávaná míra výnosnosti podkladového aktiva $j$ a $\xi_{jk}(t)$ je proces volatility. 

Pro zjednodušení předpokládejme, že výnosnost bezrizikového aktiva $r_f=0$.
Nechť $\boldsymbol{X}=(X_1,\dots,X_n)^\mathrm{T}$ je vektor vah v tržním portfoliu, pak ze vztahu \eqref{vahy_trzni} plyne
\begin{equation} \label{vahy}
\boldsymbol{X}=\frac{\boldsymbol{\Sigma}^{-1}\boldsymbol{\mu}}{\boldsymbol{1}^\mathrm{T}\,\boldsymbol{\Sigma}^{-1}\boldsymbol{\mu}},
\end{equation}
kde $\boldsymbol{1}$ je vektor jedniček, $\boldsymbol{\mu}=(\mu_1,\dots,\mu_n)^\mathrm{T}$ je vektor očekávaných výnosností podkladových aktiv a $\boldsymbol{\Sigma}$ je kovarianční matice výnosností podkladových aktiv a platí $\boldsymbol{\Sigma}=\boldsymbol{\xi}\boldsymbol{\xi}^\mathrm{T}$.

Uvažujme o řešitelnosti a počtu řešení soustavy rovnic \eqref{vahy} vzhledem k~$\boldsymbol{\mu}$.
Soustavu upravíme do tvaru %vzhledem k tom, že součin matic je distributivní vzhledem ke sčítání
\begin{equation} \label{hodnost}
\left(\boldsymbol{X}\boldsymbol{1}^\mathrm{T}-\mathbf{I}\right)\boldsymbol{\Sigma}^{-1}\boldsymbol{\mu}=0.
\end{equation}
Podle předpokladů v teorii portfolia zmíněných v Kapitole \ref{john} je kovarianční matice plné hodnosti, tedy i matice $\boldsymbol{\Sigma}^{-1}$ má hodnost $n$.
Naproti tomu, díky předpokladu $\sum_{j=1}^nX_j=1$, má matice $\left(\boldsymbol{X}\boldsymbol{1}^\mathrm{T}-\mathbf{I}\right)$ lineárně závislé řádky, jelikož
součet libovolných $n-1$ řádků matice  je roven zbývajícímu řádku vynásobenému minus jednou.
Dá se tedy dokázat, že tato matice má hodnost $n-1$.
To znamená, že soustava rovnic \eqref{hodnost} má nekonečně mnoho řešení vzhledem k $\boldsymbol{\mu}(t)$.
%Dále hledejme nějaké partikulární řešení této soustavy rovnic.

Jak jsme ukázali v Kapitole \ref{vahy_trznihodnota}, váhy tržního portfolia se rovnají relativním tržním hodnotám podkladových aktiv v tržním portfoliu, tedy
\begin{equation} \label{market_value}
\boldsymbol{X}=\frac{\boldsymbol{V}}{\boldsymbol{1}^\mathrm{T}\,\boldsymbol{V}},
\end{equation}
kde $\boldsymbol{V}$ je vektor tržních hodnot podkladových aktiv na trhu.
Připomeňme, že tržní hodnota aktiva $j$ je dána jako $V_j(t)=P_j(t)N_j(t)$.
Vzhledem ke vztahu mezi tržní hodnotou aktiva a cenou aktiva a vzhledem ke vztahům \eqref{vahy} a \eqref{market_value} můžeme konstatovat, že očekávané výnosnosti $\boldsymbol{\mu}(t)$ a ceny aktiv $\boldsymbol{P}(t)$ jsou stejné až na násobek skalárem. 
Proto je přirozené rozdělit modelování dynamiky $\boldsymbol{\mu}(t)$ na dvě části, relativní dynamiku aktiv a dynamiku trhu.
%Ze vztahů \eqref{vahy} a \eqref{market_value} dostáváme $\boldsymbol{V}=\boldsymbol{\Sigma}^{-1}\boldsymbol{\mu}$ a proto očekávané výnosnosti můžeme vyjádřit jako
%\begin{equation} \label{mu}
%\boldsymbol{\mu}=\boldsymbol{\Sigma}\boldsymbol{V}.
%\end{equation}
%Při zohlednění vztahu \eqref{market_value} dostaneme obecné řešení soustavy rovnic \eqref{hodnost} jako $\boldsymbol{\mu}=k(t)\boldsymbol{\Sigma}\boldsymbol{V}$, kde $k(t)$ je parametrická funkce. %$k\in\mathbb{R}$ je parametr. 
%Což znamená, že nemůžeme najít jednoznačné vyjádření pro vektor $\boldsymbol{\mu}$, ale našli jsme vztah mezi složkami tohoto vektoru. %a k jeho vyjádření nám postačí jeden parametr.


Hledejme vhodné stochastické procesy, které by popisovaly chování vektoru $\boldsymbol{\mu}(t)$.
Pro tento účel rozdělme proces očekávané výnosnosti aktiv na dvě složky.
První složka určuje relativní vztahy mezi jednotlivými očekávanými výnosnostmi aktiv v portfoliu, druhá složka popisuje výnosnost celého trhu dynamicky se měnící v čase.  
Mezi těmito složkami bude platit multiplikativní vztah
\begin{equation} \label{vynos}
\boldsymbol{\mu}(t) =\tilde{\boldsymbol{\mu}}(t)\cdot \mu_M(t)
\end{equation}
kde
vektorový stochastický proces $\tilde{\boldsymbol{\mu}}(t)=(\tilde{\mu}_1(t),\dots,\tilde{\mu}_n(t))^\mathrm{T}$ zachycuje relativní vztahy aktiv v~portfoliu, které se mohou v čase měnit, a
$\mu_M(t)$ je skalární stochastický proces, který charakterizuje dynamiku trhu a nezávisí na volbě konkrétního aktiva.
Dále nechť pro všechny uvažované časy $t$ platí $\sum_{i=1}^n\tilde{\mu}_i(t)=1$.
Pak podle teorie CAPM platí 
\begin{equation} \label{vahy_mu}
\tilde{\boldsymbol{\mu}}(t)=\frac{\boldsymbol{\Sigma}\boldsymbol{X}(t)}{\boldsymbol{1}^\mathrm{T}\,\boldsymbol{\Sigma}\boldsymbol{X}(t)},
\end{equation}
kde $\boldsymbol{X}(t)$ je vektor vah v tržním portfoliu v čase $t$.

Analogicky s úrokovou mírou výnosnost celého trhu nevykazuje exponenciální růst, ale pohybuje se přibližně v nějakém intervalu. 
V delším časovém horizontu se projevuje tendence navracet se k průměrné hodnotě.
Proto budeme předpokládat, že míra výnosnosti trhu $\mu_M(t)$ se řídí Vašíčkovým modelem z Kapitoly \ref{Vasickuv_model}
\begin{equation} 
\mathrm{d}\mu_M(t)=\kappa(\theta-\mu_M(t))\,\mathrm{d}t+\sigma\,\mathrm{d}W(t),
\end{equation}
kde $\kappa$, $\theta$ a $\sigma$ jsou konstanty.
Poznamenejme, že speciální případ dynamiky pro $\mu_M(t)$ je konstantní hodnota, odpovídající případu $\kappa=\sigma=0$.

Předpokládejme nyní, že uvažovaná podkladová aktiva jsou nekorelovaná, tedy matice $\boldsymbol{\Sigma}$ je diagonální.
Příkladem takových aktiv by mohly být akcie podniků z velmi odlišných odvětví.
Další zjednodušující předpoklady, které pro tuto chvíli zavedeme, bude neměnnost rizika aktiv $\sigma_j=\xi_{jj}$ v průběhu času a také počty aktiv $N_j$ nechť jsou v čase konstantní.

Dosadíme-li vztahy \eqref{vynos}, \eqref{vahy_mu} a \eqref{market_value} do stochastické diferenciální rovnice \eqref{SDE}, pak s ohledem na předpoklady učiněné výše dostáváme
\begin{equation}  \label{SDE_cen_diag}
\mathrm{d}P_j(t)=P_j(t)\left(\frac{\sum\limits_{i=1}^n\sigma_{ji}P_i(t)N_i}{\sum\limits_{j=1}^n\sum\limits_{i=1}^n\sigma_{ji}P_i(t)N_i}\, \mu_M(t)\right)\mathrm{d}t+P_j(t)\sigma_{j}\,\mathrm{d}W_j(t).
\end{equation}

\begin{comment}
Připomeňme, že tržní hodnota  $V_j(t)=P_j(t)N_j(t)$ a $\sigma_{j}=\xi_{jj}$.
Dosadíme-li vztahy \eqref{mu} do stochastické diferenciální rovnice \eqref{SDE}, pak s ohledem na předpoklady učiněné výše dostáváme
$$ 
\mathrm{d}P_j(t)=P_j^2(t){\sigma_{j}}^2N_j\,\mathrm{d}t+P_j(t)\sigma_{j}\,\mathrm{d}W_j(t).
$$
\hrulefill 
Dále budeme hledat vztah pro očekávané hodnoty cen podkladových aktiv.
Ze SDR \eqref{SDE} plyne
\begin{equation}
\mathsf{E}\big(\mathrm{d}P_j(t)\big)=\mathsf{E}\big(P_j^2(t){\sigma_{j}}^2N_j\,\mathrm{d}t+P_j(t)\sigma_{j}\,\mathrm{d}W_j(t)\big)=\mathsf{E}\big(P_j^2(t){\sigma_{j}}^2N_j\,\mathrm{d}t\big),
\end{equation}
protože z vlastností Wienerova procesu máme $\mathsf{E}\big(\mathrm{d}W_j(t)\big)=0$.
Čímž se stochastická diferenciální rovnice zjednodušuje na obyčejnou diferenciální rovnici (ODR), která je řešitelná pomocí separace proměnných.
\begin{align} 
{\mathrm{d}\mathsf{E}\big(P_j(t)\big)}&={\sigma_{j}}^2N_j\,\mathsf{E}\big(P_j^2(t)\big)\mathrm{d}t \notag\\
&={\sigma_{j}}^2N_j\big[\mathsf{D}\big(P_j(t)\big)+\mathsf{E}^2\big(P_j(t)\big)\big]\mathrm{d}t \notag\\
&={\sigma_{j}}^2N_j\big[{\sigma_{j}}^2+\mathsf{E}^2\big(P_j(t)\big)\big]\mathrm{d}t \label{ODE}
\end{align}  
Řešení ODR $\eqref{ODE}$ je
\begin{equation} 
\mathsf{E}\big(P_j(t)\big)=\sigma_j\mathrm{tan}\big({\sigma_j}^3N_jt\big).
\end{equation}
Docházíme tedy k závěru, že řešení má singularitu v konečném čase.
Jelikož pro ${\big(\sigma_j}^3N_jt\big)\to\frac\pi2$ platí $\mathsf{E}\big(P_j(t)\big)\to\infty$. 
To by mohlo být interpretováno jako chování cenových bublin na trhu.
K těm dochází v případě, že investoři ve velkém měřítku investují do aktiv s nadsazenými cenami, což vede k dalšímu umělému zvyšování cen. 
Takový stav nevyhnutelně vede k nečekanému krachu ceny (tzv. prasknutí bubliny).
Problematické je takovou bublinu na trhu poznat, jelikož jsme schopni ji identifikovat až zpětně při extrémním poklesu cen, který je důsledkem mohutného odprodeje aktiv.

V další části představíme model s méně přísnými předpoklady.
Připusťme nyní možnost závislosti mezi jednotlivými aktivy, tedy nechť matice $\boldsymbol{\Sigma}$ není diagonální.
Za těchto předpokladů dosaďme vztah \eqref{mu} do SDR \eqref{SDE}, čímž obdržíme
\begin{equation*} 
 \mathrm{d}P_j(t)=P_j(t)\sum_{k=1}^{n}P_k(t)N_k(t)\sigma_{jk}\,\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}(t)\,\mathrm{d}W_k(t).
\end{equation*}
Budeme-li opět uvažovat očekávanou hodnotu  cen podkladových aktiv dostáváme vztah
\begin{equation*} 
\mathsf{E}\big( \mathrm{d}P_j(t)\big)=\mathsf{E}\left(P_j(t)\sum_{k=1}^{n}P_k(t)N_k(t)\sigma_{jk}\,\mathrm{d}t\right),
\end{equation*}
z něhož dostaneme následující soustavu obyčejných diferenciálních rovnic
\begin{align*}
\mathrm{d}\mathsf{E}\big(P_j(t)\big)&=N_j\left[\sum_{k=1}^{n}{\sigma_{jk}}^2+\mathsf{E}\big(P_j(t)\big)\sum_{k=1}^{n}\sigma_{jk}\mathsf{E}\big(P_k(t)\big)\right]\mathrm{d}t.
\end{align*}  
Avšak tato soustava je nelineární a bohužel neexistuje její analytické řešení.
Neobejdeme se tedy bez použití numerických metod.
\hrulefill 
\end{comment}

V další části představíme model s méně přísnými předpoklady.
Připusťme nyní možnost závislosti mezi jednotlivými aktivy, tedy nechť matice $\boldsymbol{\Sigma}$ není diagonální.
Zachováme předpoklad konstantnosti volatilit aktiv $\xi_{jk}$ v čase.
Za těchto předpokladů dosaďme vztah \eqref{vynos}, \eqref{vahy_mu} a \eqref{market_value} do SDR \eqref{SDE}, čímž obdržíme
\begin{equation} \label{SDE_cen}
 \mathrm{d}P_j(t)=P_j(t)\left(\frac{\sum\limits_{i=1}^n\sigma_{ji}P_i(t)N_i}{\sum\limits_{j=1}^n\sum\limits_{i=1}^n\sigma_{ji}P_i(t)N_i}\, \mu_M(t)\right)\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}\,\mathrm{d}W_k(t).
\end{equation}


%
%Často nás více než trajektorie cen podkladových aktiv zajímají očekávané hodnoty cen těchto aktiv.
%%\eqref{SDE_cen_diag}
%Vztahy pro očekávané hodnoty cen aktiv odvoďme ze soustavy SDR \eqref{SDE_cen}.
%Připomeňme, že z vlastností Wienerova procesu, uvedených v Definici \ref{WP_def}, plyne, že $\mathsf{E}\big(\mathrm{d}W_j(t)\big)=0$.
%\\
%\textcolor{red}{???Nekorelovanost $P_j(t)$ a $\mathrm{d}W_j(t)$???}
%\\
%Pak
%\begin{align*}%\label{ODE_cen_ocek}
%\mathsf{E}\big( \mathrm{d}P_j(t)\big)&	=\mathsf{E}\left(\frac{P_j^2(t)N_j}{\sum_{i=1}^n P_i(t)N_i}\, \mu_M(t)\,\mathrm{d}t+P_j(t)\sum_{k=1}^{n}\xi_{jk}\,\mathrm{d}W_k(t)\right)\\
%&=\mathsf{E}\left(\frac{P_j^2(t)N_j}{\sum_{i=1}^n P_i(t)N_i}\, \mu_M(t)\,\mathrm{d}t\right)
%\end{align*}
%Čímž se soustava stochastických diferenciálních rovnic zjednodušuje na soustavu obyčejných diferenciálních rovnic
%\\
%\textcolor{red}{???jde následující rovnice upravit na ODR???}
%\\
%\begin{align*}
%\mathrm{d}\mathsf{E}\big(P_j(t)\big)&=\mathsf{E}\left(\frac{P_j^2(t)N_j}{\sum_{i=1}^n P_i(t)N_i}\, \mu_M(t)\right)\,\mathrm{d}t.
%\end{align*}
%Avšak tato soustava je nelineární a neexistuje její analytické řešení, proto se neobejdeme bez použití numerických metod.

Model uvedený v této kapitole budeme aplikovat na reálná data.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Aplikace navrhovaného spojitého modelu na reálná data}\label{aplikace}

Data, vybraná pro stochastickou analýzu v této kapitole, byla získána ze systému Bloomberg.
Jedná se o údaje o vývoji cen akcií obchodovaných na Burze cenných papírů Praha a.s.
Pro aplikaci modelu jsme zvolili sedm akcií významných společností, které působí na českém trhu a jejichž akcie jsou obchodovatelné na Pražské burze.
Informace o vybraných společnostech a jejich označení v následujících grafech najdeme v Tabulce \ref{akcie_spolecnosti}.
\begin{comment}
    \begin{itemize}
    \item[-] ČEZ -  {(největší výrobce elektřiny v Česku)}
    \item[-] O2 -  {(český telefonní operátor ve vlastnictví PPF)}
    \item[-] KB -  {(český bankovní ústav)}
    \item[-] PM - Philip Morris ČR a.s. {(přední výrobce a prodejce cigaret v Česku)}
    \item[-] Pegas - Pegas Nonwovens s.r.o. {(přední světový výrobce netkaných textilií se sídlem v ČR)}
    \item[-] ČT -  Česká televize {(veřejnoprávní televize)}
    \item[-] NWR -  New World Resources {(přední producent černého uhlí ve střední Evropě)}
    \end{itemize}
\end{comment}
\begin{table}[!htbp]
\centering
\caption{Označení akcií, které byly vybrány do datového souboru}  \label{akcie_spolecnosti}
\vspace{5mm}
\scalebox{1}{
\begin{tabular}{l l p{6cm}} 
\hline
Označení & Název & Obor podnikání  \\
 \hline \hline
    CEZ & ČEZ, a. s.  &největší výrobce elektřiny v~České republice\\
    O2 & O2 Czech Republic, a.s.  &český telefonní operátor ve vlastnictví společnosti PPF\\
    KB & Komerční banka, a.s. &bankovní instituce působící na českém kapitálovém trhu z většiny vlastněná finanční skupinou Société Générale\\
    PM & Philip Morris ČR, a.s. &přední výrobce a prodejce cigaret v~České republice\\
    Pegas & Pegas Nonwovens, s.r.o. &přední světový výrobce netkaných textilií se sídlem  v~České republice\\
    CT &  Česká televize &veřejnoprávní televize v~České republice\\
    NWR &  New World Resources &přední producent černého uhlí ve střední Evropě\\
\hline
\end{tabular}}
\end{table}

Ceny akcií zohledněné v analýze jsou tříletá časová řada z let 2011--2014. %31.1.2011-21.2.21014
Ukázka datového souboru je uvedena v Příloze \ref{priloha_data}.
Grafy zobrazující vývoj cen akcií z datového souboru nalezneme na Obrázku \ref{model_price_of_asset}.

Model zkonstruovaný v Kapitole \ref{muj_model} využijeme pro simulace vývoje cen akcií uvažovaných společností.
Pro všechny výpočty, simulace a zobrazení grafů vytvoříme programy v prostředí \R (verze 3.3.0).
Jejich ukázky jsou uvedeny v Příloze \ref{priloha_programy}.

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/data_price_of_asset_ostatni.pdf}\\[5mm]
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/data_price_of_asset_KBPM_v2.pdf}	
  \caption{Ceny aktiv v portfoliu}  \label{model_price_of_asset}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/return_of_market_v4b.pdf}
  \caption{Model výnosnosti trhu $r(t)$}  \label{return_of_market}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/ds_price_of_asset_ostatni.pdf}\\[5mm]
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/ds_price_of_asset_KBPM_v2.pdf}	
  \caption{Model cen aktiv v portfoliu}  \label{price_of_asset}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_cez_v4.pdf}\quad
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_o2_v4.pdf}\\	
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_KB_v4.pdf}\quad
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_PM_v4.pdf}\\	
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_Pegas_v4.pdf}\quad
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_ct_v4.pdf}\\
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 0]{IMG/ds_nwr_v4.pdf}	
  \caption{Model cen aktiv v portfoliu}  \label{price_of_asset}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/ds_weight_of_asset_v5.pdf}
  \caption{Model vah aktiv v portfoliu}  \label{weight_of_asset}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/avg_CEZ_v1.pdf}
  \caption{Dvacet simulací trajektorie stochastického procesu ceny akcií (společnost ČEZ) a jejich střední hodnota}  \label{avg_trajektorie}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13.5cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v2.pdf}
  \caption{Srovnání Eulerovy numerické metody a Milsteinovy numerické metody pro simulace trajektorií stochastického procesu ceny akcií (společnost O2)}  \label{euler_milstein}
\end{figure}

\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v3_q0_5.pdf}\quad
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v3_q1.pdf}\\
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v3_q5.pdf}\quad
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v3_q10.pdf}\\
	\includegraphics[width=6.6cm, clip, trim= 0 15 25 50]{IMG/e_m_o2_v3_q50.pdf}
  \caption{Srovnání Eulerovy numerické metody a Milsteinovy numerické metody pro simulace trajektorií stochastického procesu ceny akcií (společnost O2) s různými časovými kroky $\Delta_n\in\{2; 1; 0,2; 0,1; 0,02\}$}  \label{euler_milstein_q}
\end{figure}

%%%%%%%%%%%%%%%%%%{Credit Valuation Adjustment}
%\begin{comment}
%\chapter{Credit Valuation Adjustment}
\chapter{Teorie řízení finančních rizik} \label{rizika_kap}
%riziko kolísání CVA

%Je to aktuální téma, banky jsou nuceny zohledňovat
%Pořád mi není jasné od kdy jsou banky povinné CVA počítat, nikde jsme to nenašla... ale regulace souvisí s CRR \cite{EU2013}

Nedílnou součástí řízení banky je řízení finančních rizik.
Obzvláště v poslední době se práce risk managementu dostává do popředí zájmu
a jsou patrné tendence ke sjednocování bankovní regulace na mezinárodní úrovni.
Důkazem spolupráce mezi institucemi bankovního dohledu je i vznik Basilejského výboru pro bankovní dohled.
Výbor vydává regulační standardy, doporučuje konkrétní postupy v oblasti bankovního dohledu a snaží se o sbližování regulačních norem. 
Řada států jeho doporučení zohledňuje a přijímá do vlastní legislativy a Česká republika v tomto není výjimkou.
Standardy vydávané výborem se označují Basel a byly dosud vydávány ve třech generacích označovaných jako Basel I, Basel II a Basel III. 
Vyjadřují kapitálové požadavky, zabývají se pravidly obezřetného podnikání bank a aktivitami bankovního dohledu.


Nařízení CRR (Capital Requirements Regulation) \cite{EU2013} a
směrnice CRD~IV (Capital Requirements Directive) \cite{EU2013a}
jsou výsledkem opatření pro posílení regulace bankovního sektoru promítnutých do Basel III.
%Nařízení CRR (Capital Requirements Regulation) \cite{EU2013} je přímo účinným předpisem používaným od 1. ledna 2014 (s výjimkou několika ustanovení používaným od 1. ledna 2015, resp. 2016).
%Směrnice CRD IV (Capital Requirements Directive) \cite{EU2013a}. 
%Členské státy EU měli povinnost do konce roku 2013 přijmout a zveřejnit předpisy nezbytné pro dosažení souladu s touto směrnicí. 
Nařízení CRR je přímo účinný právní předpis používaný od roku 2014, přičemž národní právní předpisy jsou upraveny tak, aby nebyly v rozporu s tímto nařízením. 
Ustanovení směrnice CRD~IV musely členské státy EU promítnout do národních předpisů do konce roku 2013.

Během celosvětové finanční krize, která vypukla v roce 2008, se ukázala důležitost správného měření a řízení kreditního rizika protistrany (CCR) pro stabilitu finančního systému.
Kapitál pro kreditní riziko protistrany byl vyžadován již v Basel I.  
V reakci na finanční krizi Basel III představil nejen další požadavky pro výpočet kapitálu pro CCR, ale nově
předepisuje kapitálový požadavek pro riziko změny Credit Valuation Adjustment (CVA). 

CVA lze interpretovat jako úpravu tržní hodnoty derivátu o kreditní riziko protistrany.
Riziko změny CVA vyplývá jak z rizika změny pravděpodobnosti selhání protistrany tak změny tržních faktorů, které ovlivňují hodnotu derivátů.
Oceňování tohoto rizika se budeme věnovat v Kapitole \ref{metodyCVA}.

%Hlavním zdrojem informací pro vznik této kapitoly byla kniha Jona Gregoryho \cite{gregory2010},
%články \cite{zhu2007} a \cite{pykhtin2010} a publikace \cite{brigo2014}.
%Pěkný přehledový článek na toto téma vyšel v roce 2012 v Journal of Financial Economics \cite{arora2012}.
%Zajímavý článek zabývající se zahrnutím Wrong-Way rizika do Monte Carlo simulace při výpočtu CVA publikovali John Hull a Alan White \cite{hull2012cva}.

%Analýza vzájemné vazby mezi rizikem a výnosy.

%\cite{eba_cva} 
%první přezkum kalibrace CVA
%32 bank se podílelo na sběru dat, popisuje přístup bank k oceňování rizika plynoucího ze změny CVA; přezkoumává konzervativní zachycení CVA rizik; vyjadřuje se k umožňení pokročilím bankám použít vlastní modely; obsahuje matematické odvození pokročilých metod výpočtu CVA 
%EBA provede do 1. ledna 2015 a poté každé dva roky přezkum s ohledem na vývoj v oblasti mezinárodní regulace, mimo jiné o potenciálních metodikách nastavení a prahů pro uplatnění požadavků CVA vůči nefinačním protistranám usazeným ve třetí zemi.
%EBA provádí sledování kapitálových požadavků k riziku úvěrové úpravy v ocenění a do 1. ledna 2015 předloží Komisi zprávu. Ve zprávě zejména posoudí:
%a) přístup k riziku CVA jakožto samostatnému požadavku ve srovnání se situací, kdy je nedílnou složkou rámce pro tržní rizika;
%b) oblast působnosti požadavku týkajícího se rizika CVA, včetně výjimky stanovené v článku 482;
%c) způsobilá zajištění;
%d) výpočet kapitálových požadavků pro riziko CVA.
%Na základě této zprávy a v případě, že z příslušných závěrů vyplývá, že je takové opatření nezbytné, je Komise rovněž zmocněna k přijetí aktu v přenesené pravomoci v souladu s článkem 462 s cílem pozměnit tyto položky

%Účetní ocenění finančních derivátů dle IFRS. IFRS 13 Přechod na tržní způsob určení CVA <- nová definice "Fair value" derivátů
%IFRS 13 přínáší novou definici fair value derivátů
%Souvicí s tím, jak banky musí účtovat hodnotu finančního derivátu. Jakou vykazují hodnotu v účetniství

%CCR je nařízení a CRD je směrnice
%Směrnice CRD IV (Capital Requirements Directive), neboli směrnice Evropského parlamentu a Rady 2013/36/EU ze dne 26. června 2013 o přístupu k činnosti úvěrových institucí a o obezřetnostním dohledu nad úvěrovými institucemi a investičními podniky, je jedním z klíčových předpisů EU, který se týká sektoru úvěrových institucí, tzn. v České republice sektoru bank a spořitelních a úvěrních družstev. Částečně také upravuje výkon činnosti nebankovních obchodníků s cennými papíry.
%Směrnice CRD IV byla uveřejněna v Úředním věstníku 27. června 2013 a je platná od 17. července 2013. Členské státy mají povinnost do 31. prosince 2013 přijmout a zveřejnit předpisy nezbytné pro dosažení souladu s touto směrnicí. Tyto předpisy mají být účinné od 1. ledna 2014.
%Nařízení CRR (Capital Requirements Regulation), neboli nařízení Evropského parlamentu a Rady (EU) č. 575/2013 ze dne 26. června 2013 o obezřetnostních požadavcích na úvěrové instituce a investiční podniky, bylo uveřejněno v Úředním věstníku 27. června 2013 a je platné od 28. června 2013. Nařízení CRR je přímo účinným předpisem, použije se od 1. ledna 2014 s výjimkou několika málo ustanovení, která se použijí od 1. ledna 2015, resp. 1. ledna 2016.
%Směrnice CRD IV i nařízení CRR jsou výsledkem opatření, která byla přijata k posílení finančního systému na úrovni skupiny G-20 v dubnu 2009 a následně rozpracována do řady opatření pro posílení regulace bankovního sektoru schválených vedoucími představiteli skupiny G-20 na pittsburském summitu v září 2009 a promítnuta do výstupů Basilejského výboru pro bankovní dohled (tzv. koncept Basel III).
%Nařízení CRR je přímo účinný právní předpis, národní právní předpisy je nutné upravit (adaptovat), aby nebyly v rozporu s tímto nařízením. Ustanovení směrnice CRD IV je nezbytné promítnout do národních předpisů (transponovat).

%\cite{EU2013} %CRR regulace pro CVA -> nařízení
%popisuje pokročilou metodu i standardizovanou metodu
%\cite{EU2013a}%CRD direktiva -> smernice

\section{Finanční rizika}
V následujícím textu seznámíme čtenáře s problematikou řízení finančních rizik, především úvěrového rizika.
Komplexní přehled o finančních rizicích poskytuje publikace  jednoho z nejznámějších českých ekonomů profesora Josefa Jílka \cite{jilek2000}.
Kniha zevrubně popisuje úvěrová, tržní a další finanční rizika a objasňuje podstatu, měření, řízení a regulace finančních rizik včetně použití derivátů.

Bankovní podnikání ohrožuje celá řada rizik, která obecně chápeme jako nebezpečí vzniku škody. 
Řídit tato rizika mimo jiné znamená odhadovat pravděpodobnost jejich vzniku a navrhovat metody k jejich snížení.
Banka je ohrožena nejen podnikatelskými riziky, ale také riziky finančními, které souvisí s její potenciální finanční ztrátou. 
Na tato rizika je soustředěna mimořádná pozornost odborné veřejnosti, bankovního dohledu, ale i samotného představenstva banky, jelikož řízení rizik má vliv na budoucí strategii podnikání banky.

Základním finančním rizikem je kreditní (též úvěrové) riziko.
Jedná se o riziko vyplývající z neschopnosti nebo neochoty protistrany splatit své závazky podle podmínek
kontraktu, což způsobí držiteli pohledávky ztrátu.
Jeho řízení má rozhodující význam pro úspěch nebo neúspěch nejen finančních institucí. 

Mezi významná bankovní rizika patří tržní riziko. 
Jedná se o riziko ztráty v souvislosti s pohybem tržních cen v důsledku nepříznivých změn tržních podmínek. 
Je zaměřeno na faktory, které mají vliv na finanční trh jako celek (nikoliv pouze na cenu jednotlivého aktiva).
Jeho význam vzrůstá s rostoucí angažovaností bank na finančních trzích. 

Úvěrové riziko a tržní riziko není možno od sebe zcela oddělovat.
Obě tato rizika v sobě spojuje kreditní riziko protistrany (více viz Kapitola \ref{CCR_kap}), jehož modelování je nedílnou součástí výpočtu Credit Valuation Adjustment. 

Dalšími finančními riziky jsou operační riziko a riziko likvidity.
Basel~II %(International Convergence of Capital Measurement and Capital Standards) 
definoval operační riziko jako riziko ztráty vyplývající z nedostatků či selhání vnitřních procesů, osob a systémů nebo vlivem vnějších událostí.
Řízení operačního rizika slouží k zajištění provozní efektivity, snížení nákladů a zvýšení konkurenceschopnosti.
Regulatorní orgány vymezují obezřetnostní požadavky na operační riziko.
Riziko likvidity je %riziko, že banka ztratí schopnost dostát svým finančním závazkům v době, kdy se stanou splatnými (bez toho aby došlo k narušení běžných činností nebo finanční kondice banky) nebo nebude moci snadno (v požadovaném čase a za obvyklou cenu) uzavřít pozici na trhu z důvodu nedostatečné hloubky nebo narušení trhu.
riziko ztráty schopnosti dostát finančním závazkům v době, kdy se stanou splatnými, nebo riziko ztráty schopnosti financovat aktiva.
Princip řízení rizika likvidity zahrnuje alokaci aktiv a pasiv do časových košů a následné určování likvidního gapu v jednotlivých časových koších. 
Těmito dvěma finančními riziky se v této práci nebudeme dále podrobněji zabývat.

\subsection{Kreditní riziko protistrany}\label{CCR_kap}
%popsat rozdíl mezi CCR a úvěrovým rizikem (viz prezentace ARM)
Counterparty Credit Risk (CCR), v překladu \textit{kreditní riziko protistrany},  představuje možnost, že banka utrpí ztrátu z derivátového obchodu nebo při financování aktiva, která bude způsobena selháním protistrany transakce. 
Kreditní riziko selhání (též defaultu) představuje základní rizikovou složkou kreditního rizika a jeho parametrem je pravděpodobnost neplnění. 
Definice selhání protistrany není zcela jednoznačná, většinou se však chápe jako stav finanční tísně, bránící ve splnění závazku.

Riziko protistrany závisí na spolehlivosti obchodního partnera, ať už se jedná o emitenta, který vydává, nabízí a prodává investiční produkt a zavazuje se k jeho splacení (resp. vyrovnání s ním spojených závazků), nebo finančního zprostředkovatele, kterému jsou svěřeny prostředky buď do správy, nebo k provedení investiční transakce.

Existují specializované společnosti nazývané ratingové agentury, které se zabývají hodnocením rizik emitentů %(států, veřejně obchodovaných společností finančních i nefinančních, soukromých firem, měst, regionálních celků apod.) 
a na jeho základě jim udělují kód vyjadřující bonitu či důvěryhodnost, tzv. \textit{rating}.
Pro investory je rating spolehlivou informací o kreditním riziku emitenta příslušného finančního instrumentu, případně finančního zprostředkovatele. 
Nejznámějšími ratingovými agenturami jsou Moody's, Standard \& Poor's a Fitch. Každá z těchto agentur má vlastní hodnotící stupnici a zvyklosti.

Obecně se ratingové stupnice dělí na dvě části -- investiční pásmo a spekulativní pásmo.
Ratingy z investičního pásma přiznávají ratingové agentury finančním instrumentům, do kterých doporučují investovat. Pod touto úrovní leží pásmo spekulativních investic, u kterých je očekáváno značné riziko ztráty.

Typickým představitelem emitenta s velmi nízkým rizikem je vláda vyspělého státu, která vydává dluhopisy, jež jsou chápány jako bezrizikové  investiční instrumenty. Nízké kreditní riziko mohou mít i velké tuzemské či mezinárodními společnosti s dobrými hospodářskými výsledky, zejména pokud mají (dle všeobecného názoru) schopný management, což vede k předpokladu dobrých výsledků a udržení pozice na trhu i v budoucnosti.
Rating je využíván také k posouzení  důvěryhodnosti finančního partnera, který danou finanční investici zprostředkovává.

Důležitým faktem při výpočtu kapitálového požadavku pro CCR je  bilaterální charakter tohoto rizika. Což znamená, že kreditním rizikem protistrany jsou zatíženy obě strany obchodu.

Velmi dobrý úvod do problematiky řízení rizika protistrany poskytuje článek \cite{canabarro2003measuring} autorů Eduarda Canabarra, vedoucího oddělení řízení rizika v bankovní společnosti Goldman Sachs, a profesora Stanfordské univerzity Darrella Duffieho.
Definují zde základní pojmy a představují modely expozice. % protistrany.

%\begin{comment}
%Rozdíl mezi kreditním rizikem protistrany
%(v derivátovém obchodu) a klasickým kreditním
%rizikem (v úvěru či jiném bankovním aktivu)
%je fakt, že v prvním případě není známá
%výše expozice v případě selhání.
%Jelikož hodnota derivátů v čase fluktuuje
%(může nabývat kladných í záporných hodnot),
%může nastat situace, kdy jste v jednom
%časovém okamžiku vystaveni ztrátě v případě
%selhání protistrany, zatímco v odlišném
%časovém okamžiku nemáte v případě selhání
%protistrany co ztratit. Naopak vaše protistrana
%může utrpět ztrátu v případě vašeho
%selhání.
%Oproti klasickému úvěrovému vztahu,
%kde je jasně definovaný dlužník a věřitel, se
%role v případě derivátových obchodů mohou
%v čase měnit. Výše expozice v momentě selhání
%protistrany není tedy jasná a je nutné
%ji nějakým způsobem stanovit či modelovat.

%Při oceňování derivátů obvykle není bráno do úvahy riziko selhání protistrany
%Cena by měla být upravena o hodnotu rizika selhání protistrany

%Účetní ocenění finančních derivátů dle IFRS.
%\end{comment}

%\section{Úvěrová úprava v ocenění finančních derivátů}
%\section{Koncept CVA}
\section{Credit Valuation Adjustment}\label{CVA_kap}
Český překlad termínu \textit{Credit Valuation Adjustment (CVA)} zatím není ustálený a můžeme se setkat s více možnostmi.
Například Evropský orgán pro bankovnictví (EBA) ve své výroční zprávě za rok 2015 \cite{eba_2015} používá výraz \textit{úprava úvěrového ocenění}.
Česká národní banka (ČNB) ve Zprávách o výkonu dohledu nad finančním trhem \cite{cnb_2015} překládá CVA jako \textit{kapitálový požadavek k riziku úvěrové úpravy ocenění}.
V jiných textech nalezneme pojem  \textit{kreditní přirážka k tržnímu ocenění} nebo \textit{úvěrová úprava v ocenění finančních derivátů}.
Z důvodu přehlednosti budeme v textu této práce používat především zkratku CVA nebo anglický termín.
%ČNB - kapitálový požadavek k riziku ztráty z titulu úvěrových úprav v ocenění
%ČNB Zprávy o výkonu dohledu nad finančním trhem - kapitálového požadavku k riziku úvěrové úpravy ocenění
%!!!!úprava reálné hodnoty derivátů o kreditní riziko protistrany
%úvěrové úpravy v ocenění - Úřední věstník Evropské unie

%se „úvěrovou úpravou v ocenění“ (credit valuation adjustment, dále jen „CVA“) rozumí úprava v ocenění portfolia transakcí s protistranou, které bylo stanoveno tržní cenou střed. Tato úprava odráží aktuální tržní hodnotu úvěrového rizika protistrany vůči instituci, ovšem neodráží aktuální tržní hodnotu úvěrového rizika instituce vůči protistraně.
%NAŘÍZENÍ EVROPSKÉHO PARLAMENTU A RADY (EU) č. 575/2013 = CRR \cite{EU2013}

%Analýza vzájemné vazby mezi rizikem a výnosy.

%\cite{eba_cva} 
%první přezkum kalibrace CVA
%32 bank se podílelo na sběru dat, popisuje přístup bank k oceňování rizika plynoucího ze změny CVA; přezkoumává konzervativní zachycení CVA rizik; vyjadřuje se k umožňení pokročilím bankám použít vlastní modely; obsahuje matematické odvození pokročilých metod výpočtu CVA 
%EBA provede do 1. ledna 2015 a poté každé dva roky přezkum s ohledem na vývoj v oblasti mezinárodní regulace, mimo jiné o potenciálních metodikách nastavení a prahů pro uplatnění požadavků CVA vůči nefinačním protistranám usazeným ve třetí zemi.
%EBA provádí sledování kapitálových požadavků k riziku úvěrové úpravy v ocenění a do 1. ledna 2015 předloží Komisi zprávu. Ve zprávě zejména posoudí:
%a) přístup k riziku CVA jakožto samostatnému požadavku ve srovnání se situací, kdy je nedílnou složkou rámce pro tržní rizika;
%b) oblast působnosti požadavku týkajícího se rizika CVA, včetně výjimky stanovené v článku 482;
%c) způsobilá zajištění;
%d) výpočet kapitálových požadavků pro riziko CVA.
%Na základě této zprávy a v případě, že z příslušných závěrů vyplývá, že je takové opatření nezbytné, je Komise rovněž zmocněna k přijetí aktu v přenesené pravomoci v souladu s článkem 462 s cílem pozměnit tyto položky

%\begin{comment}
%Od 1. ledna 2013 vstoupí v platnost nový standard mezinárodního
%finančního výkaznictví „IFRS 13 Fair Value Measurement" \cite{ifrs13}, který
%zavádí novou definici „Fair Value", tzv. reálné hodnoty. Ačkoli se
%tento pojem promítá do mnoha standardů IFRS, v tomto článku
%zůstaneme ve světě finančních nástrojů (tj. ve světě IAS 39
%a IFRS 7) a zaměříme se pouze na změny v oceňování derivátů.
%\end{comment}

%Od roku 2015 předepisuje Basel III bankám povinost počítat kapitalový požadavek pro riziko Credit Valuation Adjustment (CVA).
%Současná situace na banovním trhu vyvíjí na banky velký tlak hledat nové možnosti jak dosáhnout zisku.
%Bežné způsoby tvorby zisku v současnosti selhávají.
%Na trhu můžeme pozorovat nejen nízké až záporné úrokové sazby, ale i konkurenční boj o klienty, který přináší neustálý tlak na snižování bankovních poplatků a poskytování téměř nerentabilní klientských úvěrů.
%Banky proto hledají nové možnosti, jak snižovat náklady jako jsou například opravné položky k úvěrům klientů nebo k finančním derivátům.
%Jednou z možností může být hledání způsobu jak CVA modelovat tak, aby dodržely předepsané standardy a zároveň dosáhly co nejmešího dopadu na jejich zisk. 
%
%Banky často používají triviální parametrické modely, které jsou ale nastaveny velmi konzervativně kvůli rizikové obezřetnosti.
%Předpokládáme, že sofistikovanější model by mohl přinést nižší CVA a tudíž i nižší kapitálový požadavek pro banku. 

%\begin{comment}
%Celkový kapitálový požadavek =
%požadavek na riziko selhání protistrany
%+ požadavek na volatilitu CVA
%\end{comment}

Při oceňování finančních derivátů obvykle není bráno do úvahy riziko selhání protistrany.
Avšak mezinárodní standard finančního výkaznictví\linebreak IFRS~13 Fair Value Measurement \cite{ifrs13} ve své nejnovější verzi z roku 2013 předepisuje, že  finanční deriváty mají být oceňovány \textit{reálnou hodnotou}, která musí maximálně využívat vstupy pozorovatelné na trhu.
V důsledku toho vzniká požadavek na výpočet CVA, který má zohledňovat kreditní riziko protistrany v~účetním ocenění derivátů. % podle IFRS~13.
%CVA udává očekávanou ztrátu z daného obchodu.

S oceňováním kreditního rizika protistrany se můžeme seznámit v článku  Michaela Pykhtina a Stevena Zhu \cite{zhu2007}, kde jsou představeny přístupy k výpočtu CVA.
Podrobný přehled modelování CCR nalezneme v rozsáhlé monografii \cite{gregory2010}, kterou napsal Jon Gregory.
Tato kniha zajímavě popisuje růst vlivu kreditního rizika protistrany v průběhu finanční krize. 
Nalezneme v ní kvantifikaci úvěrové expozice stejně jako způsoby snižování rizika.

Obvykle CVA počítáme na úrovni jednotlivých protistran. 
Nicméně někdy může být užitečné stanovit, jak do CVA přispívají jednotlivé derivátové obchody. 
Michael Pykhtin a Dan Rosen v článku \cite{pykhtin2010} důkladně analyzují problematiku alokace CVA na jednotlivé derivátové obchody. 
Vysvětlují, jak lze tento problém zjednodušit na výpočet očekávané expozice protistrany plynoucí z daného obchodu v okamžiku selhání protistrany.
Určení očekávané expozice v okamžiku selhání protistrany bude stěžejní část výpočtu CVA i~v~naší práci.

Mírou úvěrové kvality protistrany je pravděpodobnost selhání protistrany. 
Při výpočtu CVA bývá tato pravděpodobnost odvozena od swapů úvěrového selhání. 
Arora, Gandhi a Longstaff v textu \cite{arora2012} zkoumají trh swapů úvěrového selhání a jeho význam při oceňování CCR.

Úvěrová expozice protistrany může korelovat s její úvěrovou kvalitou. 
Pokud je tato korelace záporná, pak se nazývá \textit{wrong-way riziko}. 
Toto riziko ve skutečnosti existuje vždy, ale obvykle se zanedbává kvůli zjednodušení modelování expozice. 
Avšak existují případy, kdy je wrong-way riziko natolik významné, že nemůže být zanedbáno. 
Takovým případem mohou být komoditní obchody s výrobcem této komodity. 
Hull a White v článku \cite{hull2012cva} představili jeden z prvních modelů zahrnujících wrong-way riziko do výpočtu CVA.

%A good introduction to pricing counter party credit risk can be found in a paper by Michael Pykhtin and Steven Zhu (2007). This paper discusses approaches to CVA calculation. Canabarro and Duffie (2003) deal with measuring counterparty risk. In their article are defined basic terms and models of counterparty exposures. A detailed review of counterparty credit risk modeling is given in (Jon Gregory, 2010). This book interestingly explains the rise of counterparty risk during the financial crisis. The quantification of credit exposure is presented as well as risk mitigation methods. 
%Under usual approaches CVA is measured at the counterparty level. Nevertheless, it can be sometimes required to determine contributions of individual trades to the CVA at the counterparty level. Pykhtin and Rosen (2010) \cite{pykhtin2010} thoroughly analyze the problem of allocating CVA to the individual trades. They explain how this problem can be simplified to calculating contributions of the trades to the expected exposure of the each counterparty where the expected exposure is conditioned by the default of counterparty.
%A measure of credit quality of a counterparty is default probability. The counterparty's probability of default is typically derived from credit default swaps (CDS). Arora, Gandhi and Longstaff (2012) \cite{arora2012} examine the credit default swaps market and his relevance in counterparty credit risk pricing.
%The counterparty credit exposures may be correlated with the credit quality of a counterparty.  If this correlation is negative then it is called wrong way risk. In actual fact, risk from correlation occurs always, however it is usually ignored to simplify modeling of exposure. Nevertheless, there exist cases when wrong way risk is too significant to be ignored. This case may be commodity trades with a producer of that commodity. Hull and White (2012) \cite{hull2012cva} introduced one of the first models of wrong way risk in CVA calculations.

%Hlavním zdrojem informací pro vznik této kapitoly byla kniha Jona Gregoryho \cite{gregory2010},
%články \cite{zhu2007} a \cite{pykhtin2010} a publikace \cite{brigo2014}.
%Pěkný přehledový článek na toto téma vyšel v roce 2012 v Journal of Financial Economics \cite{arora2012}.
%Zajímavý článek zabývající se zahrnutím Wrong-Way rizika do Monte Carlo simulace při výpočtu CVA publikovali John Hull a Alan White \cite{hull2012cva}.

\section{Metodika výpočtu CVA} \label{metodyCVA}
CVA představuje odhad možných budoucích ztrát z derivátového obchodu v průběhu života derivátu až do jeho splatnosti.
Vztah pro výpočet CVA vychází ze známé formule pro výpočet očekávané úvěrové ztráty (podrobněji se s ní budeme zabývat v Kapitole \ref{srovnani_metod_cva}).
\begin{definice}\label{cva_def}
 \textit{Credit valuation adjustment} je definován jako
 \begin{equation} \label{CVA}
 CVA=(1-R)\int_{0}^T \hat{e}_d(t)\,\mathrm{d} PD(t),
\end{equation}
 kde $R$ je míra návratnosti, $\hat{e}_d(t)$ je diskontovaná očekávaná expozice v~čase~$t$, $PD(t)$ je pravděpodobnost selhání protistrany před časem~$t$
a $T$ označuje splatnost kontraktu s nejdelší splatností v uvažovaném portfoliu. 
\end{definice}
Jednotlivé komponenty CVA ze vztahu \eqref{CVA} budeme podrobněji specifikovat v následujícím textu.

\subsection{Expozice protistrany}\label{exposure_kap}
\textit{Expozici protistrany} v čase $t$ značíme $E(t)$ a definujeme jako celkovou výši nesplacených pohledávek danou protistranou.
%Expozice kvantifikuje potenciální ekonomickou ztrátu v případě selhání protistrany.
Hodnota expozice protistrany kvantifikuje do jaké míry je věřitel vystaven riziku ztráty v případě neplnění dlužníka.
Na rozdíl od standardního úvěrovému vztahu, ve kterém je jasně dané, kdo je dlužník a kdo je věřitel, se v případě derivátových obchodů mohou jejich role měnit v čase.
Hodnota derivátů v čase kolísá a může nabývat kladných i záporných hodnot.
Proto může nastat situace, kdy v jednom časovém okamžiku je banka vystavena ztrátě v případě selhání protistrany, zatímco v jiném časovém okamžiku nemá banka co ztratit, pokud její protistrana selže.
Navíc protistrana banky může utrpět ztrátu v případě selhání banky.
Tento jev zcela zásadně ovlivňuje výši expozice v okamžiku selhání protistrany.

Uvažujme portfolio $N$ derivátových obchodů banky s danou protistranou.
%Splatnost kontraktu s nejdelší splatností v tomto portfoliu označíme $T$. 
%Nechť $\tau$ je náhodná veličina, která označuje čas selhání dané protistrany a má známou distribuční funkci $PD(t)=\Pr(\tau\leq t)$.
Budeme zkoumat hodnotu portfolia z pohledu banky.
Expozice protistrany $E(t)$ v čase $t$ je dána hodnotami derivátových odchodů s danou protistranou v čase $t$.
Hodnotu $i$-tého derivátu z portfolia v čase $t$  označíme $V_i(t)$.
Pak hodnota portfolia v čase $t$ je definována jako
\begin{equation}
V(t)=\sum_{i=1}^N V_i(t).
\end{equation}
V případě, že banka nemá s protistranou uzavřenou dohodu o vzájemném započítávání pohledávek a závazků (tzv. netting), expozice protistrany $E(t)$ je 
\begin{equation}\label{exp_vztah}
E(t)=\sum_{i=1}^N\max\{V_i(t),0\}.
\end{equation}
Pokud banka s protistranou uzavře smlouvu o nettingu, pak je expozice dána jako
\begin{equation}\label{exp_vztah_net}
E(t)=\max\{V(t),0\}.
\end{equation}
Využívání nettingu slouží ke snížení úvěrového a tržního rizika. 
Při použití nettingu je expozice protistrany menší nebo rovna expozici v případě, kdy netting neuvažujeme. 

Další možnost jak snížit expozici je zajištění.
Banka uzavírá s protistranou dohodu o výzvě k doplnění zajištění (tzv. margin call).
Protistrana pak musí poskytnout bance zajištění vždy, když hodnota portfolia překročí určenou mez.
Naopak pokud hodnota portfolia klesne pod tuto mez, banka zajištění opět vrátí.
Expozice protistrany, která zohledňuje zajištění se určí jako
\begin{equation}\label{expozice_vztah}
E(t)=\max\{V(t)-C(t),0\},
\end{equation}
kde $C(t)$ je hodnota zajištění (které banka přijala) v čase $t$.  
Ve vztahu \eqref{expozice_vztah} opět zohledňujeme netting.

Expozice protistrany v okamžiku jejího selhání (EAD) se běžně značí $EAD$.
Kvůli snadnějšímu a přehlednějšímu zápisu budeme v rovnicích a formulích používat také označení $e(t)$, kde $t$ je okamžik selhání protistrany.
EAD můžeme chápat jako náhodnou veličinu.
Tudíž očekávanou expozici v okamžiku selhání protistrany definujeme jako střední hodnotu EAD. Použijeme pro ni označení $\hat{e}(t)$.
Platí
\begin{equation}
\hat{e}(t)=\mathsf{E}[e(t)].
\end{equation}

%Exposure at default (EAD) is the total value that a bank is exposed to a counterparty at the time of default. 
%For simplification, in the follow equations, we define EAD as e(t), where t is the time of the default. 
%The EAD may be seen as a random variable. Therefore, an expected exposure at default is defined as the mean value of the EAD and it is denoted as e ̂(t).

%\begin{comment}
%Metody výpočtu derivátové expozice:
%První dvě metody stanovení výše expozice
%může banka zvolit podle svého uvážení.
%Jde o metodu tržního ocenění (v originále
%Current Exposure Method) a standardizovanou
%metodu (neboli Standardized Method).
%Pro použití nejsofistikovanější metody
%založené na vlastním modelu, takzvanou
%I MM (Internal Model Method), je nutné
%získat povolení regulátora a splnit několik
%požadavků. Mezi ně patří zpětná validace
%modelu a také zahrnutí rizika pozitivní
%korelace (Wrong-way risk). Riziko pozitivní
%korelace nastává v případě, že dochází
%zároveň k růstu výše expozice vůči protistraně
%a poklesu kreditní kvality protistrany
%či snížení hodnoty zajištění. Odměnou
%za použití metody I MM by mělo být snížení
%expozice - a tudíž nižší kapitálový
%požadavek.
%\end{comment}

%Výpočet dnešní hodnoty při tržní úrokové míře
%Diskontování je matematický postup, kdy jsou přepočítány (diskontovány) budoucí výnosy na současnou hodnotu investice s použitím diskontní míry.
%Diskontní míra je procentní sazba, kterou se diskontuje budoucí hodnota na současnou hodnotu.
%Diskontovaná hodnota je současná hodnota. Je to jedna z metod hodnocení investic, kdy se budoucí výnosy převádějí na hodnotu, kterou by měly dnes.
%Diskontování je postup, kdy jsou přepočteny (diskontovány) budoucí výnosy v jednotlivých obdobích na současnou hodnotu a sečteny s použitím diskontní míry (obvyklá výnosová míra).

%Discounting is a financial mechanism in which a future value is being recalculated to the present value.
%The discount factor, $D(t)$, is the factor by which a future cash flow must be multiplied in order to obtain the present value.
%Consider the discount factor at time $t$% (for maturity $T$)
%, defined as 
%nemělo by T být spíš doba defaultu?

Při výpočtu očekávané ztráty z pohledávky je nutné očekávanou EAD diskontovat, abychom určili současnou hodnotu očekávané EAD. 
Uvažujme diskontní faktor, který vychází ze vztahu \eqref{diskontni_faktor}, ale budeme předpokládat stochastické chování úrokové míry.
Proto pro diskontování použijeme okamžitou úrokovou míru.
Diskontní faktor $D(t)$ definujeme jako
\begin{equation}\label{diskont_vztah}
%D(t)=\mathrm{e}^{-r(t)\cdot t},
D(t)=\mathrm{e}^{-\int_0^t r(s)\,\mathrm{d} s},
\end{equation}
kde $r(t)$ je okamžitá úroková míra. 
%Diskontní faktor \eqref{diskont_vztah} je odvozen ze vztahu \eqref{risk-free_asset_model} pro cenu bezrizikového aktiva. 
%spojité diskontování se v praxi napoužívá, ale usnaňuje výpočty
%Hence, the discounted expected exposure at time $t$ conditional on the counterparty default at time $t$ is given by 
Dostáváme vztah pro diskontovanou očekávanou expozici v okamžiku selhání protistrany
\begin{equation}\label{dis_exposure_vztah}
\hat{e}_d(t)=\mathsf{E}[D(t) e(t)].
\end{equation}

\subsection{Pravděpodobnost selhání}
%\textit{Pravděpodobnost selhání (PD)}, anglicky Probability of Default, udává s jakou pravděpodobností dojde k selhání klienta během jednoho roku.
\textit{Pravděpodobnost selhání}, anglicky Probability of Default (PD), poskytuje odhad pravděpodobnosti, že dlužník nebude schopen plnit své závazky.
PD je klíčový parametr používaný při výpočtu očekávané úvěrové ztráty.
Je důležité uvědomovat si v jakém časovém horizontu PD uvažujeme.
Například, když vstupuje PD jako parametr pro výpočet regulatorního kapitálu podle Basel~II, bere se v úvahu pravděpodobnost selhání během jednoho roku.
Do vztahu \eqref{CVA} pravděpodobnost selhání vstupuje jako funkce času daná následující definicí. %$PD(t)=\Pr(\tau\leq t)$, kde $\tau$ je čas selhání uvažované protistrany.
%Nechť $\tau$ je náhodná veličina, která označuje čas selhání dané protistrany a má známou distribuční funkci PD(t)=\Pr(\tau\leq t).
\begin{definice}\label{pd_def}
Nechť $\tau$ je náhodná veličina, která označuje čas selhání dané protistrany.
Její distribuční funkci označíme $PD(t)$ a platí
\begin{equation}
PD(t)=\Pr(\tau\leq t).
\end{equation}
$PD(t)$ udává \textit{pravděpodobnost selhání protistrany} před časem~$t$.
\end{definice}

Při výpočtu CVA se pro odhad PD protistrany často používá metoda, která pracuje s tržní hodnotou swapů úvěrového selhání (CDS).
CDS jsou finanční deriváty, které slouží k přenosu úvěrového rizika (plynoucího z podkladového aktiva) z kupujícího na prodávajícího.
Za úplatu se prodávající CDS zavazuje uhradit kupujícímu ztrátu, která vznikne v případě selhání podkladového aktiva.
CDS většinou slouží jako kreditní zajištění.

Na českém trhu se oproti zahraničí s CDS obchoduje méně, můžeme proto často narazit na problém, že pro konkrétní protistranu nebude CDS existovat.
Další možností jak určit PD protistrany je využití externího ratingu, který přidělují ratingové agentury (což už jsme zmínili v Kapitole \ref{CCR_kap}).
Avšak externí rating získají pouze velké a renomované společnosti, a proto tuto metodu často také nemůžeme použít.
%Navíc ratingové agentury pro výpočet PD používají až příliš dlouhou historii, což může značně zkreslovat prospektivní informace.

Většina bank používá k odhadu PD interní ratingové modely, které jsou založeny na historických datech o splácení klientů.
Výstupem těchto modelů je pravděpodobnost selhání klienta během jednoho roku.
 

%\begin{comment}
%Pokud tedy například pro danou
%protistranu neexistuje přímo kótované
%CDS (Credit Default Swap), měli bychom se
%pokusit o odvození kreditního spreadu protistrany
%z jiných tržních informací (kótovaný
%dluhopis protistrany, CDS index, CDS spread
%podobné protistrany či protistran ze stejného
%sektoru, se stejným úvěrovým ratingem
%a podobně).
%\end{commenr}


%\begin{comment}
%Je důležité upozornit, že CVA i DVA představují
%odhady možných budoucích ztrát
%na dvou stranách derivátu v průběhu jeho života
%až do splatnosti, nejsou to odhady ztrát
%pouze z aktuální hodnoty derivátu. Proto
%i při kladné hodnotě derivátu může obecně
%existovat kromě CVA i DVA, stejně jako při
%záporné hodnotě může kromě DVA banka
%vykazovat i CVA.
%\end{comment}

\subsection{Loss Given Default}
Další člen ve výpočtu CVA \eqref{CVA} je Loss Given Default (LGD), neboli \textit{ztrátovost ze selhání}.
Jedná se o poměr ztráty z úvěrové expozice, kterou věřitel utrpí v případě selhání dlužníka, vzhledem k expozici protistrany v okamžiku selhání. 
Lze se také setkat s pojmem míra ztráty při (ze) selhání.

V případě selhání protistrany se věřiteli obvykle podaří získat zpět určitou část z dlužné částky v rámci procesu vymáhání či prodeje zajištění. 
Vyjádříme-li tuto část jako poměr k EAD nazývá se míra návratnosti.
\begin{definice}\label{rr_def}
\textit{Míra návratnosti (recovery rate)} je očekávaná míra splacení pohledávky v případě selhání protistrany.
Budeme ji značit $R$ a platí
\begin{equation}\label{recovery_rate}
R=1-LGD,
\end{equation}
kde $LGD$  je míra ztráty při selhání protistrany.
\end{definice}

%\subsection{Modely zajištění}

%\section{Poznámky CVA}

%odhad parametrů – proces hledání hodnot parametrů, které vedou k co nejlepší shodě výsledků modelu s měřenými daty pomocí některé ze statistických metod 
%kalibrace – totéž jako odhad parametrů, ale ne nezbytně pomocí statistických metod

%Čím horší je bonita klienta .... viz GoogleDisk

%\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Aplikace výpočtu CVA na reálná data}\label{aplikaceCVA_kap}
%The numerical illustration of the calculation of CVA will be introduced in this section. 
%We work with data set of interest rate swaps from the year 2015.
%An \textit{interest rate swap (IRS)} is an agreement between two parties to exchange a interest rate cash flows on specified intervals and over a certain period of time. 
%These data come from a bank operating in the Czech Republic. 
%The data contains information about five vanilla interest rate swaps and each of them is associated with different counterparty. \textcolor{red}{Asi by to chtělo více informací o datech.}

Metodiku výpočtu CVA uvedenou v Kapitole \ref{metodyCVA} budeme aplikovat v této kapitole. 
Naším cílem je spočítat CVA pro zvolené finanční deriváty a graficky znázornit komponenty vstupující do výpočtu.
K výpočtům a tvorbě grafů použijeme prostředí \MATLAB R2014b.

Data pro analýzu pochází od banky působící v České republice (dále jen Banka) a obsahují informace o části jejího portfolia finančních derivátů.
Tato část portfolia obsahuje pět úrokových swapů, z nichž každý je uzavřen s~jinou protistranou.
Banka je ve všech pěti případech v pozici prodávajícího (pro bližší vysvětlení této pozice viz Kapitola \ref{swap_kap}).
V Tabulce \ref{variable} uvádíme přehled proměnných získaných z~datového souboru, které budeme využívat při výpočtu CVA.
Datový soubor ani informace o protistranách nebudeme zveřejňovat.

%\begin{table}[!htbp]
%\centering
%\caption{Variables in a data set}  \label{variable}
%\scalebox{1}{
%\begin{tabular}{l l} 
%\hline
%Notation & Name of Variable  \\
% \hline \hline
%ID &Counterparty ID\\
%principal &Principal of swap \\
%maturity & Maturity date of swap  \\
%LegRateReceiving & Interest rate received by bank\\
%LegRatePaying & Interest rate paid by bank\\
%period & Period of paying\\
%\hline
%\end{tabular}}
%\end{table}

\begin{table}[!htbp]
\centering
\caption{Proměnné v datovém souboru}  \label{variable}
\vspace{5mm}
\scalebox{1}{
\begin{tabular}{l l} 
\hline
Označení & Název proměnné  \\
 \hline \hline
counterpartyID & identifikační číslo protistrany\\
rating & rating protistrany \\
nettingID & identifikace protistrany smlouvy o nettingu \\
principal & nominální hodnota IRS \\
maturity & datum splatnosti IRS  \\
LegRateReceiving & úroková sazba přijímaná bankou\\
LegRatePaying & úroková sazba placená bankou\\
period & úrokové období\\ %na konci každého úrokového období dochází k vypořádání
\hline
\end{tabular}}
\end{table}

\subsection{Úrokový swap}\label{swap_kap}
V praktické ukázce výpočtu CVA na reálných datech používáme data o úrokových swapech.
Proto v následující části práce stručně vysvětlíme principy tohoto finančního derivátu.

\textit{Úrokový swap (IRS)} je finanční derivát sloužící k zajištění rizika plynoucího ze změny úrokových sazeb. 
Jedná se o smluvní dohodu dvou stran vyměnit si úrokové závazky v různých sazbách vztahující se ke stejné nominální hodnotě. 
Zpravidla se přitom jedná o výměnu fixní platby úroků za variabilní. 
Při vyrovnání obchodu dochází pouze k výměně úroků, avšak nikoli k výměně nominální hodnoty.
Podle tržních konvencí se strana, která v~rámci IRS kontraktu platí pevné úroky (a přijímá variabilní úroky) nazývá \textit{kupující (payer)} a strana, která přijímá pevné úroky (a platí variabilní úroky) se nazývá \textit{prodávající (receiver)}. 
Tento vztah demonstruje Obrázek \ref{IRS_obr}.
% By market convention, the counterparty paying the fixed rate is the "payer" (while receiving the floating rate), and the counterparty receiving the fixed rate is the "receiver" (while paying the floating rate).

%\begin{figure}[!htbp]
%  \centering 
%	\includegraphics[width=10cm, clip, trim= 0 250 0 170]{IMG/IRS.pdf}
%  \caption{Grafické znázornění vztahu mezi prodávajícím a kupujícím úrokového swapu. V tomto případě je Banka prodávající (receiver) a její protistrana je kupující (payer).}  \label{IRS_obr}
%\end{figure}
\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=10cm, clip, trim= 0 250 0 170]{IMG/IRS2.pdf}
  \caption{Grafické znázornění vztahu mezi prodávajícím a kupujícím úrokového swapu.}  \label{IRS_obr}
\end{figure}

Pevná úroková sazba (fixed rate) je stanovena při uzavření IRS smlouvy a zůstává nezměněna v průběhu celého trvání smlouvy. 
Na druhé straně variabilní úroková sazba (floating rate) se odvozuje od referenční úrokové sazby na trhu mezibankovních depozit a může se v průběhu života IRS měnit.
V naší analýze používáme  jako referenční sazbu Prague InterBank Offered Rate (PRIBOR).
PRIBOR je průměrná úroková sazba, za kterou jsou banky ochotny si navzájem půjčovat na českém mezibankovním trhu likviditu.
%IRS splňuje vlastnosti finančního derivátu jehož podkladovým aktivem je úroková sazba.

%IRS is an agreement between two traders as defined in Ševčovič et al. (2011). Consider plain vanilla IRS. Under this contract, party A commits to paying party B the fixed interest rate from the defined amount, the so-called principal amount or notional value. Party B is committed to paying to party A a floating interest rate. Party A is called the payer and party B the receiver.
%The fixed rate of the IRS is determined at the beginning of the swap contract and remains unchanged during the life of the contract. On the other side, the floating rate may vary over time and is often dependent on a reference rate that gives the floating rate at every certain period of time. In our analysis, we use the Prague Inter Bank Offered Rate (PRIBOR) as the reference rate. 
%The valuation of the IRS is tied to the evolution of the interest rate. Therefore, in the next section, we briefly refer to the Hull-White interest rate evolution model. 

\subsection{Počáteční výnosová křivka}\label{vynosova_krivka_kap}
%We start our analysis by creating a discount curve that is important for evaluating the swaps.
Na začátku naší analýzy vytvoříme výnosovou křivku, kterou budeme používat při modelování úrokové míry pomocí Hull-Whitova modelu. %při oceňování úrokových swapů.
Tato křivka bude vstupovat do modelu prostřednictvím parametru $\theta(t)$. 
Simulaci úrokové míry následně využijeme při oceňování úrokových swapů. %při výpočtu expozice protistran.

%%Příliš krátké sazby však vykazují určité anomálie (poměrně dlouhá období relativně stabilních sazeb střídají silné skokové pohyby jako důsledek externích šoků v podobě zásahů centrální banky)
%In order to evaluate the swaps, is necessary to describe a discount curve. The initial discount curve can be obtain by a linear interpolation of the risk free interest rates of different maturities. The initial rates were found at the web page of PATRIA (\href{URL}{http://www.patria.cz/kurzy/CZK/5Y/irs/graf.html}) and we can see them in the Table \ref{rates}.% \textcolor{red}{dát sem odkaz na stránku, Leni?} 
%The interest rate shorter than one year were extracted from PRIBOR rates on October 30th, 2015. 
%The Picture \ref{YieldCurve} shows the initial yield curve at settlement date which was built from the initial rates in the Table \ref{rates}.
Pro konstrukci výnosových křivek existuje několik metod.
Některé využívají data o výnosech bezkupónových dluhopisů, jiné sazby PRIBOR nebo tržní hodnoty IRS.
V naší analýze jsme zvolili rozšířenou metodu, kterou využívá i Banka. 
Pro krátkodobé úrokové míry odvodíme výnosovou křivku ze sazeb PRIBOR a pro dlouhodobé úrokové míry využijeme hodnot IRS na trhu.
Tento přístup, kdy kombinujeme sazby PRIBOR a tržní hodnoty IRS, je vynucen skutečností, že PRIBOR sazby jsou dostupné jen pro splatnosti 1 den, 1, 2 týdny, 1, 2, 3, 6, 9 měsíců a 1 rok, 
naproti tomu jsou na trhu obchodovány IRS pouze se splatnostmi 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15 a 20 let.
Data jsme čerpali z webových stránek Patria online a terminálu Bloomberg a jsou uvedeny v Tabulce \ref{rates}.
První dvě číselné hodnoty jsou tříměsíční sazba PRIBOR a šestiměsíční sazba PRIBOR. 
Následující čísla jsou postupně hodnoty ročních IRS, dvouletých IRS, atd. až dvacetiletých IRS. 
%Pro analýzu vývoje trendu krátkodobých sazeb konstruuje výnosovou křivku sazeb PRIBOR. Dále ČNB sleduje i vývoj dlouhodobých úrokových sazeb s pomocí IRS (interest rate swap) a výnosů dluhopisů.
%hojně využívaným způsobem je konstrukce ze swapů
\begin{table}%[!htbp]
  \centering 
\caption{Počáteční úrokové míry}%\caption{Initial rates} 
\label{rates}
\vspace{5mm}
\scalebox{1}{\begin{tabular}{|c |c|}
\hline
\textbf{splatnost (v letech)} &\textbf{úroková míra (\%)}\\ 
\hline
0,25 & 0,29 \\% 0,14  \\ 
0,5 & 0,37 \\% 0,16  \\
1 & 0,21 \\
2& 0,25\\
3&0,28\\
4&0,33\\
5&0,40\\
6&0,47\\
7&0,56\\
8&0,65\\
9&0,75\\
10&0,83\\
12&0,99\\
15&1,16\\
20&1,27\\
\hline
\end{tabular}}
\end{table}
Obrázek \ref{YieldCurve} zobrazuje počáteční výnosovou křivku, kterou budeme dále používat v simulacích.

\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 125 280 110 270]{IMG/YieldCurveN.pdf}
	\includegraphics[width=13cm, clip, trim= 110 260 110 270]{IMG/Vynosova_krivka.pdf}
  \caption{Počáteční výnosová křivka.}  \label{YieldCurve}
\end{figure}

\subsection{Simulace úrokových měr a oceňování IRS}\label{simulace_kap}
Při oceňování IRS budeme používat Monte Carlo simulace.
Pro další informace o této metodě odkazujeme na klasickou monografii Johna Hammersleyho \cite{hammersley2013monte} nebo rozsáhlou publikaci Reuvena Rubinsteina a Dirka Kroese \cite{rubinstein2016simulation}, která byla v loňském roce aktualizována.
IRS jsou deriváty úrokové míry a tudíž pro určení jejich tržní hodnoty budeme muset nejdřív modelovat hodnotu úrokové míry.

%The interest rate simulation is based on historical data of the three month PRIBOR rate, from 2. 1. 2014 to 24. 11. 2015.  
%The development of three month PRIBOR rate can be observed in the figure \ref{PRIBOR}.

Variabilní úroková sazba IRS v našem datovém souboru je odvozena z tříměsíční sazby PRIBOR.
Proto jsme se rozhodli využít historická data o této sazbě pro kalibraci modelu úrokových měr.
Vývoj tříměsíční sazby PRIBOR můžeme vidět na Obrázku \ref{PRIBOR}.

\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 110 280 110 270]{IMG/PRIBOR.pdf}
	\includegraphics[width=13cm, clip, trim= 110 260 110 270]{IMG/PRIBOR_cz.pdf}
  \caption{Vývoj tříměsíční PRIBOR úrokové sazby.}  \label{PRIBOR}
\end{figure}

%Provedeme tisíc simulací a každou simulaci modelujeme Hull-Whitovým modelem.
Pro modelování úrokové míry budeme používat Hull-Whitův jednofaktorový model představený v Kapitole \ref{H-W_model_kap}.
Nejdříve odhadneme parametry $\alpha$ a $\sigma$ z historických dat tříměsíční sazby PRIBOR za použití \MATLAB funkce \verb+regress+ (viz Příloha \ref{priloha_programy}).
Parametr $\theta(t)$ konkrétně určovat nemusíme, jelikož jeho roli v modelu při výpočtu v \MATLAB zastoupí počáteční výnosová křivka.

Chování hodnoty okamžité úrokové míry je popsáno rovnicí~\eqref{H-W_model}.
K~simulování vývoje její hodnoty v \MATLAB využíváme funkci \verb+HullWhite1F+, jejímiž parametry jsou koeficienty $\alpha$ a $\sigma$ z Hull-Whitova modelu a hodnoty počáteční výnosové křivky z Tabulky \ref{rates}.  
%Parametry modelu $\alpha$ a $\sigma$ odhadneme z historických dat tříměsíční sazby PRIBOR za použití \MATLAB funkce \verb+regress+. %($\alpha=0,0208$ a $\sigma=0,015$).
Okamžité úrokové míry dané modelem rozšíříme na celé výnosové křivky s využitím rovnice \eqref{H-W_vynosova_krivka}.
%The constant reversion speed $\alpha$ and constant $\sigma$ are extracted from the historical three month PRIBOR rates.
%We use equation \eqref{H-W_model} to simulated the short interest rates.  
%We can expand the entire interest rate curve from the short rate using formula \eqref{H-W_vynosova_krivka}.
%\begin{eqnarray}
%R(t,T)&=&-\frac{1}{T-t}\ln A(t,T)+\frac{1}{T-t}B(t,T)r(t)\\
%%P(t,T)&=&A(t,T)\mathrm{e}^{-B(t,T)r(t)}\\
%\ln A(t,T)&=&\ln \frac{P(0,T)}{P(0,t)}+B(t,T)F(0,t)-\frac{1}{4\alpha^3}\sigma^2(\mathrm{e}^{-\alpha T}-\mathrm{e}^{-\alpha t})^2(\mathrm{e}^{2\alpha t}-1)  \nonumber\\
%B(t,T)&=&\frac{1-\mathrm{e}^{-\alpha(T-t)}}{\alpha}.\nonumber
%\end{eqnarray}
%The large number of simulations was made. 
%The example of yield surfaces obtained in one interest rate simulation is possible to observe in the Figure \ref{YieldCurveEvolution}.
Příklad jednoho z možných scénářů vývoje celé časové struktury úrokové míry ukazuje trojrozměrný plošný graf na Obrázku~\ref{YieldCurveEvolution}.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 90 270 110 270]{IMG/YieldCurveEvolution1N.pdf}
	\includegraphics[width=13cm, clip, trim= 90 270 110 270]{IMG/3D_mira.pdf}
%  \caption{ One Possible Scenario of Yield Curve Evolution}  \label{YieldCurveEvolution}
     \caption{Jeden z možných scénářů pro vývoj výnosové křivky.}  \label{YieldCurveEvolution}
\end{figure}

%For each scenarios the swaps are priced at each future simulation date. 
%The main advantage of the Hull-White model is that it can be fitted exactly to the initial term structure of interest rates.
Provedeme tisíc takových simulací 
a pro každý scénář vypočítáme tržní hodnoty IRS v každém datu simulace v budoucnosti.
Pro oceňování IRS\linebreak v jednotlivých datech simulace je v \MATLAB naprogramovaná funkce\linebreak \verb+hcomputeMTMValues+, která při spuštění volá funkci \verb+hswapapprox+. 
Tato funkce pro určení tržní hodnoty IRS využívá aproximace. %, proto není vhodné její použití v případě, kdy potřebujeme přesnou hodnotu.  
%Nicméně při výpočtu CVA je tento postup běžně využíván, jelikož zkreslení výsledků není významné a~použití aproximace zásadně zvyšuje výkonost výpočtu. 
Nicméně při výpočtu CVA je tento postup běžně využíván, jelikož použití aproximace zásadně zvyšuje výkonost výpočtu, kterou  Monte Carlo simulace vyžadují.  
%K tomu budeme využívat v \MATLAB funkci \verb+hcomputeMTMValues+, která je založena na funkci \verb+hswapapprox+.
%Při výpočtu CVA je běžné oceňovat IRS pomocí aproximace místo ocenění přesně.  
Výstupem oceňovací funkce je trojrozměrná matice, která obsahuje tržní hodnoty pro každý uvažovaný IRS v každém datu simulace a pro každý scénář. 
Na Obrázku~\ref{SwapPrice} vidíme jeden z možných scénářů vývoje tržní hodnoty pěti úrokových swapů z datového souboru.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 90 270 110 270]{IMG/SwapPrice1.pdf}
	\includegraphics[width=13cm, clip, trim= 90 270 110 270]{IMG/Trzni_hodnota.pdf}
     \caption{Jeden z možných scénářů pro vývoj tržní hodnoty pěti úrokových swapů z datového souboru.}  \label{SwapPrice}
\end{figure}

Vzhledem k předpokladu neexistence arbitráže je hodnota IRS v době uzavření kontraktu nulová. 
Během každého simulovaného scénáře hodnota IRS roste nebo klesá v závislosti na změně časové struktury úrokové míry.
Jak se blíží doba maturity IRS, přibližuje se jeho hodnota k nule, protože součet hodnot všech zbývajících očekávaných budoucích peněžních toků (plynoucích ze smluvní dohody) klesá.   
Graf hodnot úrokových swapů na Obrázku~\ref{SwapPrice} začíná v datu 30. října 2015, ke kterému máme k dispozici data, budoucí hodnoty swapů simulujeme.
Protože smlouvy byly uzavřeny již dříve, tak na začátku simulovaného období není hodnota swapů nulová.
IRS protistrany 3 (žlutá křivka) a protistrany 4 (fialová křivka) mají splatnost už v roce 2016, proto je jejich odhadovaná tržní hodnota velmi nízká a na grafu se pohybuje v blízkosti osy x.

Sečteme-li pro daný scénář hodnoty všech uvažovaných IRS v každém datu simulace, dostaneme vývoj hodnoty celého portfolia.
Celkové hodnoty portfolia pro všechny scénáře naší simulace zobrazuje Obrázek \ref{TotalPortfoioValue}.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 100 270 110 270]{IMG/TotalPortfoioValue.pdf}
	\includegraphics[width=13cm, clip, trim= 100 270 110 270]{IMG/Hodnota_portfolia.pdf}
  \caption{Ukázka simulací tržní hodnoty uvažovaného portfolia pěti úrokových swapů.}  \label{TotalPortfoioValue}
\end{figure}

Dalším krokem je výpočet expozice protistrany definované v Kapitole~\ref{exposure_kap}.
V \MATLAB pro tento výpočet využijeme funkci \verb+creditexposures+.
Přímo v~datovém souboru je proměnná, která umožňuje zohlednit při výpočtu expozice netting.
Funkce \verb+creditexposures+ umožňuje výpočet expozice jak v~případě, že je uzavřena smlouva o nettingu dle vztahu \eqref{exp_vztah_net}, tak v případě neexistence nettingové smlouvy, viz vztah \eqref{exp_vztah}.
Stejně jako při určení hodnoty celého portfolia získáme expozici celého portfolia součtem expozic všech protistran v jednotlivých datech simulace.
Celkovou expozici portfolia pro každý scénář v naší simulaci můžeme pozorovat na Obrázku \ref{PorfolioExposure}.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 110 270 110 270]{IMG/PorfolioExposure.pdf}
	\includegraphics[width=13cm, clip, trim= 110 270 110 270]{IMG/Expozice_portfolia.pdf}
  \caption{Ukázka simulací expozice uvažovaného portfolia pěti úrokových swapů.}  \label{PorfolioExposure}
\end{figure}

Očekávanou expozici protistrany jsme definovali v Kapitole~\ref{exposure_kap} jako střední hodnotu expozice protistrany.
Pro výpočet očekávané expozice použijeme \MATLAB funkci \verb+exposureprofiles+, která ji určí jako průměrnou hodnotu všech expozic protistrany ze všech simulovaných scénářů.

Na závěr spočítáme diskontovanou očekávanou expozici protistrany danou vztahem \eqref{dis_exposure_vztah}.
Nejdříve diskontujeme expozici protistrany v každém simulovaném scénáři a následně opět použijeme funkci \verb+exposureprofiles+ pro určení očekávané hodnoty.
Diskontní faktory pro každý scénář určíme ze simulovaných okamžitých úrokových sazeb. 
Graf diskontované expozice uvažovaného portfolia vidíme na Obrázku \ref{DiscountExposure}.
\begin{figure}[!htbp]
  \centering 
	\includegraphics[width=13cm, clip, trim= 110 270 110 270]{IMG/Diskontovana_expozice.pdf}
  \caption{Ukázka simulace diskontované expozice uvažovaného portfolia pěti úrokových swapů.}  \label{DiscountExposure}
\end{figure}

\subsection{Funkce pravděpodobnosti selhání protistrany}\label{funkce_PD_kap}
Pro výpočet CVA dle vztahu \eqref{CVA} potřebujeme určit pravděpodobnost selhání protistrany jako funkci času.
Bude se jednat o distribuční funkci exponenciálního rozdělení.

%We assume that the wait time for default of a counterparty is a random variable $X$ with exponential distribution. Then the cumulative distribution function of this variable can be define as
Předpokládejme, že doba čekání na selhání protistrany je náhodná veličina $X$ s exponenciálním rozdělením.
Potom distribuční funkce této náhodné veličiny je definována jako
\begin{equation}\label{exponentialdistr}
F(x)= \mathsf{Pr}(X\leq x)= \left\{ \begin{array}{r@{\quad}c}
    1-\mathrm{e}^{-\lambda x}, & x \geq 0 \\
    0, & x \leq 0 \\ \end{array} \right.
\end{equation}
%where $\lambda>0$ is the parameter of the distribution. Probability of default of the counterparty during one year we denote $PD$. Then 
kde $\lambda>0$ je parametr exponenciálního rozdělení.
Tedy distribuční funkce $F(x)$ je pravděpodobnost že protistrana selže před časem $x$.

Pravděpodobnost selhání protistrany během jednoho roku označíme $PD_{1Y}$.
Pak platí
\begin{equation}\label{PD}
PD_{1Y}=\mathsf{Pr}(X\leq 1)=1-\mathrm{e}^{-\lambda}.
\end{equation}
%If we use value of PD from \textcolor{red}{odkud bereme PD, Leni?}  $\lambda$ could be estimate from \eqref{PD} 
Proto, známe-li $PD_{1Y}$, můžeme ze vztahu \eqref{PD} odvodit parametr $\lambda$,
\begin{eqnarray}\label{lambda}
%PD_{1Y}&=&1-\mathrm{e}^{-\lambda} \nonumber \\
\lambda&=&-\log(1-PD_{1Y}).
\end{eqnarray}

Pro naše výpočty použijeme pravděpodobnost selhání protistrany během jednoho roku, která je výstupem z interních ratingových modelů banky.
Pomocí vztahu \eqref{lambda} odhadneme parametr exponenciálního rozdělení. 
%Then we can construct probability curve for each counterparty. It is possible to observed them in the Figure \ref{DefaultProbability}.
Pro každou protistranu zkonstruujeme křivku pravděpodobnosti selhání v závislosti na čase danou distribuční funkcí \eqref{exponentialdistr}.

Funkce popisující pravděpodobnost selhání protistrany před daným datem můžeme pozorovat na Obrázku \ref{DefaultProbability}.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13cm, clip, trim= 100 270 110 270]{IMG/DefaultProbability.pdf}
	\includegraphics[width=13cm, clip, trim= 100 270 110 270]{IMG/Pravdepodobnost_selhani.pdf}
  \caption{Funkce pravděpodobností selhání protistran.}  \label{DefaultProbability}
\end{figure}
Vzhledem k tomu, že protistrany číslo 3 a číslo 4 mají stejný rating a tedy i stejnou $PD_{1Y}$, tak se jejich grafy funkcí pravděpodobnosti selhání kryjí.
Ze stejného důvodu jsou totožné funkce pravděpodobnosti selhání u protistran číslo 2 a číslo 5.

\subsection{Výpočet CVA} \label{vypocetCVA_kap}
%Let consider the exposure is independent of default. Then total exposure of all contracts can be computed on the bases of equation \eqref{totalExposure}. The bank has estimated recovery rate $R=40\,\%$. \textcolor{red}{Leni, jaká je vaše recovery rate?}. Now we have everything for the CVA calculation according to the equation \eqref{CVA}. The resulting values of CVA for each counterparty can be observed in the Table \ref{resultingCVA}.
Při výpočtu CVA budeme předpokládat, že expozice protistrany a pravděpodobnost jejího selhání jsou nezávislé veličiny.
Jinak řečeno, nebudeme zohledňovat wrong-way riziko.

Výpočet CVA pro jednotlivé protistrany provedeme dosazením do rovnice~\eqref{CVA}. 
%Celkovou expozici každé protistrany určíme podle vztahu \eqref{expozice_vztah}.
Diskontovanou očekávanou expozici protistrany jsme spočítali v Kapitole \ref{simulace_kap} a pravděpodobnost selhání protistrany před časem $t$ jsme určili v Kapitole \ref{funkce_PD_kap}.
Ztrátovost ze selhání budeme uvažovat konstantní a stejnou pro všechny protistrany $LGD=45\,\%$, což je standardní regulatorní hodnota pro podniková portfolia. 
Míra návratnosti daná vztahem \eqref{recovery_rate} je $R=0,55$.

Výsledné hodnoty CVA pro každou protistranu jsou shrnuty v~Tabulce~\ref{resultingCVA}.
\begin{table}%[!htbp]
  \centering 
\caption{Přehled výsledků CVA pro jednotlivé protistrany}
\label{resultingCVA}
\vspace{5mm}
\scalebox{1}{\begin{tabular}{|c |r|}
\hline
\textbf{Protistrana} &\textbf{CVA (v Kč)}\\ 
\hline
$\boldsymbol{1}$&800\,505,82   \\ 
$\boldsymbol{2}$&199\,337,60 \\
$\boldsymbol{3}$&276,59 \\
$\boldsymbol{4}$&783,73 \\
$\boldsymbol{5}$&78\,501,06  \\
\hline
\end{tabular}}
\end{table}

%\begin{figure}[!htbp]
%  \centering 
%	\includegraphics[width=6cm, clip, trim= 110 270 110 270]{IMG/CVAforEachCounterparty.pdf}
%  \caption{CVA for each counterparty}  \label{CVAforEachCounterparty}
%\end{figure}


\section{Srovnání metod výpočtu CVA}\label{srovnani_metod_cva}
Jedním z cílů práce je nalezení efektivní metody výpočtu kapitálového požadavku k riziku nárůstu CVA, proto v této části budeme srovnávat metodu výpočtu CVA popsanou v Kapitole \ref{aplikaceCVA_kap} s metodou, používanou v bance, která poskytla data.
Nejdříve popíšeme metodu určení CVA používanou v bance a následně srovnáme její výsledky s výsledky z předchozí části uvedenými v~Tabulce \ref{resultingCVA}. 

Banka CVA počítá denně, ale účtování CVA provádí na měsíční bázi.
Základní princip výpočtu CVA spočívá v odhadu tzv. \textit{očekávané ztráty (EL)} v průběhu života derivátu. 
Očekávaná ztráta je pojem používaný v~teorii řízení úvěrového rizika.
Jedná se o hodnotu, která odhaduje výší ztráty, jenž Banka průměrně utrpí z úvěrů ve svém portfoliu v důsledku selhání některých klientů. 
Pro odhad očekávané ztráty platí následující vztah 
\begin{equation}\label{el}
EL=PD\cdot LGD\cdot EAD.
\end{equation}

Při výpočtu EL z finančního derivátu nejdříve rozdělíme zbývající čas do maturity derivátu na časová okna o délce jednoho roku. 
Přičemž čas do maturity se zaokrouhluje na celé roky nahoru.
Pro každé z těchto časových oken určíme EL, následně ji diskontujeme a nakonec sečteme tyto hodnoty přes všechna časová okna.
Výsledkem je CVA daného finančního derivátu.
Popsaný výpočet je dán následujícím vztahem
\begin{equation}\label{CVA_banka}
CVA=LGD\cdot\sum_{i=1}^M D(t_i)\cdot EAD(t_i)\cdot PD(i),
\end{equation}
kde $M$ je počet let do maturity derivátu, $PD(i)$ je pravděpodobnost selhání protistrany během $i$-tého roku.
Hodnota LGD je nastavena pro všechny protistrany na hodnotu 45\,\%.

%Banka ve své metodě výpočtu CVA předpokládá, že EAD je konstantní po celou dobu trvání obchodu.
%To je hlavní rozdíl oproti přístupu prezentovanému v předchozí části práce.
%EAD pro daný časový derivát je odhadována jako současná tržní hodnota finančního derivátu. 	

Expozici v okamžiku selhání Banka odhaduje na základě aktuální tržní hodnoty finančního derivátu, ke které přičítá konstantní add-on.
Tržní hodnotu finančního derivátu banka určuje s ohledem na účetní standard IFRS~13 (viz \cite{ifrs13}). 
Výše add-onu je dána jako součin nominální hodnoty uvažovaného derivátu a koeficientu, který nabývá hodnot od $0,0\,\%$ do $7,5\,\%$ v závislosti na druhu derivátu a zbývajícím času do maturity derivátu. 
Tento způsob zohlednění add-onu odpovídá regulatorním požadavkům a zvyklostem.

Pravděpodobnost selhání protistrany v $i$-tém roce je dána vztahem 
%Parametr PD počítáme jako průměrné PD pro daný rating klienta. 
%Přitom PD pro jednotlivá roční okna výpočtu se počítají následovně. 
%Pro rok j spočítáme PD podle vzorce
\begin{equation}\label{PD_banka}
PD(i)=PD_{1Y}(1-PD_{1Y})^{i-1},
\end{equation}
kde $PD_{1Y}$ je průměrná pravděpodobnost selhání protistrany během jednoho roku daná interním ratingem protistrany. 
Tato metoda určení $PD$ je diskrétní narozdíl od spojitého přístupu používaném v předchozí části. 
%Rozdělením období do maturity, zdiskontováním a sečtením EL v každém z těchto období získáme CVA.

%We can observe a comparison of our results of CVA with the CVA used by the bank in Tab. IV. We can see that our results of CVA achieve significantly lower values than the CVA used by the bank.
V Tabulce \ref{srovnaniCVA} vidíme srovnání výsledků z Kapitoly \ref{vypocetCVA_kap} s CVA vypočítanými bankou. 
Všimněme si, že CVA spočítané v této práci dosahují významně nižší hodnot než CVA spočítané v bance.
\begin{table}%[!htbp]
  \centering 
\caption{Srovnání výsledků výpočtů CVA dle metody popsané v této práci a dle metody používané v bance}
\label{srovnaniCVA}
\vspace{5mm}
\scalebox{1}{\begin{tabular}{|c |r|r|}
\hline
\textbf{Protistrana} &\textbf{CVA (v Kč)}&\textbf{CVA vypočítané}\\ 
&&\textbf{v bance (v Kč)}\\
\hline
$\boldsymbol{1}$&800\,505,82 &1\,646\,700,37  \\ 
$\boldsymbol{2}$&199\,337,60 &309\,836,82  \\
$\boldsymbol{3}$&276,59 &384,89 \\
$\boldsymbol{4}$&783,73 & 1\,095,12\\
$\boldsymbol{5}$&78\,501,06 &121\,149,12 \\
\hline
\end{tabular}}
\end{table}

%\end{comment}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Závěr}\addcontentsline{toc}{chapter}{Závěr} 

%jiný stochastický proces, který by popisoval chování trhu v kapitole teorie portfolia
%srovnání různých modelů k modelování úrokové míry v kapitole CVA
%další metody kalibrace Hull-Whitova modelu

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\nocite{}  %umisti do literatury i necitovanou polozku a \nocite{*} umisti do literatury vsechny polozky z bibtex databaze 

\cleardoublepage
\phantomsection 

\addcontentsline{toc}{chapter}{Literatura}
%\bibliographystyle{plain}
%\bibliographystyle{abbrv}
\bibliographystyle{abbrv_czech}
\bibliography{bibliography}

%\cleardoublepage
%\phantomsection 
%\addcontentsline{toc}{chapter}{Příloha}

%\renewcommand{\thechapter}{\Alph{chapter}} %nový čítač kapitol, příkaz \Alph nastavuje, že čítačem budou velká písmena
%\setcounter{chapter}{0} %nastaví čítač kapitol na 0

\appendix %příkaz, který první číslo v názvu kapitoly nebo sekce mění na písmeno

%\nocite{976825, 979237, 979245, 1077842, 1093598, 1167343, 1167503, 1183811} %moje publikace

\chapter[Příloha -- Publikace autorky]{Příloha}\label{priloha_publikace}
\section*{Publikace autorky}
%\bibliographystyle{abbrv}
%\bibliography{moje}
\begin{enumerate}
%\renewcommand\labelenumi{\bfseries\Roman{enumi}.}
\renewcommand\labelenumi{\Roman{enumi}.}
\item
L.~Křivánková a S.~Zlatošová.
\newblock Modelling Counterparty Credit Risk in Czech Interest Rate Swaps.
\newblock {\em Acta Universitatis Agriculturae et Silviculturae Mendelianae
  Brunensis}, 65(3), 2017.

\item
L.~Křivánková.
\newblock Equilibrium models for portfolio selection.
\newblock {\em Mathematical Models and
  Financial Mathematics. Book of short papers}, strany 35--42, Brno, 2014.
  Masaryk University.

\item
L.~Křivánková.
\newblock Asset-pricing models in portfolio theory.
\newblock {\em Financial Mathematics in
  Practice II, Book of short papers}, strany 42--49, Brno, 2013. Masaryk
  University.

\item
L.~Křivánková.
\newblock Continuous-time models in portfolio theory.
\newblock {\em XX International Conference PDMU-2012 Problems of Decision
  Making under Uncertainties}, strany 95--104, Brno, 2012. University of
  Defence.

\item
L.~Křivánková.
\newblock The Black-Scholes equation for barrier options.
\newblock {\em 7.~konference o matematice a fyzice na vysokých školách
  technických s mezinárodní účastí : Sborník příspěvků část 1 -
  matematika}, 2011.

\item
L.~Křivánková.
\newblock Wiener process and applications.
\newblock {\em Workshop of the Jaroslav Hájek Center, Book of short
  papers}, 2010.

\item
S.~Kafková a L.~Křivánková.
\newblock Generalized linear models in vehicle insurance.
\newblock {\em Acta Universitatis Agriculturae et Silviculturae Mendelianae
  Brunensis}, 62(2):383--388, 2014.

\item
S.~Kafková, L.~Křivánková a M.~Leváková.
\newblock Survival analysis of patients with brain tumour.
\newblock {\em Mathematical Models and
  Financial Mathematics. Book of short papers}, strany 27--33, Brno, 2014.
  Masaryk University.

%@article{kolavrocevnovani,
%  title={Oce{\v{n}}ov{\'a}n{\'\i} finan{\v{c}}n{\'\i}ch deriv{\'a}t{\uu}},
%  author={Kol{\'a}{\v{r}}, Doc RNDr Martin and K{\v{r}}iv{\'a}nkov{\'a}, Mgr Lenka}

\end{enumerate}


\chapter[Příloha -- Ukázka datového souboru]{Příloha}\label{priloha_data}
\section*{Ukázka datového souboru}
V příloze je uvedena ukázka datového souboru analyzovaného v Kapitole \ref{aplikace}.
\begin{figure}[!htbp]
  \centering 
%	\includegraphics[width=13.5cm, clip, trim= 0 270 0 10]{IMG/data.pdf}
\includegraphics[width=12.5cm, clip, trim= 0 510 277 10]{IMG/data_v2.pdf}
%  \caption{}  %\label{}
\end{figure}

\chapter[Příloha -- Ukázka programů]{Příloha}\label{priloha_programy}
\section*{Ukázka programu v R}
\addcontentsline{toc}{section}{Ukázka programu v {\textsf{R}}}

V příloze uvádíme ukázku programu vytvořeného v prostředí \R. 
Tato část zdrojového kódu slouží k simulaci trajektorií Ornstein-Uhlenbeckova procesu.

\begin{verbatim}
# =============================================================
# Ornstein-Uhlenbeckův proces 
# =============================================================
#
# jedna trajektorie
#
r0<- 2
dt <- 0.001
theta <- 2
sigma <- 0.1
kappa <- 1
t <- seq (0, 1, by = dt)

ri<-r0
X<-r0
dw_r<-rnorm((length (t) - 1),0,sqrt(dt))    
for (i in 1:(length (t) - 1)){  
  dr<-kappa*(theta-ri)*dt+sigma*dw_r[i] 
  ri<-ri+dr
  X<-cbind(X,ri)
}

plot (t, X, type="l", col = "red", xlab = "t", ylab = "X(t)")
abline (h = theta , lty = 2)  
# =============================================================
\end{verbatim}

%pro každou stránku je potřeba nové prostředí, jinak háže chybu
\newpage

\begin{verbatim}
# =============================================================
# Ornstein-Uhlenbeckův proces 
# =============================================================
#
# více trajektorií
#
r0<- 2
dt <- 0.001
theta <- 2
sigma <- 0.1
kappa <- 1
t <- seq (0, 1, by = dt)
M<-t(X)
for (k in 1:4){
  ri<-r0
  X<-r0
  dw_r<-rnorm((length (t) - 1),0,sqrt(dt))    
  for (i in 1:(length (t) - 1)){  
    dr<-kappa*(theta-ri)*dt+sigma*dw_r[i] 
    ri<-ri+dr
    X<-cbind(X,ri)}
M<-cbind(M,t(X))
}

matplot (t, M, type = "l", lty = 1, xlab = "t", ylab = "X(t)")
abline (h = theta , lty = 2)  
# =============================================================
\end{verbatim}

Ukázku trajektorií Ornstein–Uhlenbeckova procesu s danými parametry zobrazuje Graf \ref{OU_graf}, který byl vytvořen v prostředí \R pomocí předcházejícího zdrojového kódu.

\newpage
Další část zdrojového kódu používáme ke zobrazení grafů dat a grafů simulací z Kapitoly \ref{aplikace}.

\begin{verbatim}
# =============================================================
# Data - grafy
# =============================================================
#
date <- rev(scan(file="U:/R/data/date.csv", sep=";", 
                 what=date(), dec=","))
date <- as.Date(date, "%d.%m.%Y") 

matplot (date, data, type = "l", lty = 1, xaxt="n", 
         xlab = "t", ylab = "P(t)", main = "price of asset")
axis.Date(side = 1, date)
legend(date[650],10200, 
       c("CEZ", "O2","KB", "PM", "Pegas", "CT", "NWR"), 
       col=1:7, lty=1,  box.lty=0) 
# =============================================================
#
# =============================================================
# Simulace - grafy
# =============================================================
#
dates <- bizseq("2014-02-22", "2016-02-23",
   Calendar(holidaysANBIMA, weekdays=c("saturday", "sunday")))

plot (dates, r, type = "l", lty = 1, xlab = "t", ylab = "r(t)", 
      yaxt="n", main = "return of market")

axis(2, at=seq(-0.0002,0.0003,by=.0002), 
     labels=paste(100*seq(-0.0002,0.0003,by=.0002), "%") )

matplot (dates, t(x), type = "l", lty = 1, xaxt="n", 
         xlab = "t", ylab = "P(t)", main = "price of asset")
axis.Date(side = 1, dates)
# =============================================================
\end{verbatim}

\newpage
\section*{Ukázka programu v MATLAB}
\addcontentsline{toc}{section}{Ukázka programu v \MATLAB}
Na závěr uvedeme ukázky z programu pro výpočet Credit Valuation Adjustment  vytvořeného v prostředí \MATLAB a využívaného v Kapitole \ref{aplikaceCVA_kap}.

První část programu načte data o úrokových swapech z datového souboru vytvořeného v aplikaci Microsoft Excel. 
Další část slouží k vykreslení Grafu~\ref{YieldCurve} počáteční výnosové křivky, která se dále využívá při modelování úrokové míry pomocí Hull-Whitova modelu (viz Kapitola~\ref{vynosova_krivka_kap}).

\begin{verbatim}
clear all
% =============================================================
% Načte data o IRS
% =============================================================
%
swapFile = 'data.xls';
swapData = dataset('XLSFile',swapFile,'Sheet','SwapPortfolio');
swaps = struct(...
    'Counterparty',[],...
    'NettingID',[],...
    'Principal',[],...
    'Maturity',[],...
    'LegRate',[],...
    'LegType',[],...
    'LatestFloatingRate',[],...
    'FloatingResetDates',[]);

swaps.Counterparty = swapData.CounterpartyID;
swaps.NettingID    = swapData.NettingID;
swaps.Principal    = swapData.Principal;
swaps.Maturity     = swapData.Maturity;
swaps.LegType      = [swapData.LegType ~swapData.LegType];
swaps.LegRate      = [swapData.LegRateReceiving ... 
                      swapData.LegRatePaying];
swaps.LatestFloatingRate = swapData.LatestFloatingRate;
swaps.Period       = swapData.Period;
swaps.LegReset     = ones(size(swaps.LegType));

numSwaps = numel(swaps.Counterparty);
% =============================================================
%
%
% =============================================================
% Vytvoří počáteční výnosovou křivku a vykreslí její graf
% =============================================================
%
Settle   = datenum('30-Oct-2015');

Tenor  = [3 6 12 24 36 48 5*12 72 7*12 96 108 10*12 144 180... 
          20*12]';
ZeroRates = [0.0029	0.0037	0.0021	0.0025	0.0028	0.0033...	
             0.004	0.0047		0.0056	0.0065	0.0075	0.0083...
             0.0099	0.0116	0.0127]';

ZeroDates = datemnth(Settle,Tenor);
Compounding =-1;
Basis = 0;
RateSpec = intenvset('StartDates', Settle,'EndDates',... 
                      ZeroDates, 'Rates', ZeroRates,...
                     'Compounding', Compounding,'Basis',Basis);

figure;
plot(ZeroDates, ZeroRates, 'o-');
xlabel('Datum');
datetick('keeplimits');
ylabel('Úroková míra');
grid on;
title('Výnosová křivka');
% =============================================================
\end{verbatim}

Následující část programu načte historická data o sazbě PRIBOR z datového souboru vytvořeného v aplikaci Microsoft Excel.
Potom vykreslí graf vývoje tříměsíční sazby PRIBOR (viz Obrázek \ref{PRIBOR}) a odhadne z ní parametry Hull-Whitova modelu (viz Kapitola \ref{simulace_kap}).
\begin{verbatim}
% =============================================================
% Načte data o PRIBOR
% =============================================================
%
priborFile = 'data.xls';
priborData = dataset('XLSFile',priborFile,'Sheet','PRIBOR');
yields=priborData.PRIBOR_3m;
Dates=priborData.Datum;
formatIn='dd.mm.yyyy';
Data=datenum(Dates,formatIn);
simDates=datemnth('30-Oct-2015',0:1:(12*7))';
% =============================================================
%
% =============================================================
% Vykreslí graf vývoje 3m PRIBOR
% =============================================================
%
figure;
plot(Data, yields, '-');
xlabel('Datum');
datetick('x', 'mm/yy');
ylabel('PRIBOR 3M');
grid on;
% =============================================================
%
% =============================================================
% Odhadne parametry Hull-Whitova modelu 
% za použití funkce regress
% =============================================================
%
regressors = [ones(length(yields)-1, 1) yields(1: end -1)];
[coefficients,~,residuals] = regress(diff(yields),regressors);

% Časový krok je nastaven v závislosti na frekvenci dat 
% v simulaci
dt = mean(diff(simDates));

% Alpha -- rychlost reverze
Alpha = - coefficients(2)/dt

% Sigma -- volatilita
Sigma = nanstd(residuals)/sqrt(dt)
% =============================================================
\end{verbatim}

\end{document}


% Synonyma:
%
% článek, text, publikace, monografie, kniha
% definovat, zformulovat
% jev, fenomén
% popisovat, charakterizovat, zachytit, vystihovat, postihovat, vyznačovat, určovat

%Užitečné příkazy:
%
%\linebreak